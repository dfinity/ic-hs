<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |

Helpers to program the &#8220;Universal module&#8221;. This is essentially a small,
type-safe DSL to produce the small stack-based programming language interpreted
by the universal canister.

This DSL is expression-based, not stack based; seems to suite all our needs and is
simpler to work with.

This language is not stable; therefore there is no separarte documentation of
specification than this file and `universal-canister/src/`
-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IC.Test.Universal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.String.html"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- The types of our little language are i32, i64, pair of i64s and blobs</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">data</span><span> </span><span id="T"><span class="annot"><a href="IC.Test.Universal.html#T"><span class="hs-identifier hs-var">T</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="I"><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-var">I</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="I64"><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-var">I64</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="B"><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-var">B</span></a></span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- We deal with expressions (return a value, thus have a type) and programs (do</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- something, but do not return a type). They are represented simply</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- by the encoded stack program; no need for an AST or something that complicated</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">newtype</span><span> </span><span id="Exp"><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383201"><span class="annot"><a href="#local-6989586621679383201"><span class="hs-identifier hs-type">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#T"><span class="hs-identifier hs-type">T</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>    </span><span id="local-6989586621679383412"><span id="Exp"><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383412"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">newtype</span><span> </span><span id="Prog"><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>    </span><span id="Prog"><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- We extracting the actual stack program bytecode from a program.</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><a href="IC.Test.Universal.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-44"></span><span id="run"><span class="annot"><span class="annottext">run :: Prog -&gt; ByteString
</span><a href="IC.Test.Universal.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621679383197"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383197"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#toLazyByteString"><span class="hs-identifier hs-var">toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383197"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- Programs can be sequenced using (&gt;&gt;&gt;); this naturally forms a Monoid</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-type">(&gt;&gt;&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-49"></span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621679383194"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383194"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%3E%3E%3E"><span class="annot"><span class="annottext">&gt;&gt;&gt; :: Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var hs-var">&gt;&gt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621679383193"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383193"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Prog
</span><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383194"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383193"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679383188"><span id="local-6989586621679383190"><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621679383186"><span class="annot"><span class="annottext">&lt;&gt; :: Prog -&gt; Prog -&gt; Prog
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">(&gt;&gt;&gt;)</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679383179"><span id="local-6989586621679383181"><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679383175"><span class="annot"><span class="annottext">mempty :: Prog
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Prog
</span><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- A utility class to easily defined functions and programs of any arity</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- simply by specifying their type.</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">class</span><span> </span><span id="Op"><span class="annot"><a href="IC.Test.Universal.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span id="local-6989586621679383417"><span class="annot"><a href="#local-6989586621679383417"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>    </span><span id="mkOp"><span class="annot"><a href="IC.Test.Universal.html#mkOp"><span class="hs-identifier hs-type">mkOp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383417"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383170"><span class="annot"><span class="annottext">mkOp :: Word8 -&gt; Builder -&gt; Prog
</span><a href="#local-6989586621679383170"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkOp</span></a></span></span><span> </span><span id="local-6989586621679383169"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383169"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679383168"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383168"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Prog
</span><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383168"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word8"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383169"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679383421"><span class="annot"><a href="IC.Test.Universal.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383421"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383164"><span class="annot"><span class="annottext">mkOp :: Word8 -&gt; Builder -&gt; Exp t
</span><a href="#local-6989586621679383164"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkOp</span></a></span></span><span> </span><span id="local-6989586621679383163"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383163"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679383162"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383162"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: T). Builder -&gt; Exp a
</span><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383162"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word8"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383163"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679383422"><span id="local-6989586621679383423"><span class="annot"><a href="IC.Test.Universal.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383422"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383423"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383157"><span class="annot"><span class="annottext">mkOp :: Word8 -&gt; Builder -&gt; Exp t -&gt; a
</span><a href="#local-6989586621679383157"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkOp</span></a></span></span><span> </span><span id="local-6989586621679383156"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383156"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679383155"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383155"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span id="local-6989586621679383154"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383154"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; Builder -&gt; a
</span><a href="IC.Test.Universal.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383156"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383155"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679383154"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621679383409"><span class="annot"><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383409"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-71"></span><span id="op"><span class="annot"><span class="annottext">op :: forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679383149"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383149"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; Builder -&gt; a
</span><a href="IC.Test.Universal.html#mkOp"><span class="hs-identifier hs-var">mkOp</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679383149"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Now, all the op codes defined by the universal canister.</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Most can be simply be defined by specifiying their type and using the 'op'</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- combinator</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-type">noop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-78"></span><span id="noop"><span class="annot"><span class="annottext">noop :: Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var hs-var">noop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679383407"><span class="annot"><a href="IC.Test.Universal.html#ignore"><span class="hs-identifier hs-type">ignore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383407"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span></span><span>
</span><span id="line-81"></span><span id="ignore"><span class="annot"><span class="annottext">ignore :: forall (t :: T). Exp t -&gt; Prog
</span><a href="IC.Test.Universal.html#ignore"><span class="hs-identifier hs-var hs-var">ignore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-type">int</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-84"></span><span id="int"><span class="annot"><span class="annottext">int :: Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var hs-var">int</span></a></span></span><span> </span><span id="local-6989586621679383143"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679383143"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: T). Builder -&gt; Exp a
</span><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word8"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word32LE"><span class="hs-identifier hs-var">word32LE</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679383143"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-type">bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-87"></span><span id="bytes"><span class="annot"><span class="annottext">bytes :: ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var hs-var">bytes</span></a></span></span><span> </span><span id="local-6989586621679383140"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383140"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: T). Builder -&gt; Exp a
</span><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word8"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Word32 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word32LE"><span class="hs-identifier hs-var">word32LE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383140"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.Internal.html#lazyByteString"><span class="hs-identifier hs-var">lazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383140"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-type">replyDataAppend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-93"></span><span id="replyDataAppend"><span class="annot"><span class="annottext">replyDataAppend :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var hs-var">replyDataAppend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">4</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-type">reply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-96"></span><span id="reply"><span class="annot"><span class="annottext">reply :: Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var hs-var">reply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">5</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="IC.Test.Universal.html#self"><span class="hs-identifier hs-type">self</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-99"></span><span id="self"><span class="annot"><span class="annottext">self :: Exp 'B
</span><a href="IC.Test.Universal.html#self"><span class="hs-identifier hs-var hs-var">self</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">6</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="IC.Test.Universal.html#reject"><span class="hs-identifier hs-type">reject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-102"></span><span id="reject"><span class="annot"><span class="annottext">reject :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#reject"><span class="hs-identifier hs-var hs-var">reject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">7</span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="IC.Test.Universal.html#caller"><span class="hs-identifier hs-type">caller</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-105"></span><span id="caller"><span class="annot"><span class="annottext">caller :: Exp 'B
</span><a href="IC.Test.Universal.html#caller"><span class="hs-identifier hs-var hs-var">caller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">8</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="IC.Test.Universal.html#reject_msg"><span class="hs-identifier hs-type">reject_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-108"></span><span id="reject_msg"><span class="annot"><span class="annottext">reject_msg :: Exp 'B
</span><a href="IC.Test.Universal.html#reject_msg"><span class="hs-identifier hs-var hs-var">reject_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">10</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="IC.Test.Universal.html#reject_code"><span class="hs-identifier hs-type">reject_code</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-111"></span><span id="reject_code"><span class="annot"><span class="annottext">reject_code :: Exp 'I
</span><a href="IC.Test.Universal.html#reject_code"><span class="hs-identifier hs-var hs-var">reject_code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">11</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="IC.Test.Universal.html#i2b"><span class="hs-identifier hs-type">i2b</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-114"></span><span id="i2b"><span class="annot"><span class="annottext">i2b :: Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i2b"><span class="hs-identifier hs-var hs-var">i2b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">12</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="IC.Test.Universal.html#argData"><span class="hs-identifier hs-type">argData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-117"></span><span id="argData"><span class="annot"><span class="annottext">argData :: Exp 'B
</span><a href="IC.Test.Universal.html#argData"><span class="hs-identifier hs-var hs-var">argData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">13</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><a href="IC.Test.Universal.html#cat"><span class="hs-identifier hs-type">cat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-120"></span><span id="cat"><span class="annot"><span class="annottext">cat :: Exp 'B -&gt; Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#cat"><span class="hs-identifier hs-var hs-var">cat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">14</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="IC.Test.Universal.html#stableSize"><span class="hs-identifier hs-type">stableSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-123"></span><span id="stableSize"><span class="annot"><span class="annottext">stableSize :: Exp 'I
</span><a href="IC.Test.Universal.html#stableSize"><span class="hs-identifier hs-var hs-var">stableSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">15</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="IC.Test.Universal.html#stableGrow"><span class="hs-identifier hs-type">stableGrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-126"></span><span id="stableGrow"><span class="annot"><span class="annottext">stableGrow :: Exp 'I -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#stableGrow"><span class="hs-identifier hs-var hs-var">stableGrow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">16</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="IC.Test.Universal.html#stableRead"><span class="hs-identifier hs-type">stableRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-129"></span><span id="stableRead"><span class="annot"><span class="annottext">stableRead :: Exp 'I -&gt; Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#stableRead"><span class="hs-identifier hs-var hs-var">stableRead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">17</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="IC.Test.Universal.html#stableWrite"><span class="hs-identifier hs-type">stableWrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-132"></span><span id="stableWrite"><span class="annot"><span class="annottext">stableWrite :: Exp 'I -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#stableWrite"><span class="hs-identifier hs-var hs-var">stableWrite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">18</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="IC.Test.Universal.html#debugPrint"><span class="hs-identifier hs-type">debugPrint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-135"></span><span id="debugPrint"><span class="annot"><span class="annottext">debugPrint :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#debugPrint"><span class="hs-identifier hs-var hs-var">debugPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">19</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="IC.Test.Universal.html#trap"><span class="hs-identifier hs-type">trap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-138"></span><span id="trap"><span class="annot"><span class="annottext">trap :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#trap"><span class="hs-identifier hs-var hs-var">trap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">20</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="IC.Test.Universal.html#setGlobal"><span class="hs-identifier hs-type">setGlobal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-141"></span><span id="setGlobal"><span class="annot"><span class="annottext">setGlobal :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#setGlobal"><span class="hs-identifier hs-var hs-var">setGlobal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">21</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="IC.Test.Universal.html#getGlobal"><span class="hs-identifier hs-type">getGlobal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-144"></span><span id="getGlobal"><span class="annot"><span class="annottext">getGlobal :: Exp 'B
</span><a href="IC.Test.Universal.html#getGlobal"><span class="hs-identifier hs-var hs-var">getGlobal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">22</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="IC.Test.Universal.html#badPrint"><span class="hs-identifier hs-type">badPrint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-147"></span><span id="badPrint"><span class="annot"><span class="annottext">badPrint :: Prog
</span><a href="IC.Test.Universal.html#badPrint"><span class="hs-identifier hs-var hs-var">badPrint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">23</span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="IC.Test.Universal.html#onPreUpgrade"><span class="hs-identifier hs-type">onPreUpgrade</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-150"></span><span id="onPreUpgrade"><span class="annot"><span class="annottext">onPreUpgrade :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onPreUpgrade"><span class="hs-identifier hs-var hs-var">onPreUpgrade</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">24</span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="IC.Test.Universal.html#getTime"><span class="hs-identifier hs-type">getTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-153"></span><span id="getTime"><span class="annot"><span class="annottext">getTime :: Exp 'I64
</span><a href="IC.Test.Universal.html#getTime"><span class="hs-identifier hs-var hs-var">getTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">26</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="IC.Test.Universal.html#getAvailableCycles"><span class="hs-identifier hs-type">getAvailableCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-156"></span><span id="getAvailableCycles"><span class="annot"><span class="annottext">getAvailableCycles :: Exp 'I64
</span><a href="IC.Test.Universal.html#getAvailableCycles"><span class="hs-identifier hs-var hs-var">getAvailableCycles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">27</span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="IC.Test.Universal.html#getBalance"><span class="hs-identifier hs-type">getBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-159"></span><span id="getBalance"><span class="annot"><span class="annottext">getBalance :: Exp 'I64
</span><a href="IC.Test.Universal.html#getBalance"><span class="hs-identifier hs-var hs-var">getBalance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">28</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="IC.Test.Universal.html#getRefund"><span class="hs-identifier hs-type">getRefund</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-162"></span><span id="getRefund"><span class="annot"><span class="annottext">getRefund :: Exp 'I64
</span><a href="IC.Test.Universal.html#getRefund"><span class="hs-identifier hs-var hs-var">getRefund</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">29</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="IC.Test.Universal.html#acceptCycles"><span class="hs-identifier hs-type">acceptCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-165"></span><span id="acceptCycles"><span class="annot"><span class="annottext">acceptCycles :: Exp 'I64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#acceptCycles"><span class="hs-identifier hs-var hs-var">acceptCycles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">30</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="IC.Test.Universal.html#int64"><span class="hs-identifier hs-type">int64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-168"></span><span id="int64"><span class="annot"><span class="annottext">int64 :: Word64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#int64"><span class="hs-identifier hs-var hs-var">int64</span></a></span></span><span> </span><span id="local-6989586621679383111"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383111"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: T). Builder -&gt; Exp a
</span><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word8"><span class="hs-identifier hs-var">word8</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">31</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Builder.html#word64LE"><span class="hs-identifier hs-var">word64LE</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383111"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="IC.Test.Universal.html#callNew"><span class="hs-identifier hs-type">callNew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-171"></span><span id="callNew"><span class="annot"><span class="annottext">callNew :: Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callNew"><span class="hs-identifier hs-var hs-var">callNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">32</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="IC.Test.Universal.html#callDataAppend"><span class="hs-identifier hs-type">callDataAppend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-174"></span><span id="callDataAppend"><span class="annot"><span class="annottext">callDataAppend :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callDataAppend"><span class="hs-identifier hs-var hs-var">callDataAppend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">33</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="IC.Test.Universal.html#callCyclesAdd"><span class="hs-identifier hs-type">callCyclesAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-177"></span><span id="callCyclesAdd"><span class="annot"><span class="annottext">callCyclesAdd :: Exp 'I64 -&gt; Prog
</span><a href="IC.Test.Universal.html#callCyclesAdd"><span class="hs-identifier hs-var hs-var">callCyclesAdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">34</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="IC.Test.Universal.html#callPerform"><span class="hs-identifier hs-type">callPerform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-180"></span><span id="callPerform"><span class="annot"><span class="annottext">callPerform :: Prog
</span><a href="IC.Test.Universal.html#callPerform"><span class="hs-identifier hs-var hs-var">callPerform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">35</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="IC.Test.Universal.html#setCertifiedData"><span class="hs-identifier hs-type">setCertifiedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-183"></span><span id="setCertifiedData"><span class="annot"><span class="annottext">setCertifiedData :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#setCertifiedData"><span class="hs-identifier hs-var hs-var">setCertifiedData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">36</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><a href="IC.Test.Universal.html#getCertificatePresent"><span class="hs-identifier hs-type">getCertificatePresent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-186"></span><span id="getCertificatePresent"><span class="annot"><span class="annottext">getCertificatePresent :: Exp 'I
</span><a href="IC.Test.Universal.html#getCertificatePresent"><span class="hs-identifier hs-var hs-var">getCertificatePresent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">37</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><a href="IC.Test.Universal.html#getCertificate"><span class="hs-identifier hs-type">getCertificate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-189"></span><span id="getCertificate"><span class="annot"><span class="annottext">getCertificate :: Exp 'B
</span><a href="IC.Test.Universal.html#getCertificate"><span class="hs-identifier hs-var hs-var">getCertificate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">38</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="IC.Test.Universal.html#getStatus"><span class="hs-identifier hs-type">getStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-192"></span><span id="getStatus"><span class="annot"><span class="annottext">getStatus :: Exp 'I
</span><a href="IC.Test.Universal.html#getStatus"><span class="hs-identifier hs-var hs-var">getStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">39</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="IC.Test.Universal.html#onHeartbeat"><span class="hs-identifier hs-type">onHeartbeat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-195"></span><span id="onHeartbeat"><span class="annot"><span class="annottext">onHeartbeat :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onHeartbeat"><span class="hs-identifier hs-var hs-var">onHeartbeat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">40</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="IC.Test.Universal.html#acceptMessage"><span class="hs-identifier hs-type">acceptMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-198"></span><span id="acceptMessage"><span class="annot"><span class="annottext">acceptMessage :: Prog
</span><a href="IC.Test.Universal.html#acceptMessage"><span class="hs-identifier hs-var hs-var">acceptMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">41</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="IC.Test.Universal.html#onInspectMessage"><span class="hs-identifier hs-type">onInspectMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-201"></span><span id="onInspectMessage"><span class="annot"><span class="annottext">onInspectMessage :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onInspectMessage"><span class="hs-identifier hs-var hs-var">onInspectMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">42</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="IC.Test.Universal.html#trapIfEq"><span class="hs-identifier hs-type">trapIfEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-204"></span><span id="trapIfEq"><span class="annot"><span class="annottext">trapIfEq :: Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#trapIfEq"><span class="hs-identifier hs-var hs-var">trapIfEq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">43</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="IC.Test.Universal.html#callOnCleanup"><span class="hs-identifier hs-type">callOnCleanup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-207"></span><span id="callOnCleanup"><span class="annot"><span class="annottext">callOnCleanup :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callOnCleanup"><span class="hs-identifier hs-var hs-var">callOnCleanup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">44</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="IC.Test.Universal.html#stableFill"><span class="hs-identifier hs-type">stableFill</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-210"></span><span id="stableFill"><span class="annot"><span class="annottext">stableFill :: Exp 'I -&gt; Exp 'I -&gt; Exp 'I -&gt; Prog
</span><a href="IC.Test.Universal.html#stableFill"><span class="hs-identifier hs-var hs-var">stableFill</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">45</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="IC.Test.Universal.html#stable64Size"><span class="hs-identifier hs-type">stable64Size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-213"></span><span id="stable64Size"><span class="annot"><span class="annottext">stable64Size :: Exp 'I64
</span><a href="IC.Test.Universal.html#stable64Size"><span class="hs-identifier hs-var hs-var">stable64Size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">46</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="IC.Test.Universal.html#stable64Grow"><span class="hs-identifier hs-type">stable64Grow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-216"></span><span id="stable64Grow"><span class="annot"><span class="annottext">stable64Grow :: Exp 'I64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#stable64Grow"><span class="hs-identifier hs-var hs-var">stable64Grow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">47</span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="IC.Test.Universal.html#stable64Read"><span class="hs-identifier hs-type">stable64Read</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-219"></span><span id="stable64Read"><span class="annot"><span class="annottext">stable64Read :: Exp 'I64 -&gt; Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#stable64Read"><span class="hs-identifier hs-var hs-var">stable64Read</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">48</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="IC.Test.Universal.html#stable64Write"><span class="hs-identifier hs-type">stable64Write</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-222"></span><span id="stable64Write"><span class="annot"><span class="annottext">stable64Write :: Exp 'I64 -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#stable64Write"><span class="hs-identifier hs-var hs-var">stable64Write</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">49</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="IC.Test.Universal.html#i64tob"><span class="hs-identifier hs-type">i64tob</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-225"></span><span id="i64tob"><span class="annot"><span class="annottext">i64tob :: Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i64tob"><span class="hs-identifier hs-var hs-var">i64tob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">50</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="IC.Test.Universal.html#getAvailableCycles128"><span class="hs-identifier hs-type">getAvailableCycles128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-228"></span><span id="getAvailableCycles128"><span class="annot"><span class="annottext">getAvailableCycles128 :: Exp 'B
</span><a href="IC.Test.Universal.html#getAvailableCycles128"><span class="hs-identifier hs-var hs-var">getAvailableCycles128</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">51</span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="IC.Test.Universal.html#getBalance128"><span class="hs-identifier hs-type">getBalance128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-231"></span><span id="getBalance128"><span class="annot"><span class="annottext">getBalance128 :: Exp 'B
</span><a href="IC.Test.Universal.html#getBalance128"><span class="hs-identifier hs-var hs-var">getBalance128</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">52</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="IC.Test.Universal.html#getRefund128"><span class="hs-identifier hs-type">getRefund128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-234"></span><span id="getRefund128"><span class="annot"><span class="annottext">getRefund128 :: Exp 'B
</span><a href="IC.Test.Universal.html#getRefund128"><span class="hs-identifier hs-var hs-var">getRefund128</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">53</span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><a href="IC.Test.Universal.html#acceptCycles128"><span class="hs-identifier hs-type">acceptCycles128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-237"></span><span id="acceptCycles128"><span class="annot"><span class="annottext">acceptCycles128 :: Exp 'I64 -&gt; Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#acceptCycles128"><span class="hs-identifier hs-var hs-var">acceptCycles128</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">54</span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="IC.Test.Universal.html#callCyclesAdd128"><span class="hs-identifier hs-type">callCyclesAdd128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-240"></span><span id="callCyclesAdd128"><span class="annot"><span class="annottext">callCyclesAdd128 :: Exp 'I64 -&gt; Exp 'I64 -&gt; Prog
</span><a href="IC.Test.Universal.html#callCyclesAdd128"><span class="hs-identifier hs-var hs-var">callCyclesAdd128</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">55</span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="IC.Test.Universal.html#onGlobalTimer"><span class="hs-identifier hs-type">onGlobalTimer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-243"></span><span id="onGlobalTimer"><span class="annot"><span class="annottext">onGlobalTimer :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onGlobalTimer"><span class="hs-identifier hs-var hs-var">onGlobalTimer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">62</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="IC.Test.Universal.html#apiGlobalTimerSet"><span class="hs-identifier hs-type">apiGlobalTimerSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-246"></span><span id="apiGlobalTimerSet"><span class="annot"><span class="annottext">apiGlobalTimerSet :: Exp 'I64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#apiGlobalTimerSet"><span class="hs-identifier hs-var hs-var">apiGlobalTimerSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">63</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="IC.Test.Universal.html#performanceCounter"><span class="hs-identifier hs-type">performanceCounter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-249"></span><span id="performanceCounter"><span class="annot"><span class="annottext">performanceCounter :: Exp 'I -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#performanceCounter"><span class="hs-identifier hs-var hs-var">performanceCounter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">66</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="IC.Test.Universal.html#methodName"><span class="hs-identifier hs-type">methodName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-252"></span><span id="methodName"><span class="annot"><span class="annottext">methodName :: Exp 'B
</span><a href="IC.Test.Universal.html#methodName"><span class="hs-identifier hs-var hs-var">methodName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">67</span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="IC.Test.Universal.html#parsePrincipal"><span class="hs-identifier hs-type">parsePrincipal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-255"></span><span id="parsePrincipal"><span class="annot"><span class="annottext">parsePrincipal :: Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#parsePrincipal"><span class="hs-identifier hs-var hs-var">parsePrincipal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">68</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-type">onTransform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-258"></span><span id="onTransform"><span class="annot"><span class="annottext">onTransform :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var hs-var">onTransform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">69</span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-type">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-261"></span><span id="getHttpReplyWithBody"><span class="annot"><span class="annottext">getHttpReplyWithBody :: Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var hs-var">getHttpReplyWithBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">70</span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="IC.Test.Universal.html#getHttpTransformContext"><span class="hs-identifier hs-type">getHttpTransformContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-264"></span><span id="getHttpTransformContext"><span class="annot"><span class="annottext">getHttpTransformContext :: Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpTransformContext"><span class="hs-identifier hs-var hs-var">getHttpTransformContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">71</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="IC.Test.Universal.html#canisterVersion"><span class="hs-identifier hs-type">canisterVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-267"></span><span id="canisterVersion"><span class="annot"><span class="annottext">canisterVersion :: Exp 'I64
</span><a href="IC.Test.Universal.html#canisterVersion"><span class="hs-identifier hs-var hs-var">canisterVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">73</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><a href="IC.Test.Universal.html#trapIfNeq"><span class="hs-identifier hs-type">trapIfNeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-270"></span><span id="trapIfNeq"><span class="annot"><span class="annottext">trapIfNeq :: Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#trapIfNeq"><span class="hs-identifier hs-var hs-var">trapIfNeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">74</span></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="annot"><a href="IC.Test.Universal.html#mintCycles"><span class="hs-identifier hs-type">mintCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I64"><span class="hs-identifier hs-type">I64</span></a></span><span>
</span><span id="line-273"></span><span id="mintCycles"><span class="annot"><span class="annottext">mintCycles :: Exp 'I64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#mintCycles"><span class="hs-identifier hs-var hs-var">mintCycles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">75</span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="IC.Test.Universal.html#oneWayCallNew"><span class="hs-identifier hs-type">oneWayCallNew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-276"></span><span id="oneWayCallNew"><span class="annot"><span class="annottext">oneWayCallNew :: Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#oneWayCallNew"><span class="hs-identifier hs-var hs-var">oneWayCallNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">76</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="IC.Test.Universal.html#isController"><span class="hs-identifier hs-type">isController</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#I"><span class="hs-identifier hs-type">I</span></a></span><span>
</span><span id="line-279"></span><span id="isController"><span class="annot"><span class="annottext">isController :: Exp 'B -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#isController"><span class="hs-identifier hs-var hs-var">isController</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Op a =&gt; Word8 -&gt; a
</span><a href="IC.Test.Universal.html#op"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">77</span></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- Some convenience combinators</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- This allows us to write byte expressions as plain string literals</span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.String.html#IsString"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679383069"><span class="annot"><span class="annottext">fromString :: [Char] -&gt; Exp 'B
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.String.html#fromString"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></a></span></span><span> </span><span id="local-6989586621679383068"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679383068"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IsString a =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.String.html#fromString"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679383068"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-type">callback</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span>
</span><span id="line-288"></span><span id="callback"><span class="annot"><span class="annottext">callback :: Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var hs-var">callback</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; ByteString
</span><a href="IC.Test.Universal.html#run"><span class="hs-identifier hs-var">run</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-type">replyData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="IC.Test.Universal.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-291"></span><span id="replyData"><span class="annot"><span class="annottext">replyData :: Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var hs-var">replyData</span></a></span></span><span> </span><span id="local-6989586621679383064"><span class="annot"><span class="annottext">Exp 'B
</span><a href="#local-6989586621679383064"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="#local-6989586621679383064"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var">reply</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- Convenient inter-canister calling</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">data</span><span> </span><span id="OneWayCallArgs"><span class="annot"><a href="IC.Test.Universal.html#OneWayCallArgs"><span class="hs-identifier hs-var">OneWayCallArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OneWayCallArgs"><span class="annot"><a href="IC.Test.Universal.html#OneWayCallArgs"><span class="hs-identifier hs-var">OneWayCallArgs</span></a></span></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="ow_arg"><span class="annot"><span class="annottext">OneWayCallArgs -&gt; ByteString
</span><a href="IC.Test.Universal.html#ow_arg"><span class="hs-identifier hs-var hs-var">ow_arg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ow_cycles"><span class="annot"><span class="annottext">OneWayCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#ow_cycles"><span class="hs-identifier hs-var hs-var">ow_cycles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ow_icpts"><span class="annot"><span class="annottext">OneWayCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#ow_icpts"><span class="hs-identifier hs-var hs-var">ow_icpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="IC.Test.Universal.html#oneway_call"><span class="hs-identifier hs-type">oneway_call</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#OneWayCallArgs"><span class="hs-identifier hs-type">OneWayCallArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-302"></span><span id="oneway_call"><span class="annot"><span class="annottext">oneway_call :: ByteString -&gt; ByteString -&gt; OneWayCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#oneway_call"><span class="hs-identifier hs-var hs-var">oneway_call</span></a></span></span><span> </span><span id="local-6989586621679383058"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383058"><span class="hs-identifier hs-var">callee</span></a></span></span><span> </span><span id="local-6989586621679383057"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383057"><span class="hs-identifier hs-var">method_name</span></a></span></span><span> </span><span id="local-6989586621679383056"><span class="annot"><span class="annottext">OneWayCallArgs
</span><a href="#local-6989586621679383056"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#oneWayCallNew"><span class="hs-identifier hs-var">oneWayCallNew</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383058"><span class="hs-identifier hs-var">callee</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383057"><span class="hs-identifier hs-var">method_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callDataAppend"><span class="hs-identifier hs-var">callDataAppend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">OneWayCallArgs -&gt; ByteString
</span><a href="IC.Test.Universal.html#ow_arg"><span class="hs-identifier hs-var">ow_arg</span></a></span><span> </span><span class="annot"><span class="annottext">OneWayCallArgs
</span><a href="#local-6989586621679383056"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">OneWayCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#ow_cycles"><span class="hs-identifier hs-var">ow_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">OneWayCallArgs
</span><a href="#local-6989586621679383056"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Exp 'I64 -&gt; Prog
</span><a href="IC.Test.Universal.html#callCyclesAdd"><span class="hs-identifier hs-var">callCyclesAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#int64"><span class="hs-identifier hs-var">int64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OneWayCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#ow_cycles"><span class="hs-identifier hs-var">ow_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">OneWayCallArgs
</span><a href="#local-6989586621679383056"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#callPerform"><span class="hs-identifier hs-var">callPerform</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-keyword">data</span><span> </span><span id="UpdateCallArgs"><span class="annot"><a href="IC.Test.Universal.html#UpdateCallArgs"><span class="hs-identifier hs-var">UpdateCallArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UpdateCallArgs"><span class="annot"><a href="IC.Test.Universal.html#UpdateCallArgs"><span class="hs-identifier hs-var">UpdateCallArgs</span></a></span></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="uc_on_reply"><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#uc_on_reply"><span class="hs-identifier hs-var hs-var">uc_on_reply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="uc_on_reject"><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#uc_on_reject"><span class="hs-identifier hs-var hs-var">uc_on_reject</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="uc_on_cleanup"><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Maybe Prog
</span><a href="IC.Test.Universal.html#uc_on_cleanup"><span class="hs-identifier hs-var hs-var">uc_on_cleanup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="uc_arg"><span class="annot"><span class="annottext">UpdateCallArgs -&gt; ByteString
</span><a href="IC.Test.Universal.html#uc_arg"><span class="hs-identifier hs-var hs-var">uc_arg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="uc_cycles"><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#uc_cycles"><span class="hs-identifier hs-var hs-var">uc_cycles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="uc_icpts"><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#uc_icpts"><span class="hs-identifier hs-var hs-var">uc_icpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="IC.Test.Universal.html#update_call"><span class="hs-identifier hs-type">update_call</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#UpdateCallArgs"><span class="hs-identifier hs-type">UpdateCallArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-318"></span><span id="update_call"><span class="annot"><span class="annottext">update_call :: ByteString -&gt; ByteString -&gt; UpdateCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#update_call"><span class="hs-identifier hs-var hs-var">update_call</span></a></span></span><span> </span><span id="local-6989586621679383046"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383046"><span class="hs-identifier hs-var">callee</span></a></span></span><span> </span><span id="local-6989586621679383045"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383045"><span class="hs-identifier hs-var">method_name</span></a></span></span><span> </span><span id="local-6989586621679383044"><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callNew"><span class="hs-identifier hs-var">callNew</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383046"><span class="hs-identifier hs-var">callee</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383045"><span class="hs-identifier hs-var">method_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#uc_on_reply"><span class="hs-identifier hs-var">uc_on_reply</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#uc_on_reject"><span class="hs-identifier hs-var">uc_on_reject</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callOnCleanup"><span class="hs-identifier hs-var">callOnCleanup</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Maybe Prog
</span><a href="IC.Test.Universal.html#uc_on_cleanup"><span class="hs-identifier hs-var">uc_on_cleanup</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#callDataAppend"><span class="hs-identifier hs-var">callDataAppend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs -&gt; ByteString
</span><a href="IC.Test.Universal.html#uc_arg"><span class="hs-identifier hs-var">uc_arg</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#uc_cycles"><span class="hs-identifier hs-var">uc_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Exp 'I64 -&gt; Prog
</span><a href="IC.Test.Universal.html#callCyclesAdd"><span class="hs-identifier hs-var">callCyclesAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#int64"><span class="hs-identifier hs-var">int64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UpdateCallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#uc_cycles"><span class="hs-identifier hs-var">uc_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383044"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#callPerform"><span class="hs-identifier hs-var">callPerform</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-keyword">data</span><span> </span><span id="CallArgs"><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-var">CallArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CallArgs"><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-var">CallArgs</span></a></span></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="on_reply"><span class="annot"><span class="annottext">CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#on_reply"><span class="hs-identifier hs-var hs-var">on_reply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="on_reject"><span class="annot"><span class="annottext">CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#on_reject"><span class="hs-identifier hs-var hs-var">on_reject</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="on_cleanup"><span class="annot"><span class="annottext">CallArgs -&gt; Maybe Prog
</span><a href="IC.Test.Universal.html#on_cleanup"><span class="hs-identifier hs-var hs-var">on_cleanup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="other_side"><span class="annot"><span class="annottext">CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#other_side"><span class="hs-identifier hs-var hs-var">other_side</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cycles"><span class="annot"><span class="annottext">CallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#cycles"><span class="hs-identifier hs-var hs-var">cycles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="icpts"><span class="annot"><span class="annottext">CallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#icpts"><span class="hs-identifier hs-var hs-var">icpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="IC.Test.Universal.html#inter_call"><span class="hs-identifier hs-type">inter_call</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-type">CallArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-336"></span><span id="inter_call"><span class="annot"><span class="annottext">inter_call :: ByteString -&gt; ByteString -&gt; CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#inter_call"><span class="hs-identifier hs-var hs-var">inter_call</span></a></span></span><span> </span><span id="local-6989586621679383034"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383034"><span class="hs-identifier hs-var">callee</span></a></span></span><span> </span><span id="local-6989586621679383033"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383033"><span class="hs-identifier hs-var">method_name</span></a></span></span><span> </span><span id="local-6989586621679383032"><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679383031"><span class="annot"><span class="annottext">uca :: UpdateCallArgs
</span><a href="#local-6989586621679383031"><span class="hs-identifier hs-var hs-var">uca</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog
-&gt; Prog
-&gt; Maybe Prog
-&gt; ByteString
-&gt; Word64
-&gt; Word64
-&gt; UpdateCallArgs
</span><a href="IC.Test.Universal.html#UpdateCallArgs"><span class="hs-identifier hs-var">UpdateCallArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#on_reply"><span class="hs-identifier hs-var">on_reply</span></a></span><span> </span><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#on_reject"><span class="hs-identifier hs-var">on_reject</span></a></span><span> </span><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallArgs -&gt; Maybe Prog
</span><a href="IC.Test.Universal.html#on_cleanup"><span class="hs-identifier hs-var">on_cleanup</span></a></span><span> </span><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; ByteString
</span><a href="IC.Test.Universal.html#run"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#other_side"><span class="hs-identifier hs-var">other_side</span></a></span><span> </span><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#cycles"><span class="hs-identifier hs-var">cycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallArgs -&gt; Word64
</span><a href="IC.Test.Universal.html#icpts"><span class="hs-identifier hs-var">icpts</span></a></span><span> </span><span class="annot"><span class="annottext">CallArgs
</span><a href="#local-6989586621679383032"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; UpdateCallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#update_call"><span class="hs-identifier hs-var">update_call</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383034"><span class="hs-identifier hs-var">callee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383033"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateCallArgs
</span><a href="#local-6989586621679383031"><span class="hs-identifier hs-var">uca</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="IC.Test.Universal.html#inter_update"><span class="hs-identifier hs-type">inter_update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-type">CallArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-341"></span><span id="inter_update"><span class="annot"><span class="annottext">inter_update :: ByteString -&gt; CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#inter_update"><span class="hs-identifier hs-var hs-var">inter_update</span></a></span></span><span> </span><span id="local-6989586621679383029"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383029"><span class="hs-identifier hs-var">callee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#inter_call"><span class="hs-identifier hs-var">inter_call</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383029"><span class="hs-identifier hs-var">callee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;update&quot;</span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="IC.Test.Universal.html#inter_query"><span class="hs-identifier hs-type">inter_query</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-type">CallArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-344"></span><span id="inter_query"><span class="annot"><span class="annottext">inter_query :: ByteString -&gt; CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#inter_query"><span class="hs-identifier hs-var hs-var">inter_query</span></a></span></span><span> </span><span id="local-6989586621679383027"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383027"><span class="hs-identifier hs-var">callee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; CallArgs -&gt; Prog
</span><a href="IC.Test.Universal.html#inter_call"><span class="hs-identifier hs-var">inter_call</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679383027"><span class="hs-identifier hs-var">callee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;query&quot;</span></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | By default, the other side responds with some text</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- indicating caller and callee, and the callbacks reply with the response.</span><span>
</span><span id="line-348"></span><span class="annot"><a href="IC.Test.Universal.html#defOneWayArgs"><span class="hs-identifier hs-type">defOneWayArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#OneWayCallArgs"><span class="hs-identifier hs-type">OneWayCallArgs</span></a></span><span>
</span><span id="line-349"></span><span id="defOneWayArgs"><span class="annot"><span class="annottext">defOneWayArgs :: OneWayCallArgs
</span><a href="IC.Test.Universal.html#defOneWayArgs"><span class="hs-identifier hs-var hs-var">defOneWayArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#OneWayCallArgs"><span class="hs-identifier hs-type">OneWayCallArgs</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ow_arg :: ByteString
</span><a href="IC.Test.Universal.html#ow_arg"><span class="hs-identifier hs-var">ow_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ow_cycles :: Word64
</span><a href="IC.Test.Universal.html#ow_cycles"><span class="hs-identifier hs-var">ow_cycles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ow_icpts :: Word64
</span><a href="IC.Test.Universal.html#ow_icpts"><span class="hs-identifier hs-var">ow_icpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="annot"><a href="IC.Test.Universal.html#defUpdateArgs"><span class="hs-identifier hs-type">defUpdateArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#UpdateCallArgs"><span class="hs-identifier hs-type">UpdateCallArgs</span></a></span><span>
</span><span id="line-356"></span><span id="defUpdateArgs"><span class="annot"><span class="annottext">defUpdateArgs :: UpdateCallArgs
</span><a href="IC.Test.Universal.html#defUpdateArgs"><span class="hs-identifier hs-var hs-var">defUpdateArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#UpdateCallArgs"><span class="hs-identifier hs-type">UpdateCallArgs</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">uc_on_reply :: Prog
</span><a href="IC.Test.Universal.html#uc_on_reply"><span class="hs-identifier hs-var">uc_on_reply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayReply"><span class="hs-identifier hs-var">relayReply</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uc_on_reject :: Prog
</span><a href="IC.Test.Universal.html#uc_on_reject"><span class="hs-identifier hs-var">uc_on_reject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayReject"><span class="hs-identifier hs-var">relayReject</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uc_on_cleanup :: Maybe Prog
</span><a href="IC.Test.Universal.html#uc_on_cleanup"><span class="hs-identifier hs-var">uc_on_cleanup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uc_arg :: ByteString
</span><a href="IC.Test.Universal.html#uc_arg"><span class="hs-identifier hs-var">uc_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uc_cycles :: Word64
</span><a href="IC.Test.Universal.html#uc_cycles"><span class="hs-identifier hs-var">uc_cycles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">uc_icpts :: Word64
</span><a href="IC.Test.Universal.html#uc_icpts"><span class="hs-identifier hs-var">uc_icpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><a href="IC.Test.Universal.html#defArgs"><span class="hs-identifier hs-type">defArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-type">CallArgs</span></a></span><span>
</span><span id="line-366"></span><span id="defArgs"><span class="annot"><span class="annottext">defArgs :: CallArgs
</span><a href="IC.Test.Universal.html#defArgs"><span class="hs-identifier hs-var hs-var">defArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#CallArgs"><span class="hs-identifier hs-type">CallArgs</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">on_reply :: Prog
</span><a href="IC.Test.Universal.html#on_reply"><span class="hs-identifier hs-var">on_reply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayReply"><span class="hs-identifier hs-var">relayReply</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">on_reject :: Prog
</span><a href="IC.Test.Universal.html#on_reject"><span class="hs-identifier hs-var">on_reject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayReject"><span class="hs-identifier hs-var">relayReject</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">on_cleanup :: Maybe Prog
</span><a href="IC.Test.Universal.html#on_cleanup"><span class="hs-identifier hs-var">on_cleanup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">other_side :: Prog
</span><a href="IC.Test.Universal.html#other_side"><span class="hs-identifier hs-var">other_side</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#defaultOtherSide"><span class="hs-identifier hs-var">defaultOtherSide</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cycles :: Word64
</span><a href="IC.Test.Universal.html#cycles"><span class="hs-identifier hs-var">cycles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">icpts :: Word64
</span><a href="IC.Test.Universal.html#icpts"><span class="hs-identifier hs-var">icpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="annot"><a href="IC.Test.Universal.html#defaultOtherSide"><span class="hs-identifier hs-type">defaultOtherSide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-376"></span><span id="defaultOtherSide"><span class="annot"><span class="annottext">defaultOtherSide :: Prog
</span><a href="IC.Test.Universal.html#defaultOtherSide"><span class="hs-identifier hs-var hs-var">defaultOtherSide</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><span class="hs-string">&quot;Hello &quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#caller"><span class="hs-identifier hs-var">caller</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><span class="hs-string">&quot; this is &quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#self"><span class="hs-identifier hs-var">self</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var">reply</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><a href="IC.Test.Universal.html#relayReplyImpl"><span class="hs-identifier hs-type">relayReplyImpl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-384"></span><span id="relayReplyImpl"><span class="annot"><span class="annottext">relayReplyImpl :: Prog
</span><a href="IC.Test.Universal.html#relayReplyImpl"><span class="hs-identifier hs-var hs-var">relayReplyImpl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i2b"><span class="hs-identifier hs-var">i2b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#argData"><span class="hs-identifier hs-var">argData</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="IC.Test.Universal.html#relayReply"><span class="hs-identifier hs-type">relayReply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-389"></span><span id="relayReply"><span class="annot"><span class="annottext">relayReply :: Prog
</span><a href="IC.Test.Universal.html#relayReply"><span class="hs-identifier hs-var hs-var">relayReply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayReplyImpl"><span class="hs-identifier hs-var">relayReplyImpl</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var">reply</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="IC.Test.Universal.html#relayReplyRefund"><span class="hs-identifier hs-type">relayReplyRefund</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-394"></span><span id="relayReplyRefund"><span class="annot"><span class="annottext">relayReplyRefund :: Word64 -&gt; Prog
</span><a href="IC.Test.Universal.html#relayReplyRefund"><span class="hs-identifier hs-var hs-var">relayReplyRefund</span></a></span></span><span> </span><span id="local-6989586621679383018"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383018"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayReplyImpl"><span class="hs-identifier hs-var">relayReplyImpl</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#trapIfNeq"><span class="hs-identifier hs-var">trapIfNeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i64tob"><span class="hs-identifier hs-var">i64tob</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I64
</span><a href="IC.Test.Universal.html#getRefund"><span class="hs-identifier hs-var">getRefund</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i64tob"><span class="hs-identifier hs-var">i64tob</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#int64"><span class="hs-identifier hs-var">int64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383018"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.String.html#fromString"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The call should refund exactly &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383018"><span class="hs-identifier hs-var">amount</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; cycles.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var">reply</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><a href="IC.Test.Universal.html#relayRejectImpl"><span class="hs-identifier hs-type">relayRejectImpl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-400"></span><span id="relayRejectImpl"><span class="annot"><span class="annottext">relayRejectImpl :: Prog
</span><a href="IC.Test.Universal.html#relayRejectImpl"><span class="hs-identifier hs-var hs-var">relayRejectImpl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i2b"><span class="hs-identifier hs-var">i2b</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="IC.Test.Universal.html#reject_code"><span class="hs-identifier hs-var">reject_code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyDataAppend"><span class="hs-identifier hs-var">replyDataAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#reject_msg"><span class="hs-identifier hs-var">reject_msg</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><a href="IC.Test.Universal.html#relayReject"><span class="hs-identifier hs-type">relayReject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-405"></span><span id="relayReject"><span class="annot"><span class="annottext">relayReject :: Prog
</span><a href="IC.Test.Universal.html#relayReject"><span class="hs-identifier hs-var hs-var">relayReject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayRejectImpl"><span class="hs-identifier hs-var">relayRejectImpl</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var">reply</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="annot"><a href="IC.Test.Universal.html#relayRejectRefund"><span class="hs-identifier hs-type">relayRejectRefund</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Test.Universal.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span>
</span><span id="line-410"></span><span id="relayRejectRefund"><span class="annot"><span class="annottext">relayRejectRefund :: Word64 -&gt; Prog
</span><a href="IC.Test.Universal.html#relayRejectRefund"><span class="hs-identifier hs-var hs-var">relayRejectRefund</span></a></span></span><span> </span><span id="local-6989586621679383014"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383014"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#relayRejectImpl"><span class="hs-identifier hs-var">relayRejectImpl</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B -&gt; Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#trapIfNeq"><span class="hs-identifier hs-var">trapIfNeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i64tob"><span class="hs-identifier hs-var">i64tob</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I64
</span><a href="IC.Test.Universal.html#getRefund"><span class="hs-identifier hs-var">getRefund</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I64 -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#i64tob"><span class="hs-identifier hs-var">i64tob</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp 'I64
</span><a href="IC.Test.Universal.html#int64"><span class="hs-identifier hs-var">int64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383014"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.String.html#fromString"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The call should refund exactly &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679383014"><span class="hs-identifier hs-var">amount</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; cycles.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#reply"><span class="hs-identifier hs-var">reply</span></a></span><span>
</span><span id="line-414"></span></pre></body></html>