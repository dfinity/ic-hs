<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">{-|
This module implements the management canister logic of the Internet Computer.
-}</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IC.Ref.Management</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Management.html#invokeManagementCanister"><span class="hs-identifier">invokeManagementCanister</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.html"><span class="hs-identifier">Data.Row</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Variants.html"><span class="hs-identifier">Data.Row.Variants</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vec</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Numeric.Natural.html"><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html"><span class="hs-identifier">Control.Monad.State.Class</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/z2nj2f44psha18adfp88w2mqhkhcb6zx-MonadRandom-0.5.3-doc/share/doc/MonadRandom-0.5.3/html/src/Control.Monad.Random.Lazy.html"><span class="hs-identifier">Control.Monad.Random.Lazy</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.html"><span class="hs-identifier">Codec.Candid</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.html"><span class="hs-identifier">Data.Row</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator">(.==)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator">(.+)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator">(.!)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator">(.!)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Constants.html"><span class="hs-identifier">IC.Constants</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Canister.html"><span class="hs-identifier">IC.Canister</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Id.Fresh.html"><span class="hs-identifier">IC.Id.Fresh</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Management.html"><span class="hs-identifier">IC.Management</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Crypto.Bitcoin.html"><span class="hs-identifier">IC.Crypto.Bitcoin</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bitcoin</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Ref.HTTP.html"><span class="hs-identifier">IC.Ref.HTTP</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Ref.Types.html"><span class="hs-identifier">IC.Ref.Types</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="IC.Ref.Management.html#invokeManagementCanister"><span class="hs-identifier hs-type">invokeManagementCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679399204"><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#EntryPoint"><span class="hs-identifier hs-type">EntryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span id="invokeManagementCanister"><span class="annot"><span class="annottext">invokeManagementCanister :: forall (m :: * -&gt; *).
(CanReject m, ICM m, MonadIO m) =&gt;
EntityId -&gt; Maybe Subnet -&gt; CallId -&gt; EntryPoint -&gt; m ()
</span><a href="IC.Ref.Management.html#invokeManagementCanister"><span class="hs-identifier hs-var hs-var">invokeManagementCanister</span></a></span></span><span> </span><span id="local-6989586621679396986"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679396985"><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span></span><span> </span><span id="local-6989586621679396984"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#Public"><span class="hs-identifier hs-type">Public</span></a></span><span> </span><span id="local-6989586621679396982"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span></span><span> </span><span id="local-6989586621679396981"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396981"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-53"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;create_canister&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
EntityId -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-var">noSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet -&gt; CallId -&gt; ICManagement m .! &quot;create_canister&quot;
</span><a href="IC.Ref.Management.html#icCreateCanister"><span class="hs-identifier hs-var">icCreateCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-54"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;install_code&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId -&gt; CallId -&gt; ICManagement m .! &quot;install_code&quot;
</span><a href="IC.Ref.Management.html#icInstallCode"><span class="hs-identifier hs-var">icInstallCode</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-55"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;uninstall_code&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
CallId -&gt; ICManagement m .! &quot;uninstall_code&quot;
</span><a href="IC.Ref.Management.html#icUninstallCode"><span class="hs-identifier hs-var">icUninstallCode</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;update_settings&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
CallId -&gt; ICManagement m .! &quot;update_settings&quot;
</span><a href="IC.Ref.Management.html#icUpdateCanisterSettings"><span class="hs-identifier hs-var">icUpdateCanisterSettings</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;start_canister&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;start_canister&quot;
</span><a href="IC.Ref.Management.html#icStartCanister"><span class="hs-identifier hs-var">icStartCanister</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;stop_canister&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="#local-6989586621679396970"><span class="hs-identifier hs-var">deferred</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
(ICM m, CanReject m,
 (a -&gt; m b) ~ (ICManagement m .! &quot;stop_canister&quot;)) =&gt;
CallId -&gt; a -&gt; m ()
</span><a href="IC.Ref.Management.html#icStopCanister"><span class="hs-identifier hs-var">icStopCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister_status&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;canister_status&quot;
</span><a href="IC.Ref.Management.html#icCanisterStatus"><span class="hs-identifier hs-var">icCanisterStatus</span></a></span><span>
</span><span id="line-60"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister_info&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;canister_info&quot;
</span><a href="IC.Ref.Management.html#icCanisterInfo"><span class="hs-identifier hs-var">icCanisterInfo</span></a></span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;delete_canister&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var">onlyControllerOrSelf</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;delete_canister&quot;
</span><a href="IC.Ref.Management.html#icDeleteCanister"><span class="hs-identifier hs-var">icDeleteCanister</span></a></span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;deposit_cycles&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
CallId -&gt; ICManagement m .! &quot;deposit_cycles&quot;
</span><a href="IC.Ref.Management.html#icDepositCycles"><span class="hs-identifier hs-var">icDepositCycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;provisional_create_canister_with_cycles&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet
-&gt; CallId
-&gt; ICManagement m .! &quot;provisional_create_canister_with_cycles&quot;
</span><a href="IC.Ref.Management.html#icCreateCanisterWithCycles"><span class="hs-identifier hs-var">icCreateCanisterWithCycles</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;provisional_top_up_canister&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var">fetchCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;provisional_top_up_canister&quot;
</span><a href="IC.Ref.Management.html#icTopUpCanister"><span class="hs-identifier hs-var">icTopUpCanister</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;raw_rand&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
EntityId -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-var">noSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; ICManagement m .! &quot;raw_rand&quot;
</span><a href="IC.Ref.Management.html#icRawRand"><span class="hs-identifier hs-var">icRawRand</span></a></span><span>
</span><span id="line-66"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;http_request&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
EntityId -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-var">noSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet -&gt; CallId -&gt; ICManagement m .! &quot;http_request&quot;
</span><a href="IC.Ref.HTTP.html#icHttpRequest"><span class="hs-identifier hs-var">icHttpRequest</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;ecdsa_public_key&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Maybe Principal) =&gt;
EntityId -&gt; Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterIdfromMaybe"><span class="hs-identifier hs-var">fetchCanisterIdfromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId -&gt; ICManagement m .! &quot;ecdsa_public_key&quot;
</span><a href="IC.Ref.Management.html#icEcdsaPublicKey"><span class="hs-identifier hs-var">icEcdsaPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span>
</span><span id="line-68"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;sign_with_ecdsa&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var">atomic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
EntityId -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-var">noSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396985"><span class="hs-identifier hs-var">maybeSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId -&gt; ICManagement m .! &quot;sign_with_ecdsa&quot;
</span><a href="IC.Ref.Management.html#icSignWithEcdsa"><span class="hs-identifier hs-var">icSignWithEcdsa</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396986"><span class="hs-identifier hs-var">caller</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_DESTINATION_INVALID"><span class="hs-identifier hs-var">RC_DESTINATION_INVALID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Unsupported management function &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396982"><span class="hs-identifier hs-var">method_name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_METHOD_NOT_FOUND"><span class="hs-identifier hs-var">EC_METHOD_NOT_FOUND</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- always responds</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="#local-6989586621679396980"><span class="hs-identifier hs-type">atomic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679399123"><span class="annot"><a href="#local-6989586621679399123"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679399122"><span class="annot"><a href="#local-6989586621679399122"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#CandidArg"><span class="hs-identifier hs-type">CandidArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399123"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#CandidArg"><span class="hs-identifier hs-type">CandidArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399122"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399123"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399122"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679396980"><span class="annot"><span class="annottext">atomic :: forall a b. (CandidArg a, CandidArg b) =&gt; (a -&gt; m b) -&gt; m ()
</span><a href="#local-6989586621679396980"><span class="hs-identifier hs-var hs-var">atomic</span></a></span></span><span> </span><span id="local-6989586621679396946"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679396946"><span class="hs-identifier hs-var">meth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(CandidArg a, CandidArg b) =&gt;
((b -&gt; m ()) -&gt; a -&gt; m ())
-&gt; (ByteString -&gt; m ()) -&gt; ByteString -&gt; m ()
</span><a href="#local-6989586621679396945"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396944"><span class="annot"><span class="annottext">b -&gt; m ()
</span><a href="#local-6989586621679396944"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679396943"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679396943"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679396946"><span class="hs-identifier hs-var">meth</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679396943"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; m ()
</span><a href="#local-6989586621679396944"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; ByteString -&gt; m ()
</span><a href="IC.Ref.Types.html#replyCallContext"><span class="hs-identifier hs-var">replyCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396984"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396981"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- no implict reply</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="#local-6989586621679396970"><span class="hs-identifier hs-type">deferred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679399103"><span class="annot"><a href="#local-6989586621679399103"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#CandidArg"><span class="hs-identifier hs-type">CandidArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679396970"><span class="annot"><span class="annottext">deferred :: forall a. CandidArg a =&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="#local-6989586621679396970"><span class="hs-identifier hs-var hs-var">deferred</span></a></span></span><span> </span><span id="local-6989586621679396936"><span class="annot"><span class="annottext">a -&gt; m ()
</span><a href="#local-6989586621679396936"><span class="hs-identifier hs-var">meth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(CandidArg a, CandidArg b) =&gt;
((b -&gt; m ()) -&gt; a -&gt; m ())
-&gt; (ByteString -&gt; m ()) -&gt; ByteString -&gt; m ()
</span><a href="#local-6989586621679396945"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679399103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396935"><span class="annot"><span class="annottext">() -&gt; m ()
</span><a href="#local-6989586621679396935"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679396934"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679396934"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m ()
</span><a href="#local-6989586621679396936"><span class="hs-identifier hs-var">meth</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679396934"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;unused&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396981"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="#local-6989586621679396945"><span class="hs-identifier hs-type">wrap</span></a></span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679399081"><span class="annot"><a href="#local-6989586621679399081"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679399080"><span class="annot"><a href="#local-6989586621679399080"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#CandidArg"><span class="hs-identifier hs-type">CandidArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399081"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#CandidArg"><span class="hs-identifier hs-type">CandidArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399080"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399080"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679396945"><span class="annot"><span class="annottext">wrap :: forall a b.
(CandidArg a, CandidArg b) =&gt;
((b -&gt; m ()) -&gt; a -&gt; m ())
-&gt; (ByteString -&gt; m ()) -&gt; ByteString -&gt; m ()
</span><a href="#local-6989586621679396945"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679396925"><span class="annot"><span class="annottext">(b -&gt; m ()) -&gt; a -&gt; m ()
</span><a href="#local-6989586621679396925"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679396924"><span class="annot"><span class="annottext">ByteString -&gt; m ()
</span><a href="#local-6989586621679396924"><span class="hs-identifier hs-var">raw_reply</span></a></span></span><span> </span><span id="local-6989586621679396923"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396923"><span class="hs-identifier hs-var">blob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; ByteString -&gt; Either MethodName a
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679399081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396923"><span class="hs-identifier hs-var">blob</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679396921"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396921"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Candid failed to decode: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396921"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_ENCODING"><span class="hs-identifier hs-var">EC_INVALID_ENCODING</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679396918"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679396918"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; m ()) -&gt; a -&gt; m ()
</span><a href="#local-6989586621679396925"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; m ()
</span><a href="#local-6989586621679396924"><span class="hs-identifier hs-var">raw_reply</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679399080"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679396918"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="IC.Ref.Management.html#invokeManagementCanister"><span class="hs-identifier hs-var">invokeManagementCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CallId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Closure"><span class="hs-identifier hs-type">Closure</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;closure invoked on management canister&quot;</span></span><span>
</span><span id="line-90"></span><span class="annot"><a href="IC.Ref.Management.html#invokeManagementCanister"><span class="hs-identifier hs-var">invokeManagementCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CallId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EntryPoint
</span><a href="IC.Ref.Types.html#Heartbeat"><span class="hs-identifier hs-var">Heartbeat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;heartbeat invoked on management canister&quot;</span></span><span>
</span><span id="line-91"></span><span class="annot"><a href="IC.Ref.Management.html#invokeManagementCanister"><span class="hs-identifier hs-var">invokeManagementCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CallId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EntryPoint
</span><a href="IC.Ref.Types.html#GlobalTimer"><span class="hs-identifier hs-var">GlobalTimer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;global timer invoked on management canister&quot;</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679399065"><span class="annot"><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-type">icAddCanisterHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#ChangeDetails"><span class="hs-identifier hs-type">ChangeDetails</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-94"></span><span id="icAddCanisterHistory"><span class="annot"><span class="annottext">icAddCanisterHistory :: forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var hs-var">icAddCanisterHistory</span></a></span></span><span> </span><span id="local-6989586621679396873"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396873"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span id="local-6989586621679396872"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396872"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679396871"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679396871"><span class="hs-identifier hs-var">sender_canister_version</span></a></span></span><span> </span><span id="local-6989586621679396870"><span class="annot"><span class="annottext">ChangeDetails
</span><a href="#local-6989586621679396870"><span class="hs-identifier hs-var">change_details</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679396869"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396869"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396873"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="IC.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span id="local-6989586621679396866"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396866"><span class="hs-identifier hs-var">timestamp_nanos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Timestamp
</span><a href="IC.Ref.Types.html#time"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396869"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679396864"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679396864"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var">getCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396872"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679396862"><span class="annot"><span class="annottext">ChangeOrigin
</span><a href="#local-6989586621679396862"><span class="hs-identifier hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CallOrigin -&gt; m ChangeOrigin
</span><a href="#local-6989586621679396861"><span class="hs-identifier hs-var">mapCallOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; CallOrigin
</span><a href="IC.Ref.Types.html#origin"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679396864"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396859"><span class="annot"><span class="annottext">change :: Change
</span><a href="#local-6989586621679396859"><span class="hs-identifier hs-var hs-var">change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; ChangeOrigin -&gt; ChangeDetails -&gt; Change
</span><a href="IC.Types.html#Change"><span class="hs-identifier hs-var">Change</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396866"><span class="hs-identifier hs-var">timestamp_nanos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396869"><span class="hs-identifier hs-var">can_state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChangeOrigin
</span><a href="#local-6989586621679396862"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeDetails
</span><a href="#local-6989586621679396870"><span class="hs-identifier hs-var">change_details</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Change -&gt; m ()
</span><a href="IC.Ref.Types.html#addCanisterHistory"><span class="hs-identifier hs-var">addCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396873"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Change
</span><a href="#local-6989586621679396859"><span class="hs-identifier hs-var">change</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679396861"><span class="annot"><span class="annottext">mapCallOrigin :: CallOrigin -&gt; m ChangeOrigin
</span><a href="#local-6989586621679396861"><span class="hs-identifier hs-var hs-var">mapCallOrigin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#FromCanister"><span class="hs-identifier hs-type">FromCanister</span></a></span><span> </span><span id="local-6989586621679396854"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396854"><span class="hs-identifier hs-var">ctxt_id'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Callback
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>      </span><span id="local-6989586621679396853"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396853"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m EntityId
</span><a href="IC.Ref.Types.html#calleeOfCallID"><span class="hs-identifier hs-var">calleeOfCallID</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396854"><span class="hs-identifier hs-var">ctxt_id'</span></a></span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; Maybe Word64 -&gt; ChangeOrigin
</span><a href="IC.Types.html#ChangeFromCanister"><span class="hs-identifier hs-var">ChangeFromCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396853"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679396871"><span class="hs-identifier hs-var">sender_canister_version</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="#local-6989586621679396861"><span class="hs-identifier hs-var">mapCallOrigin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#FromUser"><span class="hs-identifier hs-type">FromUser</span></a></span><span> </span><span id="local-6989586621679396849"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396849"><span class="hs-identifier hs-var">rid</span></a></span></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>      </span><span id="local-6989586621679396848"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396848"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; ByteString -&gt; m EntityId
</span><a href="IC.Ref.Types.html#callerOfRequest"><span class="hs-identifier hs-var">callerOfRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396849"><span class="hs-identifier hs-var">rid</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; ChangeOrigin
</span><a href="IC.Types.html#ChangeFromUser"><span class="hs-identifier hs-var">ChangeFromUser</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396848"><span class="hs-identifier hs-var">caller</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="#local-6989586621679396861"><span class="hs-identifier hs-var">mapCallOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">CallOrigin
</span><a href="IC.Ref.Types.html#FromSystemTask"><span class="hs-identifier hs-var">FromSystemTask</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;trying to add change from SystemTask to canister history&quot;</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679399115"><span class="annot"><a href="IC.Ref.Management.html#icCreateCanister"><span class="hs-identifier hs-type">icCreateCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399115"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399115"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;create_canister&quot;</span></span></span><span>
</span><span id="line-111"></span><span id="icCreateCanister"><span class="annot"><span class="annottext">icCreateCanister :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet -&gt; CallId -&gt; ICManagement m .! &quot;create_canister&quot;
</span><a href="IC.Ref.Management.html#icCreateCanister"><span class="hs-identifier hs-var hs-var">icCreateCanister</span></a></span></span><span> </span><span id="local-6989586621679396784"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396784"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679396783"><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396783"><span class="hs-identifier hs-var">maybe_subnet</span></a></span></span><span> </span><span id="local-6989586621679396782"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396782"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679396781"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
</span><a href="#local-6989586621679396781"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
</span><a href="#local-6989586621679396781"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). CanReject m =&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#validateSettings"><span class="hs-identifier hs-var">validateSettings</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679396778"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396778"><span class="hs-identifier hs-var">available</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCallContextCycles"><span class="hs-identifier hs-var">getCallContextCycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396782"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCallContextCycles"><span class="hs-identifier hs-var">setCallContextCycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396782"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679396775"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396775"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet
-&gt; Maybe EntityId
-&gt; EntityId
-&gt; Natural
-&gt; m EntityId
</span><a href="IC.Ref.Management.html#icCreateCanisterCommon"><span class="hs-identifier hs-var">icCreateCanisterCommon</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396784"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396783"><span class="hs-identifier hs-var">maybe_subnet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396784"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396778"><span class="hs-identifier hs-var">available</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
</span><a href="#local-6989586621679396781"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#applySettings"><span class="hs-identifier hs-var">applySettings</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396775"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679396772"><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396772"><span class="hs-identifier hs-var">controllers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m (Set EntityId)
</span><a href="IC.Ref.Types.html#getControllers"><span class="hs-identifier hs-var">getControllers</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396775"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var">icAddCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396775"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396782"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
</span><a href="#local-6989586621679396781"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;sender_canister_version&quot; a =&gt; a
</span><span class="">#sender_canister_version</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[EntityId] -&gt; ChangeDetails
</span><a href="IC.Types.html#Creation"><span class="hs-identifier hs-var">Creation</span></a></span><span> </span><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396772"><span class="hs-identifier hs-var">controllers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; Principal
</span><a href="IC.Management.html#entityIdToPrincipal"><span class="hs-identifier hs-var">entityIdToPrincipal</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396775"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621679399095"><span class="annot"><a href="IC.Ref.Management.html#icCreateCanisterWithCycles"><span class="hs-identifier hs-type">icCreateCanisterWithCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399095"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399095"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;provisional_create_canister_with_cycles&quot;</span></span></span><span>
</span><span id="line-122"></span><span id="icCreateCanisterWithCycles"><span class="annot"><span class="annottext">icCreateCanisterWithCycles :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet
-&gt; CallId
-&gt; ICManagement m .! &quot;provisional_create_canister_with_cycles&quot;
</span><a href="IC.Ref.Management.html#icCreateCanisterWithCycles"><span class="hs-identifier hs-var hs-var">icCreateCanisterWithCycles</span></a></span></span><span> </span><span id="local-6989586621679396708"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396708"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679396707"><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396707"><span class="hs-identifier hs-var">maybe_subnet</span></a></span></span><span> </span><span id="local-6989586621679396706"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396706"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679396705"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
        &quot;specified_id&quot; ':-&gt; Maybe Principal])
</span><a href="#local-6989586621679396705"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
        &quot;specified_id&quot; ':-&gt; Maybe Principal])
</span><a href="#local-6989586621679396705"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). CanReject m =&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#validateSettings"><span class="hs-identifier hs-var">validateSettings</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679396704"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396704"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m EntityId
</span><a href="IC.Ref.Types.html#ecidOfCallID"><span class="hs-identifier hs-var">ecidOfCallID</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396706"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679396702"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396702"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet
-&gt; Maybe EntityId
-&gt; EntityId
-&gt; Natural
-&gt; m EntityId
</span><a href="IC.Ref.Management.html#icCreateCanisterCommon"><span class="hs-identifier hs-var">icCreateCanisterCommon</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396704"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396707"><span class="hs-identifier hs-var">maybe_subnet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
        &quot;specified_id&quot; ':-&gt; Maybe Principal])
</span><a href="#local-6989586621679396705"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;specified_id&quot; a =&gt; a
</span><span class="">#specified_id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396708"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="IC.Constants.html#cDEFAULT_PROVISIONAL_CYCLES_BALANCE"><span class="hs-identifier hs-var">cDEFAULT_PROVISIONAL_CYCLES_BALANCE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
        &quot;specified_id&quot; ':-&gt; Maybe Principal])
</span><a href="#local-6989586621679396705"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;amount&quot; a =&gt; a
</span><span class="">#amount</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
        &quot;specified_id&quot; ':-&gt; Maybe Principal])
</span><a href="#local-6989586621679396705"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#applySettings"><span class="hs-identifier hs-var">applySettings</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396702"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679396698"><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396698"><span class="hs-identifier hs-var">controllers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m (Set EntityId)
</span><a href="IC.Ref.Types.html#getControllers"><span class="hs-identifier hs-var">getControllers</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396702"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var">icAddCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396702"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396706"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
        &quot;specified_id&quot; ':-&gt; Maybe Principal])
</span><a href="#local-6989586621679396705"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;sender_canister_version&quot; a =&gt; a
</span><span class="">#sender_canister_version</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[EntityId] -&gt; ChangeDetails
</span><a href="IC.Types.html#Creation"><span class="hs-identifier hs-var">Creation</span></a></span><span> </span><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396698"><span class="hs-identifier hs-var">controllers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; Principal
</span><a href="IC.Management.html#entityIdToPrincipal"><span class="hs-identifier hs-var">entityIdToPrincipal</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396702"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621679399028"><span class="annot"><a href="IC.Ref.Management.html#icCreateCanisterCommon"><span class="hs-identifier hs-type">icCreateCanisterCommon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399028"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399028"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399028"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span></span><span>
</span><span id="line-132"></span><span id="icCreateCanisterCommon"><span class="annot"><span class="annottext">icCreateCanisterCommon :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId
-&gt; Maybe Subnet
-&gt; Maybe EntityId
-&gt; EntityId
-&gt; Natural
-&gt; m EntityId
</span><a href="IC.Ref.Management.html#icCreateCanisterCommon"><span class="hs-identifier hs-var hs-var">icCreateCanisterCommon</span></a></span></span><span> </span><span id="local-6989586621679396656"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396656"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span id="local-6989586621679396655"><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396655"><span class="hs-identifier hs-var">maybe_subnet</span></a></span></span><span> </span><span id="local-6989586621679396654"><span class="annot"><span class="annottext">Maybe EntityId
</span><a href="#local-6989586621679396654"><span class="hs-identifier hs-var">specified_id</span></a></span></span><span> </span><span id="local-6989586621679396653"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396653"><span class="hs-identifier hs-var">controller</span></a></span></span><span> </span><span id="local-6989586621679396652"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396652"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679396651"><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396651"><span class="hs-identifier hs-var">ranges</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679396655"><span class="hs-identifier hs-var">maybe_subnet</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679396650"><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396650"><span class="hs-identifier hs-var">ranges</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m Subnet
</span><a href="IC.Ref.Types.html#getSubnetFromCanisterId"><span class="hs-identifier hs-var">getSubnetFromCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396656"><span class="hs-identifier hs-var">ecid</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396650"><span class="hs-identifier hs-var">ranges</span></a></span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679396648"><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396648"><span class="hs-identifier hs-var">ranges</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396648"><span class="hs-identifier hs-var">ranges</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679396647"><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396647"><span class="hs-identifier hs-var">taken</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">M.keys</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; EntityId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679396643"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396643"><span class="hs-identifier hs-var">new_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe EntityId
</span><a href="#local-6989586621679396654"><span class="hs-identifier hs-var">specified_id</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-140"></span><span>                </span><span class="annot"><span class="annottext">Maybe EntityId
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)] -&gt; [EntityId] -&gt; Maybe EntityId
</span><a href="IC.Id.Fresh.html#freshId"><span class="hs-identifier hs-var">freshId</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396651"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396647"><span class="hs-identifier hs-var">taken</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>                    </span><span class="annot"><span class="annottext">Maybe EntityId
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_SYS_FATAL"><span class="hs-identifier hs-var">RC_SYS_FATAL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Could not create canister. Subnet has surpassed its canister ID allocation.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-143"></span><span>                    </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679396640"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396640"><span class="hs-identifier hs-var">new_id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396640"><span class="hs-identifier hs-var">new_id</span></a></span><span>
</span><span id="line-144"></span><span>                </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679396639"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396639"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396639"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679396647"><span class="hs-identifier hs-var">taken</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-146"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_DESTINATION_INVALID"><span class="hs-identifier hs-var">RC_DESTINATION_INVALID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;The specified_id of the created canister is already in use.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-147"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Word64, Word64)] -&gt; EntityId -&gt; Bool
</span><a href="IC.Id.Fresh.html#checkCanisterIdInRanges"><span class="hs-identifier hs-var">checkCanisterIdInRanges</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679396651"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396639"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-148"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_REJECT"><span class="hs-identifier hs-var">RC_CANISTER_REJECT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;The specified_id of the created canister does not belong to the subnet's canister ranges.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-149"></span><span>                  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396639"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396631"><span class="annot"><span class="annottext">currentTime :: Timestamp
</span><a href="#local-6989586621679396631"><span class="hs-identifier hs-var hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- ic-ref lives in the 70ies</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; Set EntityId -&gt; Timestamp -&gt; m ()
</span><a href="IC.Ref.Types.html#createEmptyCanister"><span class="hs-identifier hs-var">createEmptyCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396643"><span class="hs-identifier hs-var">new_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396653"><span class="hs-identifier hs-var">controller</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679396631"><span class="hs-identifier hs-var">currentTime</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-comment">-- Here we fill up the canister with the cycles provided by the caller</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setBalance"><span class="hs-identifier hs-var">setBalance</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396643"><span class="hs-identifier hs-var">new_id</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396652"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396643"><span class="hs-identifier hs-var">new_id</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621679399032"><span class="annot"><a href="IC.Ref.Management.html#validateSettings"><span class="hs-identifier hs-type">validateSettings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#Settings"><span class="hs-identifier hs-type">Settings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-157"></span><span id="validateSettings"><span class="annot"><span class="annottext">validateSettings :: forall (m :: * -&gt; *). CanReject m =&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#validateSettings"><span class="hs-identifier hs-var hs-var">validateSettings</span></a></span></span><span> </span><span id="local-6989586621679396575"><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396575"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396575"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;compute_allocation&quot; a =&gt; a
</span><span class="">#compute_allocation</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679396574"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396574"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396574"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Compute allocation not &lt;= 100&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_CONTRACT_VIOLATION"><span class="hs-identifier hs-var">EC_CANISTER_CONTRACT_VIOLATION</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396575"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;memory_allocation&quot; a =&gt; a
</span><span class="">#memory_allocation</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679396571"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396571"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396571"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallId
</span><span class="hs-number">48</span></span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Memory allocation not &lt;= 2^48&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_CONTRACT_VIOLATION"><span class="hs-identifier hs-var">EC_CANISTER_CONTRACT_VIOLATION</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396575"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;freezing_threshold&quot; a =&gt; a
</span><span class="">#freezing_threshold</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679396569"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396569"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679396569"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallId
</span><span class="hs-number">64</span></span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Freezing threshold not &lt; 2^64&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_CONTRACT_VIOLATION"><span class="hs-identifier hs-var">EC_CANISTER_CONTRACT_VIOLATION</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396575"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;controllers&quot; a =&gt; a
</span><span class="">#controllers</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679396567"><span class="annot"><span class="annottext">Vector Principal
</span><a href="#local-6989586621679396567"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; CallId
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Principal
</span><a href="#local-6989586621679396567"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Controllers cannot be &gt; 10&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_CONTRACT_VIOLATION"><span class="hs-identifier hs-var">EC_CANISTER_CONTRACT_VIOLATION</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621679399027"><span class="annot"><a href="IC.Ref.Management.html#applySettings"><span class="hs-identifier hs-type">applySettings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#Settings"><span class="hs-identifier hs-type">Settings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-172"></span><span id="applySettings"><span class="annot"><span class="annottext">applySettings :: forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#applySettings"><span class="hs-identifier hs-var hs-var">applySettings</span></a></span></span><span> </span><span id="local-6989586621679396522"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396522"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679396521"><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396521"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396521"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;controllers&quot; a =&gt; a
</span><span class="">#controllers</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Set EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#setControllers"><span class="hs-identifier hs-var">setControllers</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396522"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Vector a -&gt; [a]
</span><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#toList"><span class="hs-identifier hs-var">Vec.toList</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396521"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;compute_allocation&quot; a =&gt; a
</span><span class="">#compute_allocation</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setComputeAllocation"><span class="hs-identifier hs-var">setComputeAllocation</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396522"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396521"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;memory_allocation&quot; a =&gt; a
</span><span class="">#memory_allocation</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setMemoryAllocation"><span class="hs-identifier hs-var">setMemoryAllocation</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396522"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679396521"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;freezing_threshold&quot; a =&gt; a
</span><span class="">#freezing_threshold</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setFreezingThreshold"><span class="hs-identifier hs-var">setFreezingThreshold</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396522"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span id="local-6989586621679399112"><span id="local-6989586621679399113"><span id="local-6989586621679399114"><span class="annot"><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-type">onlyControllerOrSelf</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399114"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399114"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399113"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;canister_id&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-type">Principal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">R.Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399113"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399114"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399112"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">R.Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399113"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399114"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399112"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-181"></span><span id="onlyControllerOrSelf"><span class="annot"><span class="annottext">onlyControllerOrSelf :: forall (m :: * -&gt; *) (r :: Row (*)) a.
(ICM m, CanReject m, (r .! &quot;canister_id&quot;) ~ Principal) =&gt;
MethodName -&gt; Bool -&gt; EntityId -&gt; (Rec r -&gt; m a) -&gt; Rec r -&gt; m a
</span><a href="IC.Ref.Management.html#onlyControllerOrSelf"><span class="hs-identifier hs-var hs-var">onlyControllerOrSelf</span></a></span></span><span> </span><span id="local-6989586621679396480"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396480"><span class="hs-identifier hs-var">method_name</span></a></span></span><span> </span><span id="local-6989586621679396479"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679396479"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679396478"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396478"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679396477"><span class="annot"><span class="annottext">Rec r -&gt; m a
</span><a href="#local-6989586621679396477"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679396476"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396476"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396475"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679396475"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396476"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-var">canisterMustExist</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396475"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679396473"><span class="annot"><span class="annottext">Set EntityId
</span><a href="#local-6989586621679396473"><span class="hs-identifier hs-var">controllers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m (Set EntityId)
</span><a href="IC.Ref.Types.html#getControllers"><span class="hs-identifier hs-var">getControllers</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396475"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396472"><span class="annot"><span class="annottext">allowed :: Set EntityId
</span><a href="#local-6989586621679396472"><span class="hs-identifier hs-var hs-var">allowed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679396479"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396475"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Set EntityId
</span><a href="#local-6989586621679396473"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set EntityId
</span><a href="#local-6989586621679396473"><span class="hs-identifier hs-var">controllers</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396478"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`S.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set EntityId
</span><a href="#local-6989586621679396472"><span class="hs-identifier hs-var">allowed</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Rec r -&gt; m a
</span><a href="#local-6989586621679396477"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396476"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">EntityId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396478"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot; is not authorized to call &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396480"><span class="hs-identifier hs-var">method_name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot; on canister &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">EntityId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396475"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;, Allowed principals are: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.OldList.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set EntityId
</span><a href="#local-6989586621679396472"><span class="hs-identifier hs-var">allowed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_NOT_AUTHORIZED"><span class="hs-identifier hs-var">EC_NOT_AUTHORIZED</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679399091"><span class="annot"><a href="IC.Ref.Management.html#fetchCanisterIdfromMaybe"><span class="hs-identifier hs-type">fetchCanisterIdfromMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399091"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;canister_id&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-type">Principal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">R.Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399091"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span></span><span>
</span><span id="line-196"></span><span id="fetchCanisterIdfromMaybe"><span class="annot"><span class="annottext">fetchCanisterIdfromMaybe :: forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Maybe Principal) =&gt;
EntityId -&gt; Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterIdfromMaybe"><span class="hs-identifier hs-var hs-var">fetchCanisterIdfromMaybe</span></a></span></span><span> </span><span id="local-6989586621679396461"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396461"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679396460"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396460"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396460"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Principal
r .! &quot;canister_id&quot;
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396461"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-198"></span><span>                            </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679396459"><span class="annot"><span class="annottext">Principal
</span><a href="#local-6989586621679396459"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="annot"><span class="annottext">Principal
</span><a href="#local-6989586621679396459"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679399108"><span class="annot"><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-type">fetchCanisterId</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399108"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;canister_id&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-type">Principal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">R.Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399108"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span></span><span>
</span><span id="line-203"></span><span id="fetchCanisterId"><span class="annot"><span class="annottext">fetchCanisterId :: forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Principal) =&gt;
Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterId"><span class="hs-identifier hs-var hs-var">fetchCanisterId</span></a></span></span><span> </span><span id="local-6989586621679396453"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396453"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679396453"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621679399109"><span id="local-6989586621679399110"><span id="local-6989586621679399111"><span class="annot"><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-type">checkSubnet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399111"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399111"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399110"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399110"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399111"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399109"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399110"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399111"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399109"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-208"></span><span id="checkSubnet"><span class="annot"><span class="annottext">checkSubnet :: forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
(r -&gt; EntityId) -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var hs-var">checkSubnet</span></a></span></span><span> </span><span class="annot"><span class="annottext">r -&gt; EntityId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span id="local-6989586621679396429"><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396429"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679396428"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396428"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396429"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396428"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-209"></span><span class="annot"><a href="IC.Ref.Management.html#checkSubnet"><span class="hs-identifier hs-var">checkSubnet</span></a></span><span> </span><span id="local-6989586621679396427"><span class="annot"><span class="annottext">r -&gt; EntityId
</span><a href="#local-6989586621679396427"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679396426"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396426"><span class="hs-identifier hs-var">subnet_id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679396425"><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396425"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679396424"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396424"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396423"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679396423"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; EntityId
</span><a href="#local-6989586621679396427"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396424"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-var">canisterMustExist</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396423"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679396422"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396422"><span class="hs-identifier hs-var">subnet_id'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m Subnet
</span><a href="IC.Ref.Types.html#getSubnetFromCanisterId"><span class="hs-identifier hs-var">getSubnetFromCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396423"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396426"><span class="hs-identifier hs-var">subnet_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396422"><span class="hs-identifier hs-var">subnet_id'</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396425"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396424"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_DESTINATION_INVALID"><span class="hs-identifier hs-var">RC_DESTINATION_INVALID</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">EntityId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396423"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot; does not belong to subnet &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">EntityId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396426"><span class="hs-identifier hs-var">subnet_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_ARGUMENT"><span class="hs-identifier hs-var">EC_INVALID_ARGUMENT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679399116"><span id="local-6989586621679399117"><span id="local-6989586621679399118"><span class="annot"><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-type">noSubnet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399118"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399118"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399117"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399117"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-223"></span><span id="noSubnet"><span class="annot"><span class="annottext">noSubnet :: forall (m :: * -&gt; *) r a.
(ICM m, CanReject m) =&gt;
EntityId -&gt; Maybe Subnet -&gt; (r -&gt; m a) -&gt; r -&gt; m a
</span><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-var hs-var">noSubnet</span></a></span></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span id="local-6989586621679396401"><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396401"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679396400"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396400"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396401"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396400"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-224"></span><span class="annot"><a href="IC.Ref.Management.html#noSubnet"><span class="hs-identifier hs-var">noSubnet</span></a></span><span> </span><span id="local-6989586621679396399"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396399"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679396398"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396398"><span class="hs-identifier hs-var">subnet_id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679396397"><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396397"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679396396"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396396"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679396395"><span class="annot"><span class="annottext">Maybe EntityId
</span><a href="#local-6989586621679396395"><span class="hs-identifier hs-var">root_subnet_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; Maybe EntityId
</span><a href="IC.Ref.Types.html#rootSubnet"><span class="hs-identifier hs-var">rootSubnet</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679396393"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396393"><span class="hs-identifier hs-var">caller_subnet_id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m Subnet
</span><a href="IC.Ref.Types.html#getSubnetFromCanisterId"><span class="hs-identifier hs-var">getSubnetFromCanisterId</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396399"><span class="hs-identifier hs-var">caller</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe EntityId
</span><a href="#local-6989586621679396395"><span class="hs-identifier hs-var">root_subnet_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396393"><span class="hs-identifier hs-var">caller_subnet_id</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396398"><span class="hs-identifier hs-var">subnet_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396393"><span class="hs-identifier hs-var">caller_subnet_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">r -&gt; m a
</span><a href="#local-6989586621679396397"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679396396"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;the caller must be on the root subnet or belong to the target subnet&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_ARGUMENT"><span class="hs-identifier hs-var">EC_INVALID_ARGUMENT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621679399107"><span class="annot"><a href="IC.Ref.Management.html#icInstallCode"><span class="hs-identifier hs-type">icInstallCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399107"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399107"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399107"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;install_code&quot;</span></span></span><span>
</span><span id="line-233"></span><span id="icInstallCode"><span class="annot"><span class="annottext">icInstallCode :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId -&gt; CallId -&gt; ICManagement m .! &quot;install_code&quot;
</span><a href="IC.Ref.Management.html#icInstallCode"><span class="hs-identifier hs-var hs-var">icInstallCode</span></a></span></span><span> </span><span id="local-6989586621679396079"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396079"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679396078"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396078"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679396077"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396076"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396075"><span class="annot"><span class="annottext">arg :: 'R
  '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
     &quot;mode&quot;
     ':-&gt; Var
            ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
     &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
     &quot;wasm_module&quot; ':-&gt; ByteString]
.! &quot;arg&quot;
</span><a href="#local-6989586621679396075"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;arg&quot; a =&gt; a
</span><span class="">#arg</span></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679396074"><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396074"><span class="hs-identifier hs-var">new_can_mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either MethodName CanisterModule
</span><a href="IC.Canister.html#parseCanister"><span class="hs-identifier hs-var">parseCanister</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;wasm_module&quot; a =&gt; a
</span><span class="">#wasm_module</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
m (Either a b) -&gt; (a -&gt; m b) -&gt; m b
</span><a href="IC.Ref.Types.html#onErr"><span class="hs-operator hs-var">`onErr`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396071"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396071"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Parsing failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396071"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_MODULE"><span class="hs-identifier hs-var">EC_INVALID_MODULE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679396069"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679396069"><span class="hs-identifier hs-var">was_empty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m Bool
</span><a href="IC.Ref.Types.html#isCanisterEmpty"><span class="hs-identifier hs-var">isCanisterEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396067"><span class="annot"><span class="annottext">mode :: CanisterInstallMode
</span><a href="#local-6989586621679396067"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (v :: Row (*)) (r :: Row (*)) x.
BiForall r v (AppliesTo x) =&gt;
Var v -&gt; Rec r -&gt; x
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Switch.html#switch"><span class="hs-identifier hs-var">R.switch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;mode&quot; a =&gt; a
</span><span class="">#mode</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-240"></span><span>              </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;install&quot; a =&gt; a
</span><span class="">#install</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterInstallMode
</span><a href="IC.Types.html#Install"><span class="hs-identifier hs-var">Install</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>              </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;reinstall&quot; a =&gt; a
</span><span class="">#reinstall</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterInstallMode
</span><a href="IC.Types.html#Reinstall"><span class="hs-identifier hs-var">Reinstall</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>              </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;upgrade&quot; a =&gt; a
</span><span class="">#upgrade</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterInstallMode
</span><a href="IC.Types.html#Upgrade"><span class="hs-identifier hs-var">Upgrade</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-245"></span><span>      </span><span id="local-6989586621679396061"><span class="annot"><span class="annottext">reinstall :: m ()
</span><a href="#local-6989586621679396061"><span class="hs-identifier hs-var hs-var">reinstall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621679396060"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396060"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m Env
</span><a href="IC.Ref.Types.html#canisterEnv"><span class="hs-identifier hs-var">canisterEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396058"><span class="annot"><span class="annottext">env1 :: Env
</span><a href="#local-6989586621679396058"><span class="hs-identifier hs-var hs-var">env1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396060"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">env_canister_version :: Natural
</span><a href="IC.Types.html#env_canister_version"><span class="hs-identifier hs-var">env_canister_version</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Natural
</span><a href="IC.Types.html#env_canister_version"><span class="hs-identifier hs-var">env_canister_version</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396060"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env_global_timer :: Natural
</span><a href="IC.Types.html#env_global_timer"><span class="hs-identifier hs-var">env_global_timer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-248"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679396054"><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679396054"><span class="hs-identifier hs-var">wasm_state</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679396053"><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396053"><span class="hs-identifier hs-var">ca</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterModule -&gt; InitFunc
</span><a href="IC.Canister.html#init_method"><span class="hs-identifier hs-var">init_method</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396074"><span class="hs-identifier hs-var">new_can_mod</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396079"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396058"><span class="hs-identifier hs-var">env1</span></a></span><span> </span><span class="annot"><span class="annottext">'R
  '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
     &quot;mode&quot;
     ':-&gt; Var
            ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
     &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
     &quot;wasm_module&quot; ':-&gt; ByteString]
.! &quot;arg&quot;
</span><a href="#local-6989586621679396075"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
m (TrapOr a) -&gt; (MethodName -&gt; m a) -&gt; m a
</span><a href="IC.Ref.Types.html#onTrap"><span class="hs-operator hs-var">`onTrap`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396050"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396050"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Initialization trapped: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396050"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_TRAPPED"><span class="hs-identifier hs-var">EC_CANISTER_TRAPPED</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; CanisterContent -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterContent"><span class="hs-identifier hs-var">setCanisterContent</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-type">CanisterContent</span></a></span><span>
</span><span id="line-251"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">can_mod :: CanisterModule
</span><a href="IC.Ref.Types.html#can_mod"><span class="hs-identifier hs-var">can_mod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396074"><span class="hs-identifier hs-var">new_can_mod</span></a></span><span>
</span><span id="line-252"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wasm_state :: WasmState
</span><a href="IC.Ref.Types.html#wasm_state"><span class="hs-identifier hs-var">wasm_state</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679396054"><span class="hs-identifier hs-var">wasm_state</span></a></span><span>
</span><span id="line-253"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; CanisterActions -&gt; m ()
</span><a href="IC.Ref.Types.html#performCanisterActions"><span class="hs-identifier hs-var">performCanisterActions</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396053"><span class="hs-identifier hs-var">ca</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#bumpCanisterVersion"><span class="hs-identifier hs-var">bumpCanisterVersion</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679396042"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396042"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var">icAddCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396078"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;sender_canister_version&quot; a =&gt; a
</span><span class="">#sender_canister_version</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterInstallMode -&gt; ByteString -&gt; ChangeDetails
</span><a href="IC.Types.html#CodeDeployment"><span class="hs-identifier hs-var">CodeDeployment</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterInstallMode
</span><a href="#local-6989586621679396067"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe ByteString
</span><a href="IC.Ref.Types.html#module_hash"><span class="hs-identifier hs-var">module_hash</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396042"><span class="hs-identifier hs-var">can_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterActions -&gt; Maybe ByteString
</span><a href="IC.Types.html#set_certified_data"><span class="hs-identifier hs-var">set_certified_data</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396053"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; ByteString -&gt; m ()
</span><a href="IC.Ref.Types.html#setCertifiedData"><span class="hs-identifier hs-var">setCertifiedData</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterActions -&gt; Maybe Natural
</span><a href="IC.Types.html#set_global_timer"><span class="hs-identifier hs-var">set_global_timer</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396053"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterGlobalTimer"><span class="hs-identifier hs-var">setCanisterGlobalTimer</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>      </span><span id="local-6989586621679396034"><span class="annot"><span class="annottext">install :: m ()
</span><a href="#local-6989586621679396034"><span class="hs-identifier hs-var hs-var">install</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679396069"><span class="hs-identifier hs-var">was_empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-263"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister is not empty during installation&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_NOT_EMPTY"><span class="hs-identifier hs-var">EC_CANISTER_NOT_EMPTY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679396061"><span class="hs-identifier hs-var">reinstall</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679396032"><span class="annot"><span class="annottext">upgrade :: m ()
</span><a href="#local-6989586621679396032"><span class="hs-identifier hs-var hs-var">upgrade</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679396069"><span class="hs-identifier hs-var">was_empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister is empty during upgrade&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_EMPTY"><span class="hs-identifier hs-var">EC_CANISTER_EMPTY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>        </span><span id="local-6989586621679396030"><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679396030"><span class="hs-identifier hs-var">old_wasm_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m WasmState
</span><a href="IC.Ref.Types.html#getCanisterState"><span class="hs-identifier hs-var">getCanisterState</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679396028"><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396028"><span class="hs-identifier hs-var">old_can_mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanisterModule
</span><a href="IC.Ref.Types.html#getCanisterMod"><span class="hs-identifier hs-var">getCanisterMod</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span id="local-6989586621679396026"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396026"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m Env
</span><a href="IC.Ref.Types.html#canisterEnv"><span class="hs-identifier hs-var">canisterEnv</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396025"><span class="annot"><span class="annottext">env1 :: Env
</span><a href="#local-6989586621679396025"><span class="hs-identifier hs-var hs-var">env1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396026"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679396024"><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396024"><span class="hs-identifier hs-var">ca1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679396023"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396023"><span class="hs-identifier hs-var">mem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterModule
-&gt; WasmState
-&gt; EntityId
-&gt; Env
-&gt; TrapOr (CanisterActions, ByteString)
</span><a href="IC.Canister.html#pre_upgrade_method"><span class="hs-identifier hs-var">pre_upgrade_method</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396028"><span class="hs-identifier hs-var">old_can_mod</span></a></span><span> </span><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679396030"><span class="hs-identifier hs-var">old_wasm_state</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396079"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396025"><span class="hs-identifier hs-var">env1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
m (TrapOr a) -&gt; (MethodName -&gt; m a) -&gt; m a
</span><a href="IC.Ref.Types.html#onTrap"><span class="hs-operator hs-var">`onTrap`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396021"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396021"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Pre-upgrade trapped: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396021"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_TRAPPED"><span class="hs-identifier hs-var">EC_CANISTER_TRAPPED</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-comment">-- TODO: update balance in env based on ca1 here, once canister actions</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-comment">-- can change balances</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679396020"><span class="annot"><span class="annottext">env2 :: Env
</span><a href="#local-6989586621679396020"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396026"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">env_canister_version :: Natural
</span><a href="IC.Types.html#env_canister_version"><span class="hs-identifier hs-var">env_canister_version</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Natural
</span><a href="IC.Types.html#env_canister_version"><span class="hs-identifier hs-var">env_canister_version</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396026"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env_global_timer :: Natural
</span><a href="IC.Types.html#env_global_timer"><span class="hs-identifier hs-var">env_global_timer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679396019"><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679396019"><span class="hs-identifier hs-var">new_wasm_state</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679396018"><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396018"><span class="hs-identifier hs-var">ca2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterModule
-&gt; EntityId
-&gt; Env
-&gt; ByteString
-&gt; ByteString
-&gt; TrapOr (WasmState, CanisterActions)
</span><a href="IC.Canister.html#post_upgrade_method"><span class="hs-identifier hs-var">post_upgrade_method</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396074"><span class="hs-identifier hs-var">new_can_mod</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396079"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679396020"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679396023"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">'R
  '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
     &quot;mode&quot;
     ':-&gt; Var
            ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
     &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
     &quot;wasm_module&quot; ':-&gt; ByteString]
.! &quot;arg&quot;
</span><a href="#local-6989586621679396075"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
m (TrapOr a) -&gt; (MethodName -&gt; m a) -&gt; m a
</span><a href="IC.Ref.Types.html#onTrap"><span class="hs-operator hs-var">`onTrap`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679396016"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396016"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Post-upgrade trapped: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679396016"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_TRAPPED"><span class="hs-identifier hs-var">EC_CANISTER_TRAPPED</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; CanisterContent -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterContent"><span class="hs-identifier hs-var">setCanisterContent</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-type">CanisterContent</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">can_mod :: CanisterModule
</span><a href="IC.Ref.Types.html#can_mod"><span class="hs-identifier hs-var">can_mod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanisterModule
</span><a href="#local-6989586621679396074"><span class="hs-identifier hs-var">new_can_mod</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wasm_state :: WasmState
</span><a href="IC.Ref.Types.html#wasm_state"><span class="hs-identifier hs-var">wasm_state</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679396019"><span class="hs-identifier hs-var">new_wasm_state</span></a></span><span>
</span><span id="line-284"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; CanisterActions -&gt; m ()
</span><a href="IC.Ref.Types.html#performCanisterActions"><span class="hs-identifier hs-var">performCanisterActions</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396024"><span class="hs-identifier hs-var">ca1</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">set_global_timer :: Maybe Natural
</span><a href="IC.Types.html#set_global_timer"><span class="hs-identifier hs-var">set_global_timer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396018"><span class="hs-identifier hs-var">ca2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#bumpCanisterVersion"><span class="hs-identifier hs-var">bumpCanisterVersion</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span id="local-6989586621679396015"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396015"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var">icAddCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679396078"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;sender_canister_version&quot; a =&gt; a
</span><span class="">#sender_canister_version</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterInstallMode -&gt; ByteString -&gt; ChangeDetails
</span><a href="IC.Types.html#CodeDeployment"><span class="hs-identifier hs-var">CodeDeployment</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterInstallMode
</span><a href="#local-6989586621679396067"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe ByteString
</span><a href="IC.Ref.Types.html#module_hash"><span class="hs-identifier hs-var">module_hash</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679396015"><span class="hs-identifier hs-var">can_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterActions -&gt; Maybe Natural
</span><a href="IC.Types.html#set_global_timer"><span class="hs-identifier hs-var">set_global_timer</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679396018"><span class="hs-identifier hs-var">ca2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterGlobalTimer"><span class="hs-identifier hs-var">setCanisterGlobalTimer</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679396076"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="annottext">forall (v :: Row (*)) (r :: Row (*)) x.
BiForall r v (AppliesTo x) =&gt;
Var v -&gt; Rec r -&gt; x
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Switch.html#switch"><span class="hs-identifier hs-var">R.switch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;arg&quot; ':-&gt; ByteString, &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;wasm_module&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679396077"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;mode&quot; a =&gt; a
</span><span class="">#mode</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;install&quot; a =&gt; a
</span><span class="">#install</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679396034"><span class="hs-identifier hs-var">install</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;reinstall&quot; a =&gt; a
</span><span class="">#reinstall</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679396061"><span class="hs-identifier hs-var">reinstall</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;upgrade&quot; a =&gt; a
</span><span class="">#upgrade</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679396032"><span class="hs-identifier hs-var">upgrade</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span id="local-6989586621679399106"><span class="annot"><a href="IC.Ref.Management.html#icUninstallCode"><span class="hs-identifier hs-type">icUninstallCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399106"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;uninstall_code&quot;</span></span></span><span>
</span><span id="line-297"></span><span id="icUninstallCode"><span class="annot"><span class="annottext">icUninstallCode :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
CallId -&gt; ICManagement m .! &quot;uninstall_code&quot;
</span><a href="IC.Ref.Management.html#icUninstallCode"><span class="hs-identifier hs-var hs-var">icUninstallCode</span></a></span></span><span> </span><span id="local-6989586621679395973"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395973"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679395972"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64])
</span><a href="#local-6989586621679395972"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395971"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395971"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64])
</span><a href="#local-6989586621679395972"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-comment">-- empty canister, resetting selected state</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395971"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679395969"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395969"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395969"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">content :: Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">certified_data :: ByteString
</span><a href="IC.Ref.Types.html#certified_data"><span class="hs-identifier hs-var">certified_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">canister_version :: Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395969"><span class="hs-identifier hs-var">can_state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">global_timer :: Natural
</span><a href="IC.Ref.Types.html#global_timer"><span class="hs-identifier hs-var">global_timer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var">icAddCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395971"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395973"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64])
</span><a href="#local-6989586621679395972"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;sender_canister_version&quot; a =&gt; a
</span><span class="">#sender_canister_version</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChangeDetails
</span><a href="IC.Types.html#CodeUninstall"><span class="hs-identifier hs-var">CodeUninstall</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- reject all call open contexts of this canister</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; CallId &#8614; CallContext
</span><a href="IC.Ref.Types.html#call_contexts"><span class="hs-identifier hs-var">call_contexts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679395961"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395961"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679395960"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679395960"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallContext -&gt; EntityId
</span><a href="IC.Ref.Types.html#canister"><span class="hs-identifier hs-var">canister</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679395960"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395971"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; NeedsToRespond
</span><a href="IC.Ref.Types.html#needs_to_respond"><span class="hs-identifier hs-var">needs_to_respond</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679395960"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; NeedsToRespond
</span><a href="IC.Types.html#NeedsToRespond"><span class="hs-identifier hs-var">NeedsToRespond</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (RejectCode, MethodName, Maybe ErrorCode) -&gt; m ()
</span><a href="IC.Ref.Types.html#rejectCallContext"><span class="hs-identifier hs-var">rejectCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395961"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_REJECT"><span class="hs-identifier hs-var">RC_CANISTER_REJECT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Canister has been uninstalled&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_EMPTY"><span class="hs-identifier hs-var">EC_CANISTER_EMPTY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m ()
</span><a href="IC.Ref.Types.html#deleteCallContext"><span class="hs-identifier hs-var">deleteCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395961"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span id="local-6989586621679399105"><span class="annot"><a href="IC.Ref.Management.html#icUpdateCanisterSettings"><span class="hs-identifier hs-type">icUpdateCanisterSettings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399105"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399105"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;update_settings&quot;</span></span></span><span>
</span><span id="line-315"></span><span id="icUpdateCanisterSettings"><span class="annot"><span class="annottext">icUpdateCanisterSettings :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
CallId -&gt; ICManagement m .! &quot;update_settings&quot;
</span><a href="IC.Ref.Management.html#icUpdateCanisterSettings"><span class="hs-identifier hs-var hs-var">icUpdateCanisterSettings</span></a></span></span><span> </span><span id="local-6989586621679395904"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395904"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679395903"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                     &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                     &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                     &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
</span><a href="#local-6989586621679395903"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395902"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395902"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                     &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                     &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                     &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
</span><a href="#local-6989586621679395903"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). CanReject m =&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#validateSettings"><span class="hs-identifier hs-var">validateSettings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                     &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                     &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                     &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
</span><a href="#local-6989586621679395903"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Settings -&gt; m ()
</span><a href="IC.Ref.Management.html#applySettings"><span class="hs-identifier hs-var">applySettings</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395902"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                     &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                     &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                     &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
</span><a href="#local-6989586621679395903"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#bumpCanisterVersion"><span class="hs-identifier hs-var">bumpCanisterVersion</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395902"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                     &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                     &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                     &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
</span><a href="#local-6989586621679395903"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;controllers&quot; a =&gt; a
</span><span class="">#controllers</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Vector Principal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621679395899"><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679395899"><span class="hs-identifier hs-var">new_controllers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m (Set EntityId)
</span><a href="IC.Ref.Types.html#getControllers"><span class="hs-identifier hs-var">getControllers</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395902"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
EntityId -&gt; CallId -&gt; Maybe Word64 -&gt; ChangeDetails -&gt; m ()
</span><a href="IC.Ref.Management.html#icAddCanisterHistory"><span class="hs-identifier hs-var">icAddCanisterHistory</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395902"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395904"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;sender_canister_version&quot; ':-&gt; Maybe Word64,
        &quot;settings&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                     &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                     &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                     &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
</span><a href="#local-6989586621679395903"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;sender_canister_version&quot; a =&gt; a
</span><span class="">#sender_canister_version</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[EntityId] -&gt; ChangeDetails
</span><a href="IC.Types.html#ControllersChange"><span class="hs-identifier hs-var">ControllersChange</span></a></span><span> </span><span class="annot"><span class="annottext">[EntityId]
</span><a href="#local-6989586621679395899"><span class="hs-identifier hs-var">new_controllers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span id="local-6989586621679399104"><span class="annot"><a href="IC.Ref.Management.html#icStartCanister"><span class="hs-identifier hs-type">icStartCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399104"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399104"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399104"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;start_canister&quot;</span></span></span><span>
</span><span id="line-325"></span><span id="icStartCanister"><span class="annot"><span class="annottext">icStartCanister :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;start_canister&quot;
</span><a href="IC.Ref.Management.html#icStartCanister"><span class="hs-identifier hs-var hs-var">icStartCanister</span></a></span></span><span> </span><span id="local-6989586621679395868"><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395868"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395867"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395867"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395868"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m RunStatus
</span><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-var">getRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395867"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-type">IsStopping</span></a></span><span> </span><span id="local-6989586621679395863"><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679395863"><span class="hs-identifier hs-var">pending</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679395863"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679395862"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395862"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-331"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (RejectCode, MethodName, Maybe ErrorCode) -&gt; m ()
</span><a href="IC.Ref.Types.html#rejectCallContext"><span class="hs-identifier hs-var">rejectCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395862"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Canister has been restarted&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_RESTARTED"><span class="hs-identifier hs-var">EC_CANISTER_RESTARTED</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; RunStatus -&gt; m ()
</span><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-var">setRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395867"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsStopped"><span class="hs-identifier hs-var">IsStopped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; RunStatus -&gt; m ()
</span><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-var">setRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395867"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;deleted canister encountered&quot;</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621679399100"><span id="local-6989586621679399101"><span id="local-6989586621679399102"><span class="annot"><a href="IC.Ref.Management.html#icStopCanister"><span class="hs-identifier hs-type">icStopCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399102"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399102"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679399101"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;stop_canister&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399101"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679399102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-340"></span><span id="icStopCanister"><span class="annot"><span class="annottext">icStopCanister :: forall (m :: * -&gt; *) a b.
(ICM m, CanReject m,
 (a -&gt; m b) ~ (ICManagement m .! &quot;stop_canister&quot;)) =&gt;
CallId -&gt; a -&gt; m ()
</span><a href="IC.Ref.Management.html#icStopCanister"><span class="hs-identifier hs-var hs-var">icStopCanister</span></a></span></span><span> </span><span id="local-6989586621679395821"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395821"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679395820"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679395820"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395819"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395819"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679395820"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m RunStatus
</span><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-var">getRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395819"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; RunStatus -&gt; m ()
</span><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-var">setRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395819"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CallId] -&gt; RunStatus
</span><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-var">IsStopping</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395821"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-type">IsStopping</span></a></span><span> </span><span id="local-6989586621679395818"><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679395818"><span class="hs-identifier hs-var">pending</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; RunStatus -&gt; m ()
</span><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-var">setRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395819"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CallId] -&gt; RunStatus
</span><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-var">IsStopping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679395818"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395821"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsStopped"><span class="hs-identifier hs-var">IsStopped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; ByteString -&gt; m ()
</span><a href="IC.Ref.Types.html#replyCallContext"><span class="hs-identifier hs-var">replyCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395821"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;deleted canister encountered&quot;</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span id="local-6989586621679399099"><span class="annot"><a href="IC.Ref.Management.html#icCanisterStatus"><span class="hs-identifier hs-type">icCanisterStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399099"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399099"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;canister_status&quot;</span></span></span><span>
</span><span id="line-349"></span><span id="icCanisterStatus"><span class="annot"><span class="annottext">icCanisterStatus :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;canister_status&quot;
</span><a href="IC.Ref.Management.html#icCanisterStatus"><span class="hs-identifier hs-var hs-var">icCanisterStatus</span></a></span></span><span> </span><span id="local-6989586621679395602"><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395602"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395601"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395601"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395602"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679395600"><span class="annot"><span class="annottext">Var
  ('R '[ &quot;running&quot; ':-&gt; (), &quot;stopped&quot; ':-&gt; (), &quot;stopping&quot; ':-&gt; ()])
</span><a href="#local-6989586621679395600"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m RunStatus
</span><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-var">getRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395601"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
(AllUniqueLabels r, KnownSymbol l) =&gt;
Label l -&gt; (r .! l) -&gt; Var r
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Variants.html#IsJust"><span class="hs-identifier hs-var">V.IsJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;running&quot; a =&gt; a
</span><span class="">#running</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-type">IsStopping</span></a></span><span> </span><span id="local-6989586621679395598"><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679395598"><span class="hs-identifier hs-var">_pending</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
(AllUniqueLabels r, KnownSymbol l) =&gt;
Label l -&gt; (r .! l) -&gt; Var r
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Variants.html#IsJust"><span class="hs-identifier hs-var">V.IsJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;stopping&quot; a =&gt; a
</span><span class="">#stopping</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsStopped"><span class="hs-identifier hs-var">IsStopped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
(AllUniqueLabels r, KnownSymbol l) =&gt;
Label l -&gt; (r .! l) -&gt; Var r
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Variants.html#IsJust"><span class="hs-identifier hs-var">V.IsJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;stopped&quot; a =&gt; a
</span><span class="">#stopped</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;deleted canister encountered&quot;</span></span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679395597"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395597"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395601"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679395596"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679395596"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe ByteString
</span><a href="IC.Ref.Types.html#module_hash"><span class="hs-identifier hs-var">module_hash</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395601"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679395595"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395595"><span class="hs-identifier hs-var">cycles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getBalance"><span class="hs-identifier hs-var">getBalance</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395601"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679395593"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395593"><span class="hs-identifier hs-var">idle_cycles_burned_per_day</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#idle_cycles_burned_per_day"><span class="hs-identifier hs-var">idle_cycles_burned_per_day</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395601"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
  ('R '[ &quot;running&quot; ':-&gt; (), &quot;stopped&quot; ':-&gt; (), &quot;stopping&quot; ':-&gt; ()])
</span><a href="#local-6989586621679395600"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;settings&quot; a =&gt; a
</span><span class="">#settings</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;controllers&quot; a =&gt; a
</span><span class="">#controllers</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#fromList"><span class="hs-identifier hs-var">Vec.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; Principal
</span><a href="IC.Management.html#entityIdToPrincipal"><span class="hs-identifier hs-var">entityIdToPrincipal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanState -&gt; Set EntityId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395597"><span class="hs-identifier hs-var">can_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;memory_allocation&quot; a =&gt; a
</span><span class="">#memory_allocation</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#memory_allocation"><span class="hs-identifier hs-var">memory_allocation</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395597"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;compute_allocation&quot; a =&gt; a
</span><span class="">#compute_allocation</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#compute_allocation"><span class="hs-identifier hs-var">compute_allocation</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395597"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;freezing_threshold&quot; a =&gt; a
</span><span class="">#freezing_threshold</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#freezing_threshold"><span class="hs-identifier hs-var">freezing_threshold</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395597"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;memory_size&quot; a =&gt; a
</span><span class="">#memory_size</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- not implemented here</span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;module_hash&quot; a =&gt; a
</span><span class="">#module_hash</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679395596"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;cycles&quot; a =&gt; a
</span><span class="">#cycles</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395595"><span class="hs-identifier hs-var">cycles</span></a></span><span>
</span><span id="line-371"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;idle_cycles_burned_per_day&quot; a =&gt; a
</span><span class="">#idle_cycles_burned_per_day</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395593"><span class="hs-identifier hs-var">idle_cycles_burned_per_day</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621679399098"><span class="annot"><a href="IC.Ref.Management.html#icCanisterInfo"><span class="hs-identifier hs-type">icCanisterInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399098"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399098"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399098"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;canister_info&quot;</span></span></span><span>
</span><span id="line-374"></span><span id="icCanisterInfo"><span class="annot"><span class="annottext">icCanisterInfo :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;canister_info&quot;
</span><a href="IC.Ref.Management.html#icCanisterInfo"><span class="hs-identifier hs-var hs-var">icCanisterInfo</span></a></span></span><span> </span><span id="local-6989586621679395510"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;num_requested_changes&quot; ':-&gt; Maybe Word64])
</span><a href="#local-6989586621679395510"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395509"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395509"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;num_requested_changes&quot; ':-&gt; Maybe Word64])
</span><a href="#local-6989586621679395510"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395508"><span class="annot"><span class="annottext">num_requested_changes :: CallId
</span><a href="#local-6989586621679395508"><span class="hs-identifier hs-var hs-var">num_requested_changes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;num_requested_changes&quot; ':-&gt; Maybe Word64])
</span><a href="#local-6989586621679395510"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;num_requested_changes&quot; a =&gt; a
</span><span class="">#num_requested_changes</span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621679395507"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395507"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395509"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395506"><span class="annot"><span class="annottext">history :: CanisterHistory
</span><a href="#local-6989586621679395506"><span class="hs-identifier hs-var hs-var">history</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var">canister_history</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395507"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395504"><span class="annot"><span class="annottext">recent_changes :: [Change]
</span><a href="#local-6989586621679395504"><span class="hs-identifier hs-var hs-var">recent_changes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. CallId -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395508"><span class="hs-identifier hs-var">num_requested_changes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterHistory -&gt; [Change]
</span><a href="IC.Ref.Types.html#changes"><span class="hs-identifier hs-var">changes</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterHistory
</span><a href="#local-6989586621679395506"><span class="hs-identifier hs-var">history</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;total_num_changes&quot; a =&gt; a
</span><span class="">#total_num_changes</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterHistory -&gt; Word64
</span><a href="IC.Ref.Types.html#total_num_changes"><span class="hs-identifier hs-var">total_num_changes</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterHistory
</span><a href="#local-6989586621679395506"><span class="hs-identifier hs-var">history</span></a></span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;recent_changes&quot; a =&gt; a
</span><span class="">#recent_changes</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#fromList"><span class="hs-identifier hs-var">Vec.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Change
-&gt; Rec
     ('R
        '[ &quot;canister_version&quot; ':-&gt; Word64,
           &quot;details&quot;
           ':-&gt; Var
                  ('R
                     '[ &quot;code_deployment&quot;
                        ':-&gt; Rec
                               ('R
                                  '[ &quot;mode&quot;
                                     ':-&gt; Var
                                            ('R
                                               '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (),
                                                  &quot;upgrade&quot; ':-&gt; ()]),
                                     &quot;module_hash&quot; ':-&gt; ByteString]),
                        &quot;code_uninstall&quot; ':-&gt; (),
                        &quot;controllers_change&quot;
                        ':-&gt; Rec ('R '[ &quot;controllers&quot; ':-&gt; Vector Principal]),
                        &quot;creation&quot; ':-&gt; Rec ('R '[ &quot;controllers&quot; ':-&gt; Vector Principal])]),
           &quot;origin&quot;
           ':-&gt; Var
                  ('R
                     '[ &quot;from_canister&quot;
                        ':-&gt; Rec
                               ('R
                                  '[ &quot;canister_id&quot; ':-&gt; Principal,
                                     &quot;canister_version&quot; ':-&gt; Maybe Word64]),
                        &quot;from_user&quot; ':-&gt; Rec ('R '[ &quot;user_id&quot; ':-&gt; Principal])]),
           &quot;timestamp_nanos&quot; ':-&gt; Word64])
</span><a href="#local-6989586621679395499"><span class="hs-identifier hs-var">mapChange</span></a></span><span> </span><span class="annot"><span class="annottext">[Change]
</span><a href="#local-6989586621679395504"><span class="hs-identifier hs-var">recent_changes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;module_hash&quot; a =&gt; a
</span><span class="">#module_hash</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe ByteString
</span><a href="IC.Ref.Types.html#module_hash"><span class="hs-identifier hs-var">module_hash</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395507"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;controllers&quot; a =&gt; a
</span><span class="">#controllers</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#fromList"><span class="hs-identifier hs-var">Vec.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; Principal
</span><a href="IC.Management.html#entityIdToPrincipal"><span class="hs-identifier hs-var">entityIdToPrincipal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanState -&gt; Set EntityId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679395507"><span class="hs-identifier hs-var">can_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>      </span><span id="local-6989586621679395499"><span class="annot"><span class="annottext">mapChange :: Change
-&gt; Rec
     ((('R '[ &quot;timestamp_nanos&quot; ':-&gt; Word64]
        .+ 'R '[ &quot;canister_version&quot; ':-&gt; Word64])
       .+ 'R
            '[ &quot;origin&quot;
               ':-&gt; Var
                      ('R
                         '[ &quot;from_canister&quot;
                            ':-&gt; Rec
                                   ('R
                                      '[ &quot;canister_id&quot; ':-&gt; Principal,
                                         &quot;canister_version&quot; ':-&gt; Maybe Word64]),
                            &quot;from_user&quot; ':-&gt; Rec ('R '[ &quot;user_id&quot; ':-&gt; Principal])])])
      .+ 'R
           '[ &quot;details&quot;
              ':-&gt; Var
                     ('R
                        '[ &quot;code_deployment&quot;
                           ':-&gt; Rec
                                  ('R
                                     '[ &quot;mode&quot;
                                        ':-&gt; Var
                                               ('R
                                                  '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (),
                                                     &quot;upgrade&quot; ':-&gt; ()]),
                                        &quot;module_hash&quot; ':-&gt; ByteString]),
                           &quot;code_uninstall&quot; ':-&gt; (),
                           &quot;controllers_change&quot;
                           ':-&gt; Rec ('R '[ &quot;controllers&quot; ':-&gt; Vector Principal]),
                           &quot;creation&quot;
                           ':-&gt; Rec ('R '[ &quot;controllers&quot; ':-&gt; Vector Principal])])])
</span><a href="#local-6989586621679395499"><span class="hs-identifier hs-var hs-var">mapChange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#Change"><span class="hs-identifier hs-type">Change</span></a></span><span> </span><span id="local-6989586621679395438"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679395438"><span class="hs-identifier hs-var">timestamp_nanos</span></a></span></span><span> </span><span id="local-6989586621679395437"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679395437"><span class="hs-identifier hs-var">canister_version</span></a></span></span><span> </span><span id="local-6989586621679395436"><span class="annot"><span class="annottext">ChangeOrigin
</span><a href="#local-6989586621679395436"><span class="hs-identifier hs-var">change_origin</span></a></span></span><span> </span><span id="local-6989586621679395435"><span class="annot"><span class="annottext">ChangeDetails
</span><a href="#local-6989586621679395435"><span class="hs-identifier hs-var">change_details</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;timestamp_nanos&quot; a =&gt; a
</span><span class="">#timestamp_nanos</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679395438"><span class="hs-identifier hs-var">timestamp_nanos</span></a></span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_version&quot; a =&gt; a
</span><span class="">#canister_version</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679395437"><span class="hs-identifier hs-var">canister_version</span></a></span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;origin&quot; a =&gt; a
</span><span class="">#origin</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeOrigin -&gt; CandidChangeOrigin
</span><a href="IC.Management.html#mapChangeOrigin"><span class="hs-identifier hs-var">mapChangeOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeOrigin
</span><a href="#local-6989586621679395436"><span class="hs-identifier hs-var">change_origin</span></a></span><span>
</span><span id="line-390"></span><span>        </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;details&quot; a =&gt; a
</span><span class="">#details</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeDetails -&gt; CandidChangeDetails
</span><a href="IC.Management.html#mapChangeDetails"><span class="hs-identifier hs-var">mapChangeDetails</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeDetails
</span><a href="#local-6989586621679395435"><span class="hs-identifier hs-var">change_details</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span id="local-6989586621679399097"><span class="annot"><a href="IC.Ref.Management.html#icDeleteCanister"><span class="hs-identifier hs-type">icDeleteCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399097"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399097"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399097"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;delete_canister&quot;</span></span></span><span>
</span><span id="line-393"></span><span id="icDeleteCanister"><span class="annot"><span class="annottext">icDeleteCanister :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;delete_canister&quot;
</span><a href="IC.Ref.Management.html#icDeleteCanister"><span class="hs-identifier hs-var hs-var">icDeleteCanister</span></a></span></span><span> </span><span id="local-6989586621679395409"><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395409"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395408"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395408"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395409"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m RunStatus
</span><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-var">getRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395408"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Cannot delete running canister&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_NOT_STOPPED"><span class="hs-identifier hs-var">EC_CANISTER_NOT_STOPPED</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-type">IsStopping</span></a></span><span> </span><span id="local-6989586621679395406"><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679395406"><span class="hs-identifier hs-var">_pending</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Cannot delete stopping canister&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_NOT_STOPPED"><span class="hs-identifier hs-var">EC_CANISTER_NOT_STOPPED</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsStopped"><span class="hs-identifier hs-var">IsStopped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;deleted canister encountered&quot;</span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; RunStatus -&gt; m ()
</span><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-var">setRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395408"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span id="local-6989586621679399096"><span class="annot"><a href="IC.Ref.Management.html#icDepositCycles"><span class="hs-identifier hs-type">icDepositCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399096"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399096"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399096"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;deposit_cycles&quot;</span></span></span><span>
</span><span id="line-404"></span><span id="icDepositCycles"><span class="annot"><span class="annottext">icDepositCycles :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
CallId -&gt; ICManagement m .! &quot;deposit_cycles&quot;
</span><a href="IC.Ref.Management.html#icDepositCycles"><span class="hs-identifier hs-var hs-var">icDepositCycles</span></a></span></span><span> </span><span id="local-6989586621679395369"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395369"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679395368"><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395368"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395367"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395367"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395368"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-var">canisterMustExist</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395367"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679395366"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395366"><span class="hs-identifier hs-var">cycles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCallContextCycles"><span class="hs-identifier hs-var">getCallContextCycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395369"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679395365"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395365"><span class="hs-identifier hs-var">available</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCallContextCycles"><span class="hs-identifier hs-var">getCallContextCycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395369"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCallContextCycles"><span class="hs-identifier hs-var">setCallContextCycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679395369"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395365"><span class="hs-identifier hs-var">available</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395366"><span class="hs-identifier hs-var">cycles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679395364"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395364"><span class="hs-identifier hs-var">prev_balance</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getBalance"><span class="hs-identifier hs-var">getBalance</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395367"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setBalance"><span class="hs-identifier hs-var">setBalance</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395367"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395364"><span class="hs-identifier hs-var">prev_balance</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395366"><span class="hs-identifier hs-var">cycles</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span id="local-6989586621679399094"><span class="annot"><a href="IC.Ref.Management.html#icTopUpCanister"><span class="hs-identifier hs-type">icTopUpCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399094"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399094"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;provisional_top_up_canister&quot;</span></span></span><span>
</span><span id="line-415"></span><span id="icTopUpCanister"><span class="annot"><span class="annottext">icTopUpCanister :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
ICManagement m .! &quot;provisional_top_up_canister&quot;
</span><a href="IC.Ref.Management.html#icTopUpCanister"><span class="hs-identifier hs-var hs-var">icTopUpCanister</span></a></span></span><span> </span><span id="local-6989586621679395337"><span class="annot"><span class="annottext">Rec ('R '[ &quot;amount&quot; ':-&gt; Natural, &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395337"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395336"><span class="annot"><span class="annottext">canister_id :: EntityId
</span><a href="#local-6989586621679395336"><span class="hs-identifier hs-var hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Principal -&gt; EntityId
</span><a href="IC.Management.html#principalToEntityId"><span class="hs-identifier hs-var">principalToEntityId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;amount&quot; ':-&gt; Natural, &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395337"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;canister_id&quot; a =&gt; a
</span><span class="">#canister_id</span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-var">canisterMustExist</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395336"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621679395335"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395335"><span class="hs-identifier hs-var">prev_balance</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getBalance"><span class="hs-identifier hs-var">getBalance</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395336"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; EntityId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setBalance"><span class="hs-identifier hs-var">setBalance</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395336"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679395335"><span class="hs-identifier hs-var">prev_balance</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;amount&quot; ':-&gt; Natural, &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679395337"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;amount&quot; a =&gt; a
</span><span class="">#amount</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span id="local-6989586621679399093"><span class="annot"><a href="IC.Ref.Management.html#icRawRand"><span class="hs-identifier hs-type">icRawRand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;raw_rand&quot;</span></span></span><span>
</span><span id="line-423"></span><span id="icRawRand"><span class="annot"><span class="annottext">icRawRand :: forall (m :: * -&gt; *). ICM m =&gt; ICManagement m .! &quot;raw_rand&quot;
</span><a href="IC.Ref.Management.html#icRawRand"><span class="hs-identifier hs-var hs-var">icRawRand</span></a></span></span><span> </span><span id="local-6989586621679395312"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621679395312"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. ICM m =&gt; Rand StdGen a -&gt; m a
</span><a href="IC.Ref.Management.html#runRandIC"><span class="hs-identifier hs-var">runRandIC</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html#pack"><span class="hs-identifier hs-var">BS.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; CallId -&gt; m a -&gt; m [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.html#replicateM"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="file:///nix/store/z2nj2f44psha18adfp88w2mqhkhcb6zx-MonadRandom-0.5.3-doc/share/doc/MonadRandom-0.5.3/html/src/Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span id="local-6989586621679398868"><span id="local-6989586621679398869"><span class="annot"><a href="IC.Ref.Management.html#runRandIC"><span class="hs-identifier hs-type">runRandIC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398869"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/z2nj2f44psha18adfp88w2mqhkhcb6zx-MonadRandom-0.5.3-doc/share/doc/MonadRandom-0.5.3/html/src/Control.Monad.Trans.Random.Lazy.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kwjhvjzd9a4fh4sc1pajfx8br8bc58k5-random-1.2.1.1-doc/share/doc/random-1.2.1.1/html/src/System.Random.Internal.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398868"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679398869"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398868"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-426"></span><span id="runRandIC"><span class="annot"><span class="annottext">runRandIC :: forall (m :: * -&gt; *) a. ICM m =&gt; Rand StdGen a -&gt; m a
</span><a href="IC.Ref.Management.html#runRandIC"><span class="hs-identifier hs-var hs-var">runRandIC</span></a></span></span><span> </span><span id="local-6989586621679395304"><span class="annot"><span class="annottext">Rand StdGen a
</span><a href="#local-6989586621679395304"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679395302"><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679395302"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679395301"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679395301"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679395300"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679395300"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall g a. Rand g a -&gt; g -&gt; (a, g)
</span><a href="file:///nix/store/z2nj2f44psha18adfp88w2mqhkhcb6zx-MonadRandom-0.5.3-doc/share/doc/MonadRandom-0.5.3/html/src/Control.Monad.Trans.Random.Lazy.html#runRand"><span class="hs-identifier hs-var">runRand</span></a></span><span> </span><span class="annot"><span class="annottext">Rand StdGen a
</span><a href="#local-6989586621679395304"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC -&gt; StdGen
</span><a href="IC.Ref.Types.html#rng"><span class="hs-identifier hs-var">rng</span></a></span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679395302"><span class="hs-identifier hs-var">ic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679395301"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679395302"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rng :: StdGen
</span><a href="IC.Ref.Types.html#rng"><span class="hs-identifier hs-var">rng</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679395300"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span id="local-6989586621679399090"><span class="annot"><a href="IC.Ref.Management.html#icEcdsaPublicKey"><span class="hs-identifier hs-type">icEcdsaPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399090"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399090"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;ecdsa_public_key&quot;</span></span></span><span>
</span><span id="line-431"></span><span id="icEcdsaPublicKey"><span class="annot"><span class="annottext">icEcdsaPublicKey :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId -&gt; ICManagement m .! &quot;ecdsa_public_key&quot;
</span><a href="IC.Ref.Management.html#icEcdsaPublicKey"><span class="hs-identifier hs-var hs-var">icEcdsaPublicKey</span></a></span></span><span> </span><span id="local-6989586621679395261"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395261"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679395260"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
        &quot;derivation_path&quot; ':-&gt; Vector ByteString,
        &quot;key_id&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                     &quot;name&quot; ':-&gt; Text])])
</span><a href="#local-6989586621679395260"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395259"><span class="annot"><span class="annottext">cid :: EntityId
</span><a href="#local-6989586621679395259"><span class="hs-identifier hs-var hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (r :: Row (*)).
((r .! &quot;canister_id&quot;) ~ Maybe Principal) =&gt;
EntityId -&gt; Rec r -&gt; EntityId
</span><a href="IC.Ref.Management.html#fetchCanisterIdfromMaybe"><span class="hs-identifier hs-var">fetchCanisterIdfromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395261"><span class="hs-identifier hs-var">caller</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
        &quot;derivation_path&quot; ':-&gt; Vector ByteString,
        &quot;key_id&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                     &quot;name&quot; ':-&gt; Text])])
</span><a href="#local-6989586621679395260"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; EntityId -&gt; m ()
</span><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-var">canisterMustExist</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395259"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395258"><span class="annot"><span class="annottext">key :: ExtendedSecretKey
</span><a href="#local-6989586621679395258"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; ExtendedSecretKey
</span><a href="IC.Ref.Types.html#getCanisterRootKey"><span class="hs-identifier hs-var">getCanisterRootKey</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395259"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExtendedSecretKey -&gt; Vector ByteString -&gt; Either MethodName XPubKey
</span><a href="IC.Crypto.Bitcoin.html#derivePublicKey"><span class="hs-identifier hs-var">Bitcoin.derivePublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedSecretKey
</span><a href="#local-6989586621679395258"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
        &quot;derivation_path&quot; ':-&gt; Vector ByteString,
        &quot;key_id&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                     &quot;name&quot; ':-&gt; Text])])
</span><a href="#local-6989586621679395260"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;derivation_path&quot; a =&gt; a
</span><span class="">#derivation_path</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679395255"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679395255"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679395255"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_ENCODING"><span class="hs-identifier hs-var">EC_INVALID_ENCODING</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679395254"><span class="annot"><span class="annottext">XPubKey
</span><a href="#local-6989586621679395254"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-438"></span><span>                   </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;public_key&quot; a =&gt; a
</span><span class="">#public_key</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPubKey -&gt; ByteString
</span><a href="IC.Crypto.Bitcoin.html#publicKeyToDER"><span class="hs-identifier hs-var">publicKeyToDER</span></a></span><span> </span><span class="annot"><span class="annottext">XPubKey
</span><a href="#local-6989586621679395254"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>                   </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;chain_code&quot; a =&gt; a
</span><span class="">#chain_code</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPubKey -&gt; ByteString
</span><a href="IC.Crypto.Bitcoin.html#extractChainCode"><span class="hs-identifier hs-var">extractChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">XPubKey
</span><a href="#local-6989586621679395254"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span id="local-6989586621679399089"><span class="annot"><a href="IC.Ref.Management.html#icSignWithEcdsa"><span class="hs-identifier hs-type">icSignWithEcdsa</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399089"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399089"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679399089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;sign_with_ecdsa&quot;</span></span></span><span>
</span><span id="line-442"></span><span id="icSignWithEcdsa"><span class="annot"><span class="annottext">icSignWithEcdsa :: forall (m :: * -&gt; *).
(ICM m, CanReject m) =&gt;
EntityId -&gt; ICManagement m .! &quot;sign_with_ecdsa&quot;
</span><a href="IC.Ref.Management.html#icSignWithEcdsa"><span class="hs-identifier hs-var hs-var">icSignWithEcdsa</span></a></span></span><span> </span><span id="local-6989586621679395234"><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395234"><span class="hs-identifier hs-var">caller</span></a></span></span><span> </span><span id="local-6989586621679395233"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;derivation_path&quot; ':-&gt; Vector ByteString,
        &quot;key_id&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                     &quot;name&quot; ':-&gt; Text]),
        &quot;message_hash&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679395233"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679395232"><span class="annot"><span class="annottext">key :: ExtendedSecretKey
</span><a href="#local-6989586621679395232"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; ExtendedSecretKey
</span><a href="IC.Ref.Types.html#getCanisterRootKey"><span class="hs-identifier hs-var">getCanisterRootKey</span></a></span><span> </span><span class="annot"><span class="annottext">EntityId
</span><a href="#local-6989586621679395234"><span class="hs-identifier hs-var">caller</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExtendedSecretKey -&gt; Vector ByteString -&gt; Either MethodName XPrvKey
</span><a href="IC.Crypto.Bitcoin.html#derivePrivateKey"><span class="hs-identifier hs-var">Bitcoin.derivePrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedSecretKey
</span><a href="#local-6989586621679395232"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;derivation_path&quot; ':-&gt; Vector ByteString,
        &quot;key_id&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                     &quot;name&quot; ':-&gt; Text]),
        &quot;message_hash&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679395233"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;derivation_path&quot; a =&gt; a
</span><span class="">#derivation_path</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-445"></span><span>      </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679395230"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679395230"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679395230"><span class="hs-identifier hs-var">err</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_ENCODING"><span class="hs-identifier hs-var">EC_INVALID_ENCODING</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679395229"><span class="annot"><span class="annottext">XPrvKey
</span><a href="#local-6989586621679395229"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either MethodName Hash256
</span><a href="IC.Crypto.Bitcoin.html#toHash256"><span class="hs-identifier hs-var">Bitcoin.toHash256</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;derivation_path&quot; ':-&gt; Vector ByteString,
        &quot;key_id&quot;
        ':-&gt; Rec
               ('R
                  '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                     &quot;name&quot; ':-&gt; Text]),
        &quot;message_hash&quot; ':-&gt; ByteString])
</span><a href="#local-6989586621679395233"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;message_hash&quot; a =&gt; a
</span><span class="">#message_hash</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>          </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679395227"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679395227"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_CANISTER_ERROR"><span class="hs-identifier hs-var">RC_CANISTER_ERROR</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679395227"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_INVALID_ENCODING"><span class="hs-identifier hs-var">EC_INVALID_ENCODING</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>          </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679395226"><span class="annot"><span class="annottext">Hash256
</span><a href="#local-6989586621679395226"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[])
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">R.empty</span></a></span><span>
</span><span id="line-451"></span><span>              </span><span class="annot"><span class="annottext">forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;signature&quot; a =&gt; a
</span><span class="">#signature</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPrvKey -&gt; Hash256 -&gt; ByteString
</span><a href="IC.Crypto.Bitcoin.html#sign"><span class="hs-identifier hs-var">Bitcoin.sign</span></a></span><span> </span><span class="annot"><span class="annottext">XPrvKey
</span><a href="#local-6989586621679395229"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Hash256
</span><a href="#local-6989586621679395226"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span></pre></body></html>