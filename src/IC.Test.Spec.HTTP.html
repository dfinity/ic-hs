<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |

This module contains a test suite for the Internet Computer

-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IC.Test.Spec.HTTP</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Spec.HTTP.html#canister_http_calls"><span class="hs-identifier">canister_http_calls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vec</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/0jk65whfq0iafh197qkfc77cj8i0kl5v-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html"><span class="hs-identifier">Data.ByteString.Lazy.UTF8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BLU</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/5nl5lyfznc78f5v4byqwsc8cnidi0h64-tasty-1.4.3-doc/share/doc/tasty-1.4.3/html/src/Test.Tasty.html"><span class="hs-identifier">Test.Tasty</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html"><span class="hs-identifier">Test.Tasty.HUnit</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.html"><span class="hs-identifier">Data.Row</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.html"><span class="hs-identifier">Codec.Candid</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Candid</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">K</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KM</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Management.html"><span class="hs-identifier">IC.Management</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#HttpResponse"><span class="hs-identifier">HttpResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier">HttpHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier">EntityId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Constants.html"><span class="hs-identifier">IC.Constants</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Id.Fresh.html"><span class="hs-identifier">IC.Id.Fresh</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Universal.html"><span class="hs-identifier">IC.Test.Universal</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.html"><span class="hs-identifier">IC.Test.Agent</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html"><span class="hs-identifier">IC.Test.Agent.UnsafeCalls</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.SafeCalls.html"><span class="hs-identifier">IC.Test.Agent.SafeCalls</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Spec.Utils.html"><span class="hs-identifier">IC.Test.Spec.Utils</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier">TestSubnetConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Utils.html"><span class="hs-identifier">IC.Utils</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- * Helpers</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-type">charFromInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span>
</span><span id="line-49"></span><span id="charFromInt"><span class="annot"><span class="annottext">charFromInt :: Int -&gt; Char
</span><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-var hs-var">charFromInt</span></a></span></span><span> </span><span id="local-6989586621679427135"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679427135"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Char.html#chr"><span class="hs-identifier hs-var">chr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679427135"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- * Canister http calls</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-type">check_distinct_headers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier hs-type">HttpHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-54"></span><span id="check_distinct_headers"><span class="annot"><span class="annottext">check_distinct_headers :: Vector HttpHeader -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-var hs-var">check_distinct_headers</span></a></span></span><span> </span><span id="local-6989586621679427130"><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679427130"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679427128"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679427128"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679427128"><span class="annot"><span class="annottext">xs :: [Text]
</span><a href="#local-6989586621679427128"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679427123"><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679427123"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#toLower"><span class="hs-identifier hs-var">T.toLower</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679427123"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;name&quot; a =&gt; a
</span><span class="">#name</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Vector a -&gt; [a]
</span><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#toList"><span class="hs-identifier hs-var">Vec.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679427130"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-type">http_headers_to_map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier hs-type">HttpHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-58"></span><span id="http_headers_to_map"><span class="annot"><span class="annottext">http_headers_to_map :: Vector HttpHeader -&gt; Text -&gt; Maybe Text
</span><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-var hs-var">http_headers_to_map</span></a></span></span><span> </span><span id="local-6989586621679427118"><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679427118"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679427117"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427117"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427117"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679427114"><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679427114"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679427114"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;name&quot; a =&gt; a
</span><span class="">#name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679427114"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;value&quot; a =&gt; a
</span><span class="">#value</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Vector a -&gt; [a]
</span><a href="file:///nix/store/aadcybz54gv18flf14ak9c3fjbcdx7d6-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#toList"><span class="hs-identifier hs-var">Vec.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679427118"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-type">map_to_lower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="map_to_lower"><span class="annot"><span class="annottext">map_to_lower :: [(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var hs-var">map_to_lower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679427113"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427113"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679427112"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427112"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#toLower"><span class="hs-identifier hs-var">T.toLower</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427113"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427112"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-type">check_http_response</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Management.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span id="check_http_response"><span class="annot"><span class="annottext">check_http_response :: HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var hs-var">check_http_response</span></a></span></span><span> </span><span id="local-6989586621679427110"><span class="annot"><span class="annottext">HttpResponse
</span><a href="#local-6989586621679427110"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP response header names must be distinct&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-var">check_distinct_headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpResponse
</span><a href="#local-6989586621679427110"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;headers&quot; a =&gt; a
</span><span class="">#headers</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP header \&quot;content-length\&quot; must contain the length of the body&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
</span><a href="#local-6989586621679427108"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;content-length&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-68"></span><span>                                        </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679427106"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427106"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427106"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse
</span><a href="#local-6989586621679427110"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679427108"><span class="annot"><span class="annottext">h :: Text -&gt; Maybe Text
</span><a href="#local-6989586621679427108"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Text -&gt; Maybe Text
</span><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-var">http_headers_to_map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse
</span><a href="#local-6989586621679427110"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;headers&quot; a =&gt; a
</span><span class="">#headers</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="HttpRequestHeaders"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-var">HttpRequestHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpRequestHeaders"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-var">HttpRequestHeaders</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">newtype</span><span> </span><span id="HttpRequestBody"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpRequestBody"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679427092"><span id="local-6989586621679427097"><span class="annot"><span class="annottext">HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
$c/= :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
== :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
$c== :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="HttpRequest"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-var">HttpRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span id="HttpRequest"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-var">HttpRequest</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="method"><span class="annot"><span class="annottext">HttpRequest -&gt; Text
</span><a href="IC.Test.Spec.HTTP.html#method"><span class="hs-identifier hs-var hs-var">method</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-79"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="headers"><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestHeaders
</span><a href="IC.Test.Spec.HTTP.html#headers"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-type">HttpRequestHeaders</span></a></span><span>
</span><span id="line-80"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="body"><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#body"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-type">HttpRequestBody</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679427082"><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679427065"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HttpRequest
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679427062"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679427062"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; HttpRequestHeaders -&gt; HttpRequestBody -&gt; HttpRequest
</span><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-var">HttpRequest</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679427062"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;method&quot;</span></span><span>
</span><span id="line-86"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679427062"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;headers&quot;</span></span><span>
</span><span id="line-87"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679427062"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;data&quot;</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679427056"><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-type">HttpRequestHeaders</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679427049"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HttpRequestHeaders
</span><a href="#local-6989586621679427049"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679427048"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679427048"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679427044"><span class="annot"><span class="annottext">r :: Maybe [(Text, Text)]
</span><a href="#local-6989586621679427044"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679427042"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679427042"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679427041"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679427041"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679427040"><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="#local-6989586621679427040"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679427041"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679427038"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427038"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679427037"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427037"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">K.toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679427042"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427038"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427037"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="#local-6989586621679427040"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-94"></span><span>                                            </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall v. KeyMap v -&gt; [(Key, v)]
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.KeyMap.html#toList"><span class="hs-identifier hs-var">KM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679427048"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="#local-6989586621679427044"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-96"></span><span>                </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679427034"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427034"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; HttpRequestHeaders
</span><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-var">HttpRequestHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427034"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679427031"><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-type">HttpRequestBody</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679427027"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HttpRequestBody
</span><a href="#local-6989586621679427027"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679427026"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427026"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427026"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679427290"><span class="annot"><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-type">list_subset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427290"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679427290"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679427290"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-104"></span><span id="list_subset"><span class="annot"><span class="annottext">list_subset :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var hs-var">list_subset</span></a></span></span><span> </span><span id="local-6989586621679427019"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679427019"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679427018"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679427018"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679427016"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679427016"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679427016"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679427018"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679427019"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#headers_match"><span class="hs-identifier hs-type">headers_match</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-107"></span><span id="headers_match"><span class="annot"><span class="annottext">headers_match :: [(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#headers_match"><span class="hs-identifier hs-var hs-var">headers_match</span></a></span></span><span> </span><span id="local-6989586621679427013"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427013"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679427012"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427012"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679427011"><span class="annot"><span class="annottext">(Text, Text)
</span><a href="#local-6989586621679427011"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, Text)
</span><a href="#local-6989586621679427011"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427012"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427013"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679427009"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427009"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679427008"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427008"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427009"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427008"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427013"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427009"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;host&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427009"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;content-length&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679427009"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;accept-encoding&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427012"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-type">check_http_json</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a></span><span>
</span><span id="line-110"></span><span id="check_http_json"><span class="annot"><span class="annottext">check_http_json :: String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var hs-var">check_http_json</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe HttpRequest
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; IO a
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertFailure"><span class="hs-identifier hs-var">assertFailure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not parse the original HttpRequest from the response&quot;</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span id="local-6989586621679427003"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679427003"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679427002"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427002"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span id="local-6989586621679427001"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679427001"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679427000"><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679427000"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Wrong HTTP method&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679427003"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest -&gt; Text
</span><a href="IC.Test.Spec.HTTP.html#method"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679427000"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Headers were not properly included in the HTTP request&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#headers_match"><span class="hs-identifier hs-var">headers_match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679427002"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestHeaders
</span><a href="IC.Test.Spec.HTTP.html#headers"><span class="hs-identifier hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679427000"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-type">HttpRequestHeaders</span></a></span><span> </span><span id="local-6989586621679426999"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679426999"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679426999"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body was not properly included in the HTTP request&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679427001"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#body"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679427000"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_body"><span class="hs-identifier hs-type">check_http_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-117"></span><span id="check_http_body"><span class="annot"><span class="annottext">check_http_body :: ByteString -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_http_body"><span class="hs-identifier hs-var hs-var">check_http_body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Bool
</span><a href="#local-6989586621679426997"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Text
</span><a href="IC.Utils.html#fromUtf8"><span class="hs-identifier hs-var">fromUtf8</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679426997"><span class="annot"><span class="annottext">aux :: Maybe Text -&gt; Bool
</span><a href="#local-6989586621679426997"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="#local-6989586621679426997"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679426991"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679426991"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679426991"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#canister_http_calls"><span class="hs-identifier hs-type">canister_http_calls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier hs-type">TestSubnetConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/5nl5lyfznc78f5v4byqwsc8cnidi0h64-tasty-1.4.3-doc/share/doc/tasty-1.4.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span id="canister_http_calls"><span class="annot"><span class="annottext">canister_http_calls :: HasAgentConfig =&gt; TestSubnetConfig -&gt; [TestTree]
</span><a href="IC.Test.Spec.HTTP.html#canister_http_calls"><span class="hs-identifier hs-var hs-var">canister_http_calls</span></a></span></span><span> </span><span id="local-6989586621679425947"><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679425946"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425946"><span class="hs-identifier hs-var">ecid_as_word64</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425945"><span class="annot"><span class="annottext">ecid :: ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var hs-var">ecid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; ByteString
</span><a href="IC.Types.html#rawEntityId"><span class="hs-identifier hs-var">rawEntityId</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EntityId
</span><a href="IC.Id.Fresh.html#wordToId"><span class="hs-identifier hs-var">wordToId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425946"><span class="hs-identifier hs-var">ecid_as_word64</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- Corner cases</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid domain name&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425941"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425941"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_invalid_address_request%27"><span class="hs-identifier hs-var">ic_http_invalid_address_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425941"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xwWPqqbNqxxHmLXdguF4DN9xGq22nczV.com&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425941"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid IP address&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425937"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425937"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_invalid_address_request%27"><span class="hs-identifier hs-var">ic_http_invalid_address_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425937"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;240.0.0.0&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425937"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- &quot;Currently, the GET, HEAD, and POST methods are supported for HTTP requests.&quot;</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GET call&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425936"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425936"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425934"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425934"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-138"></span><span>      </span><span id="local-6989586621679425933"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425933"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425936"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425934"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425936"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425933"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425933"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="file:///nix/store/0jk65whfq0iafh197qkfc77cj8i0kl5v-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425934"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425933"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST call&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425929"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425929"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425926"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425926"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425925"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425925"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>      </span><span id="local-6989586621679425924"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425924"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425929"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425926"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425925"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425929"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425924"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425924"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425925"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425926"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425924"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HEAD call&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425920"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425920"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425918"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679425918"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6666</span></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425917"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425917"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425918"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425915"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425915"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>      </span><span id="local-6989586621679425914"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425914"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_head_request"><span class="hs-identifier hs-var">ic_http_head_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425920"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425917"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425915"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425920"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425914"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425914"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP response header names must be distinct&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-var">check_distinct_headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425914"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;headers&quot; a =&gt; a
</span><span class="">#headers</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425908"><span class="annot"><span class="annottext">h :: Maybe Text
</span><a href="#local-6989586621679425908"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Text -&gt; Maybe Text
</span><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-var">http_headers_to_map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425914"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;headers&quot; a =&gt; a
</span><span class="">#headers</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;content-length&quot;</span></span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;content-length must be present and at least &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425918"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679425908"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-162"></span><span>                  </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679425907"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425907"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Read a =&gt; String -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Text.Read.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425907"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425918"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- &quot;For security reasons, only HTTPS connections are allowed (URLs must start with https://).&quot;</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;url must start with https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425903"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425903"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679425902"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425902"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425902"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;http://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425903"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425902"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- &quot;The size of an HTTP request from the canister is the total number of bytes representing the names and values of HTTP headers and the HTTP body. The maximal size for the request from the canister is 2MB (2,000,000B).&quot;</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible request size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425898"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425898"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425897"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425897"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;content-type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;text/html; charset=utf-8&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425893"><span class="annot"><span class="annottext">len_hs :: Word64
</span><a href="#local-6989586621679425893"><span class="hs-identifier hs-var hs-var">len_hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679425891"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425891"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679425890"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425890"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425891"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425890"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425897"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425885"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425885"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_request_bytes_limit"><span class="hs-identifier hs-var">max_request_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425893"><span class="hs-identifier hs-var">len_hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-177"></span><span>      </span><span id="local-6989586621679425883"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425883"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425898"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;request_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425885"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425897"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425898"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425883"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425883"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425875"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425875"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Read a =&gt; String -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Text.Read.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Text
</span><a href="IC.Utils.html#fromUtf8"><span class="hs-identifier hs-var">fromUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425883"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Request size must be at least (the HTTP client can add more headers) &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_request_bytes_limit"><span class="hs-identifier hs-var">max_request_bytes_limit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425875"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425893"><span class="hs-identifier hs-var">len_hs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425885"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible request size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425873"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425873"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425872"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425872"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;content-type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;text/html; charset=utf-8&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425868"><span class="annot"><span class="annottext">len_hs :: Word64
</span><a href="#local-6989586621679425868"><span class="hs-identifier hs-var hs-var">len_hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679425867"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425867"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679425866"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425866"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425867"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679425866"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425872"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425860"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425860"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_request_bytes_limit"><span class="hs-identifier hs-var">max_request_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425868"><span class="hs-identifier hs-var">len_hs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425858"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425858"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425858"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425873"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425858"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;request_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425860"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425872"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425873"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- &quot;The size of an HTTP response from the remote server is the total number of bytes representing the names and values of HTTP headers and the HTTP body. Each request can specify a maximal size for the response from the remote HTTP server.&quot;</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425857"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425857"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425855"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425855"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-comment">{- Response headers (size: 158)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 11
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425853"><span class="annot"><span class="annottext">header_size :: Int
</span><a href="#local-6989586621679425853"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">158</span></span><span>
</span><span id="line-202"></span><span>      </span><span id="local-6989586621679425852"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425852"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425857"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425855"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425855"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425853"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425857"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425852"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425852"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="file:///nix/store/0jk65whfq0iafh197qkfc77cj8i0kl5v-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425855"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-205"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425852"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425851"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425851"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425849"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425849"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-comment">{- Response headers (size: 158)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 11
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425847"><span class="annot"><span class="annottext">header_size :: Int
</span><a href="#local-6989586621679425847"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">158</span></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425851"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425849"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425849"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425847"><span class="hs-identifier hs-var">header_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425851"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size (only headers)&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425846"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425846"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">{- Response headers (size: 157)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 0
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425844"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679425844"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">157</span></span><span>
</span><span id="line-230"></span><span>      </span><span id="local-6989586621679425843"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425843"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425846"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/0&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425844"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425846"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425843"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425843"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/bytestring-0.11.4.0/src/Data.ByteString.Lazy.html#empty"><span class="hs-identifier hs-var">BS.empty</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425843"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size (only headers) exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425841"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425841"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-comment">{- Response headers (size: 157)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 0
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425839"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679425839"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">157</span></span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425841"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/0&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425839"><span class="hs-identifier hs-var">header_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425841"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- &quot;The upper limit on the maximal size for the response is 2MB (2,000,000B) and this value also applies if no maximal size value is specified.&quot;</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large maximum possible response size&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-comment">{- Response headers (size: 163)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 1999837
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425837"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679425837"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">163</span></span><span>
</span><span id="line-259"></span><span>      </span><span id="local-6989586621679425836"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425836"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>      </span><span id="local-6989586621679425829"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425829"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425836"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425837"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425836"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425829"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">202</span></span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425829"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;body&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-string">&quot;Dummy!&quot;</span></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425829"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large maximum possible response size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-comment">{- Response headers (size: 163)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 1999838
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425826"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679425826"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">163</span></span><span>
</span><span id="line-275"></span><span>      </span><span id="local-6989586621679425825"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425825"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425825"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425826"><span class="hs-identifier hs-var">header_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425825"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- &quot;The URL must be valid according to RFC-3986 and its length must not exceed 8192.&quot;</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non-ascii URL&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425824"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425824"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425824"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&#50504;&#45397;&#54616;&#49464;&#50836;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425824"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible url size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425823"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425823"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-284"></span><span>      </span><span id="local-6989586621679425822"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425822"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_long_url_http_request"><span class="hs-identifier hs-var">ic_long_url_http_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425823"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_http_request_url_length"><span class="hs-identifier hs-var">max_http_request_url_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425823"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425822"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP response body is malformed&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_http_body"><span class="hs-identifier hs-var">check_http_body</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425822"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425822"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible url size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425819"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425819"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_long_url_http_request%27"><span class="hs-identifier hs-var">ic_long_url_http_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425817"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425817"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425817"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425819"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425817"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_http_request_url_length"><span class="hs-identifier hs-var">max_http_request_url_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425819"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-comment">-- &quot;max_response_bytes - If provided, the value must not exceed 2MB (2,000,000B).&quot;</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible value of max_response_bytes&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425816"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425816"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425814"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425814"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-296"></span><span>      </span><span id="local-6989586621679425813"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425813"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425816"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425814"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425816"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425813"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425813"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="file:///nix/store/0jk65whfq0iafh197qkfc77cj8i0kl5v-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425814"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-299"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425813"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible value of max_response_bytes exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425812"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425812"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425810"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425810"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425809"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425809"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425809"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425812"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425809"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425810"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425812"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-comment">-- &quot;transform - an optional record that includes a function that transforms raw responses to sanitized responses, and a byte-encoded context that is provided to the function upon invocation, along with the response to be sanitized.&quot;</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;call with simple transform&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425806"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425806"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-309"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425805"><span class="annot"><span class="annottext">hs :: Vector HttpHeader
</span><a href="#local-6989586621679425805"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>      </span><span id="local-6989586621679425804"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425804"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621679425803"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425803"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425804"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425806"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
</span><a href="#local-6989586621679425805"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425804"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425803"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">202</span></span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425803"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;body&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-string">&quot;Dummy!&quot;</span></span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425803"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reflect transform context&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425801"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425801"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-318"></span><span>      </span><span id="local-6989586621679425800"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425800"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpTransformContext"><span class="hs-identifier hs-var">getHttpTransformContext</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#argData"><span class="hs-identifier hs-var">argData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679425796"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425796"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425800"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425801"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;asdf&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425800"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425796"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425796"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;body&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-string">&quot;asdf&quot;</span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- &quot;If provided, the calling canister itself must export this (transform) function.&quot;</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non-existent transform function&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425794"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425794"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-327"></span><span>      </span><span id="local-6989586621679425793"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425793"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425793"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425794"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nonExistent&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425793"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reference to a transform function exposed by another canister&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425791"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425791"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-332"></span><span>      </span><span id="local-6989586621679425790"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425790"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621679425789"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425789"><span class="hs-identifier hs-var">cid2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/jkxjsrg5143afynhvaz1h65p40k9xpg6-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425788"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425788"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425788"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425790"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425788"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425791"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425789"><span class="hs-identifier hs-var">cid2</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-comment">-- &quot;The maximal number of bytes representing the response produced by the transform function is 2MB (2,000,000B).&quot;</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible canister response size&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-comment">{- Response headers (size: 163)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 1999837
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425786"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679425786"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">163</span></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425785"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679425785"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="IC.Test.Spec.Utils.html#maximumSizeResponseBodySize"><span class="hs-identifier hs-var">maximumSizeResponseBodySize</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425776"><span class="annot"><span class="annottext">new_pages :: Exp 'I
</span><a href="#local-6989586621679425776"><span class="hs-identifier hs-var hs-var">new_pages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679425785"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1024</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425772"><span class="annot"><span class="annottext">max_size :: Exp 'I
</span><a href="#local-6989586621679425772"><span class="hs-identifier hs-var hs-var">max_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679425785"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621679425771"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425771"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: T). Exp t -&gt; Prog
</span><a href="IC.Test.Universal.html#ignore"><span class="hs-identifier hs-var">ignore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#stableGrow"><span class="hs-identifier hs-var">stableGrow</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679425776"><span class="hs-identifier hs-var">new_pages</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'I -&gt; Prog
</span><a href="IC.Test.Universal.html#stableFill"><span class="hs-identifier hs-var">stableFill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">120</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679425772"><span class="hs-identifier hs-var">max_size</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#stableRead"><span class="hs-identifier hs-var">stableRead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679425772"><span class="hs-identifier hs-var">max_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>      </span><span id="local-6989586621679425765"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425765"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425771"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425786"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425771"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425765"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425765"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; ByteString
</span><a href="IC.Test.Spec.Utils.html#bodyOfSize"><span class="hs-identifier hs-var">bodyOfSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="IC.Test.Spec.Utils.html#maximumSizeResponseBodySize"><span class="hs-identifier hs-var">maximumSizeResponseBodySize</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible canister response size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-comment">{- Response headers (size: 163)
          date: Jan 1 1970 00:00:00 GMT
          content-type: application/octet-stream
          content-length: 1999837
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425762"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679425762"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">163</span></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425759"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679425759"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="IC.Test.Spec.Utils.html#maximumSizeResponseBodySize"><span class="hs-identifier hs-var">maximumSizeResponseBodySize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425752"><span class="annot"><span class="annottext">new_pages :: Exp 'I
</span><a href="#local-6989586621679425752"><span class="hs-identifier hs-var hs-var">new_pages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679425759"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1024</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425751"><span class="annot"><span class="annottext">max_size :: Exp 'I
</span><a href="#local-6989586621679425751"><span class="hs-identifier hs-var hs-var">max_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679425759"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span id="local-6989586621679425750"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425750"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: T). Exp t -&gt; Prog
</span><a href="IC.Test.Universal.html#ignore"><span class="hs-identifier hs-var">ignore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#stableGrow"><span class="hs-identifier hs-var">stableGrow</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679425752"><span class="hs-identifier hs-var">new_pages</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'I -&gt; Prog
</span><a href="IC.Test.Universal.html#stableFill"><span class="hs-identifier hs-var">stableFill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">120</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679425751"><span class="hs-identifier hs-var">max_size</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#stableRead"><span class="hs-identifier hs-var">stableRead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679425751"><span class="hs-identifier hs-var">max_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425750"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425762"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425750"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-comment">-- &quot;When the transform function is invoked by the system due to a canister HTTP request, the caller's identity is the principal of the management canister.&quot;</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check caller of transform&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425748"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679425748"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679425747"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425747"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#parsePrincipal"><span class="hs-identifier hs-var">parsePrincipal</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#caller"><span class="hs-identifier hs-var">caller</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>      </span><span id="local-6989586621679425744"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425744"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425747"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679425748"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;caller&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425747"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425744"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425744"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;body&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-string">&quot;aaaaa-aa&quot;</span></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the number of headers must not exceed 64.&quot;</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of request headers&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425743"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425743"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425740"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425740"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-385"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425729"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425729"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425728"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425728"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679425728"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425728"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-386"></span><span>      </span><span id="local-6989586621679425726"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425726"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425743"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425740"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425729"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425743"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425726"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-388"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425726"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425729"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425740"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425726"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of request headers exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425725"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425725"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425722"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425722"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-393"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425714"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425714"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425713"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425713"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679425713"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425713"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425712"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425712"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425712"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425725"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425712"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425722"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425714"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425725"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of response headers&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425711"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425711"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">{- These 6 response headers are always included:
          date: Jan 1 1970 00:00:00 GMT
          content-type: text/plain; charset=utf-8
          content-length: 0
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425708"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679425708"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425698"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425698"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425697"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425697"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679425697"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425697"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425708"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>      </span><span id="local-6989586621679425696"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425711"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;many_response_headers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425708"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425711"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response HTTP headers have not been received properly.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var">list_subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425698"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
b -&gt; [(Text, Text)]
</span><a href="IC.Utils.html#http_response_headers"><span class="hs-identifier hs-var">http_response_headers</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of response headers exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425694"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-comment">{- These 6 response headers are always included:
          date: Jan 1 1970 00:00:00 GMT
          content-type: text/plain; charset=utf-8
          content-length: 0
          connection: close
          access-control-allow-origin: *
          access-control-allow-credentials: true
      -}</span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425689"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679425689"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;many_response_headers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425689"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the number of bytes representing a header name must not exceed 8KiB.&quot;</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header name length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425688"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425688"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425685"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425685"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425682"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425682"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>      </span><span id="local-6989586621679425680"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425680"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425688"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425685"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425682"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425688"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425680"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425680"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425682"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425685"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425680"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header name length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425679"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425679"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425676"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425676"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-436"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425671"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425671"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425670"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425670"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425670"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425679"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425670"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425676"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425671"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425679"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header name length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425669"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425669"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425668"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425668"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425665"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425665"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>      </span><span id="local-6989586621679425664"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425664"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425669"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_name/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425669"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-443"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425664"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response HTTP headers have not been received properly.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var">list_subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425665"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
b -&gt; [(Text, Text)]
</span><a href="IC.Utils.html#http_response_headers"><span class="hs-identifier hs-var">http_response_headers</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425664"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425664"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header name length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425663"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425663"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425660"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425660"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425663"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_name/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425660"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425663"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the number of bytes representing a header value must not exceed 8KiB.&quot;</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header value length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425659"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425659"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425656"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425656"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425653"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425653"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>      </span><span id="local-6989586621679425652"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425652"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425659"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425656"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425653"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425659"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425652"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-458"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425652"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425653"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425656"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425652"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header value length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425651"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425651"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425648"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425648"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425643"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425643"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425642"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425642"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425642"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425651"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425642"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425648"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425643"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425651"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header value length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425641"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425641"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425640"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425640"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425637"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425637"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425640"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-469"></span><span>      </span><span id="local-6989586621679425636"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425636"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425641"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_value/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425640"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425641"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-470"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425636"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-471"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response HTTP headers have not been received properly.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var">list_subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425637"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
b -&gt; [(Text, Text)]
</span><a href="IC.Utils.html#http_response_headers"><span class="hs-identifier hs-var">http_response_headers</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425636"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425636"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header value length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425635"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425635"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-475"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425632"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425632"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-476"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425635"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_value/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425632"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425635"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the total number of bytes representing the header names and values must not exceed 48KiB.&quot;</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request total header size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425631"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425631"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425630"><span class="annot"><span class="annottext">chunk :: Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value is not divisible by &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value exceeds &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">26</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">26</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425622"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425622"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425619"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425619"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425606"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425606"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-var">charFromInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425605"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425630"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679425605"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425605"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425622"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-487"></span><span>      </span><span id="local-6989586621679425604"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425604"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425631"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425619"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425606"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425631"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-488"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425604"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425604"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-490"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425606"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425619"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/rhpajhk2ll143xa2fczh162iylaqciv3-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425604"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;body&quot; a =&gt; a
</span><span class="">#body</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request total header size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425603"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425603"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425602"><span class="annot"><span class="annottext">chunk :: Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-494"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value is not divisible by &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value exceeds &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">26</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">26</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425598"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425598"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425595"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679425595"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-498"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425582"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679425582"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#empty"><span class="hs-identifier hs-var">T.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-var">charFromInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425580"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425602"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679425580"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679425580"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425598"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679425579"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425579"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425579"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425603"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425579"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425595"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679425582"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425603"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response total header size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425578"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425578"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425577"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425577"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span>
</span><span id="line-503"></span><span>      </span><span id="local-6989586621679425576"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425576"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425578"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large_response_total_header_size/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425577"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425578"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-504"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425576"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/nnzz8gzyw0qnn3bhw2mz58w4is6jbk20-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;status&quot; a =&gt; a
</span><span class="">#status</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  &quot;status&quot;
  '[ &quot;body&quot; ':-&gt; ByteString,
     &quot;headers&quot;
     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
     &quot;status&quot; ':-&gt; Natural]
</span><span class="hs-number">200</span></span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/x8f35h2bgw8yxq58j3fhkgy1j7ipa21h-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Total header size is not equal to &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425577"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;), Integral c) =&gt;
b -&gt; c
</span><a href="IC.Utils.html#http_response_headers_total_size"><span class="hs-identifier hs-var">http_response_headers_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425576"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425577"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679425576"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response total header size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425945"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679425574"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425574"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425571"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679425571"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425574"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679425947"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large_response_total_header_size/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679425571"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679425574"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-512"></span></pre></body></html>