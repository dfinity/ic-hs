<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">{-|
This module implements the main abstract types of the Internet Computer.
-}</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IC.Ref.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/0jk65whfq0iafh197qkfc77cj8i0kl5v-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html"><span class="hs-identifier">Data.ByteString.Lazy.UTF8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BLU</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Numeric.Natural.html"><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html"><span class="hs-identifier">Control.Monad.State.Class</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/z2nj2f44psha18adfp88w2mqhkhcb6zx-MonadRandom-0.5.3-doc/share/doc/MonadRandom-0.5.3/html/src/Control.Monad.Random.Lazy.html"><span class="hs-identifier">Control.Monad.Random.Lazy</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Stack.html"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Crypto.Bitcoin.html"><span class="hs-identifier">IC.Crypto.Bitcoin</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bitcoin</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Canister.html"><span class="hs-identifier">IC.Canister</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Id.Fresh.html"><span class="hs-identifier">IC.Id.Fresh</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Id.Forms.html"><span class="hs-identifier">IC.Id.Forms</span></a></span><span class="hs-special">(</span><span class="annot"><a href="IC.Id.Forms.html#mkSelfAuthenticatingId"><span class="hs-identifier">mkSelfAuthenticatingId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Utils.html"><span class="hs-identifier">IC.Utils</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.HashTree.html"><span class="hs-identifier">IC.HashTree</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.HashTree.html#Blob"><span class="hs-identifier">Blob</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Certificate.html"><span class="hs-identifier">IC.Certificate</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Crypto.html"><span class="hs-identifier">IC.Crypto</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Abstract HTTP Interface</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">data</span><span> </span><span id="CallRequest"><span class="annot"><a href="IC.Ref.Types.html#CallRequest"><span class="hs-identifier hs-var">CallRequest</span></a></span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="CallRequest"><span class="annot"><a href="IC.Ref.Types.html#CallRequest"><span class="hs-identifier hs-var">CallRequest</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#UserId"><span class="hs-identifier hs-type">UserId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#MethodName"><span class="hs-identifier hs-type">MethodName</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392031"><span id="local-6989586621679392041"><span class="annot"><span class="annottext">CallRequest -&gt; CallRequest -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CallRequest -&gt; CallRequest -&gt; Bool
$c/= :: CallRequest -&gt; CallRequest -&gt; Bool
== :: CallRequest -&gt; CallRequest -&gt; Bool
$c== :: CallRequest -&gt; CallRequest -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391999"><span id="local-6989586621679392001"><span id="local-6989586621679392004"><span id="local-6989586621679392007"><span id="local-6989586621679392010"><span id="local-6989586621679392017"><span id="local-6989586621679392025"><span class="annot"><span class="annottext">Eq CallRequest
CallRequest -&gt; CallRequest -&gt; Bool
CallRequest -&gt; CallRequest -&gt; Ordering
CallRequest -&gt; CallRequest -&gt; CallRequest
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: CallRequest -&gt; CallRequest -&gt; CallRequest
$cmin :: CallRequest -&gt; CallRequest -&gt; CallRequest
max :: CallRequest -&gt; CallRequest -&gt; CallRequest
$cmax :: CallRequest -&gt; CallRequest -&gt; CallRequest
&gt;= :: CallRequest -&gt; CallRequest -&gt; Bool
$c&gt;= :: CallRequest -&gt; CallRequest -&gt; Bool
&gt; :: CallRequest -&gt; CallRequest -&gt; Bool
$c&gt; :: CallRequest -&gt; CallRequest -&gt; Bool
&lt;= :: CallRequest -&gt; CallRequest -&gt; Bool
$c&lt;= :: CallRequest -&gt; CallRequest -&gt; Bool
&lt; :: CallRequest -&gt; CallRequest -&gt; Bool
$c&lt; :: CallRequest -&gt; CallRequest -&gt; Bool
compare :: CallRequest -&gt; CallRequest -&gt; Ordering
$ccompare :: CallRequest -&gt; CallRequest -&gt; Ordering
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391982"><span id="local-6989586621679391984"><span id="local-6989586621679391995"><span class="annot"><span class="annottext">CallId -&gt; CallRequest -&gt; ShowS
[CallRequest] -&gt; ShowS
CallRequest -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CallRequest] -&gt; ShowS
$cshowList :: [CallRequest] -&gt; ShowS
show :: CallRequest -&gt; MethodName
$cshow :: CallRequest -&gt; MethodName
showsPrec :: CallId -&gt; CallRequest -&gt; ShowS
$cshowsPrec :: CallId -&gt; CallRequest -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="QueryRequest"><span class="annot"><a href="IC.Ref.Types.html#QueryRequest"><span class="hs-identifier hs-var">QueryRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QueryRequest"><span class="annot"><a href="IC.Ref.Types.html#QueryRequest"><span class="hs-identifier hs-var">QueryRequest</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#UserId"><span class="hs-identifier hs-type">UserId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#MethodName"><span class="hs-identifier hs-type">MethodName</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="ReadStateRequest"><span class="annot"><a href="IC.Ref.Types.html#ReadStateRequest"><span class="hs-identifier hs-var">ReadStateRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReadStateRequest"><span class="annot"><a href="IC.Ref.Types.html#ReadStateRequest"><span class="hs-identifier hs-var">ReadStateRequest</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#UserId"><span class="hs-identifier hs-type">UserId</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IC.HashTree.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="RequestStatus"><span class="annot"><a href="IC.Ref.Types.html#RequestStatus"><span class="hs-identifier hs-var">RequestStatus</span></a></span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Received"><span class="annot"><a href="IC.Ref.Types.html#Received"><span class="hs-identifier hs-var">Received</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Processing"><span class="annot"><a href="IC.Ref.Types.html#Processing"><span class="hs-identifier hs-var">Processing</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CallResponse"><span class="annot"><a href="IC.Ref.Types.html#CallResponse"><span class="hs-identifier hs-var">CallResponse</span></a></span></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallResponse"><span class="hs-identifier hs-type">CallResponse</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391964"><span id="local-6989586621679391966"><span id="local-6989586621679391970"><span class="annot"><span class="annottext">CallId -&gt; RequestStatus -&gt; ShowS
[RequestStatus] -&gt; ShowS
RequestStatus -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RequestStatus] -&gt; ShowS
$cshowList :: [RequestStatus] -&gt; ShowS
show :: RequestStatus -&gt; MethodName
$cshow :: RequestStatus -&gt; MethodName
showsPrec :: CallId -&gt; RequestStatus -&gt; ShowS
$cshowsPrec :: CallId -&gt; RequestStatus -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">data</span><span> </span><span id="CallResponse"><span class="annot"><a href="IC.Ref.Types.html#CallResponse"><span class="hs-identifier hs-var">CallResponse</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Rejected"><span class="annot"><a href="IC.Ref.Types.html#Rejected"><span class="hs-identifier hs-var">Rejected</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Replied"><span class="annot"><a href="IC.Ref.Types.html#Replied"><span class="hs-identifier hs-var">Replied</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391948"><span id="local-6989586621679391950"><span id="local-6989586621679391960"><span class="annot"><span class="annottext">CallId -&gt; CallResponse -&gt; ShowS
[CallResponse] -&gt; ShowS
CallResponse -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CallResponse] -&gt; ShowS
$cshowList :: [CallResponse] -&gt; ShowS
show :: CallResponse -&gt; MethodName
$cshow :: CallResponse -&gt; MethodName
showsPrec :: CallId -&gt; CallResponse -&gt; ShowS
$cshowsPrec :: CallId -&gt; CallResponse -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="ValidationError"><span class="annot"><a href="IC.Ref.Types.html#ValidationError"><span class="hs-identifier hs-var">ValidationError</span></a></span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="HTTPError"><span class="annot"><a href="IC.Ref.Types.html#HTTPError"><span class="hs-identifier hs-var">HTTPError</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExecutionError"><span class="annot"><a href="IC.Ref.Types.html#ExecutionError"><span class="hs-identifier hs-var">ExecutionError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="ReqResponse"><span class="annot"><a href="IC.Ref.Types.html#ReqResponse"><span class="hs-identifier hs-var">ReqResponse</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RequestError"><span class="annot"><a href="IC.Ref.Types.html#RequestError"><span class="hs-identifier hs-var">RequestError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryResponse"><span class="annot"><a href="IC.Ref.Types.html#QueryResponse"><span class="hs-identifier hs-var">QueryResponse</span></a></span></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallResponse"><span class="hs-identifier hs-type">CallResponse</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ReadStateResponse"><span class="annot"><a href="IC.Ref.Types.html#ReadStateResponse"><span class="hs-identifier hs-var">ReadStateResponse</span></a></span></span><span> </span><span class="annot"><a href="IC.Certificate.html#Certificate"><span class="hs-identifier hs-type">Certificate</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391921"><span id="local-6989586621679391923"><span id="local-6989586621679391935"><span class="annot"><span class="annottext">CallId -&gt; ReqResponse -&gt; ShowS
[ReqResponse] -&gt; ShowS
ReqResponse -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ReqResponse] -&gt; ShowS
$cshowList :: [ReqResponse] -&gt; ShowS
show :: ReqResponse -&gt; MethodName
$cshow :: ReqResponse -&gt; MethodName
showsPrec :: CallId -&gt; ReqResponse -&gt; ShowS
$cshowsPrec :: CallId -&gt; ReqResponse -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- IC state</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- The canister state</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="RunStatus"><span class="annot"><a href="IC.Ref.Types.html#RunStatus"><span class="hs-identifier hs-var">RunStatus</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="IsRunning"><span class="annot"><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsStopping"><span class="annot"><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-var">IsStopping</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsStopped"><span class="annot"><a href="IC.Ref.Types.html#IsStopped"><span class="hs-identifier hs-var">IsStopped</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsDeleted"><span class="annot"><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span></span><span> </span><span class="hs-comment">-- not actually a run state, but convenient in this code</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391909"><span id="local-6989586621679391913"><span class="annot"><span class="annottext">RunStatus -&gt; RunStatus -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RunStatus -&gt; RunStatus -&gt; Bool
$c/= :: RunStatus -&gt; RunStatus -&gt; Bool
== :: RunStatus -&gt; RunStatus -&gt; Bool
$c== :: RunStatus -&gt; RunStatus -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391899"><span id="local-6989586621679391901"><span id="local-6989586621679391906"><span class="annot"><span class="annottext">CallId -&gt; RunStatus -&gt; ShowS
[RunStatus] -&gt; ShowS
RunStatus -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RunStatus] -&gt; ShowS
$cshowList :: [RunStatus] -&gt; ShowS
show :: RunStatus -&gt; MethodName
$cshow :: RunStatus -&gt; MethodName
showsPrec :: CallId -&gt; RunStatus -&gt; ShowS
$cshowsPrec :: CallId -&gt; RunStatus -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="CanisterContent"><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-var">CanisterContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CanisterContent"><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-var">CanisterContent</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="can_mod"><span class="annot"><span class="annottext">CanisterContent -&gt; CanisterModule
</span><a href="IC.Ref.Types.html#can_mod"><span class="hs-identifier hs-var hs-var">can_mod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Canister.html#CanisterModule"><span class="hs-identifier hs-type">CanisterModule</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="wasm_state"><span class="annot"><span class="annottext">CanisterContent -&gt; WasmState
</span><a href="IC.Ref.Types.html#wasm_state"><span class="hs-identifier hs-var hs-var">wasm_state</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Canister.html#WasmState"><span class="hs-identifier hs-type">WasmState</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391884"><span id="local-6989586621679391886"><span id="local-6989586621679391893"><span class="annot"><span class="annottext">CallId -&gt; CanisterContent -&gt; ShowS
[CanisterContent] -&gt; ShowS
CanisterContent -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CanisterContent] -&gt; ShowS
$cshowList :: [CanisterContent] -&gt; ShowS
show :: CanisterContent -&gt; MethodName
$cshow :: CanisterContent -&gt; MethodName
showsPrec :: CallId -&gt; CanisterContent -&gt; ShowS
$cshowsPrec :: CallId -&gt; CanisterContent -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">data</span><span> </span><span id="CanisterHistory"><span class="annot"><a href="IC.Ref.Types.html#CanisterHistory"><span class="hs-identifier hs-var">CanisterHistory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CanisterHistory"><span class="annot"><a href="IC.Ref.Types.html#CanisterHistory"><span class="hs-identifier hs-var">CanisterHistory</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-95"></span><span>    </span><span id="changes"><span class="annot"><span class="annottext">CanisterHistory -&gt; [Change]
</span><a href="IC.Ref.Types.html#changes"><span class="hs-identifier hs-var hs-var">changes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IC.Types.html#Change"><span class="hs-identifier hs-type">Change</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="total_num_changes"><span class="annot"><span class="annottext">CanisterHistory -&gt; Word64
</span><a href="IC.Ref.Types.html#total_num_changes"><span class="hs-identifier hs-var hs-var">total_num_changes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span>
</span><span id="line-97"></span><span class="hs-special">}</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391870"><span id="local-6989586621679391872"><span id="local-6989586621679391879"><span class="annot"><span class="annottext">CallId -&gt; CanisterHistory -&gt; ShowS
[CanisterHistory] -&gt; ShowS
CanisterHistory -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CanisterHistory] -&gt; ShowS
$cshowList :: [CanisterHistory] -&gt; ShowS
show :: CanisterHistory -&gt; MethodName
$cshow :: CanisterHistory -&gt; MethodName
showsPrec :: CallId -&gt; CanisterHistory -&gt; ShowS
$cshowsPrec :: CallId -&gt; CanisterHistory -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">data</span><span> </span><span id="CanState"><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-var">CanState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CanState"><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-var">CanState</span></a></span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="content"><span class="annot"><span class="annottext">CanState -&gt; Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-type">CanisterContent</span></a></span><span> </span><span class="hs-comment">-- absent when empty</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="run_status"><span class="annot"><span class="annottext">CanState -&gt; RunStatus
</span><a href="IC.Ref.Types.html#run_status"><span class="hs-identifier hs-var hs-var">run_status</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#RunStatus"><span class="hs-identifier hs-type">RunStatus</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="controllers"><span class="annot"><span class="annottext">CanState -&gt; Set CanisterId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var hs-var">controllers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="memory_allocation"><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#memory_allocation"><span class="hs-identifier hs-var hs-var">memory_allocation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compute_allocation"><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#compute_allocation"><span class="hs-identifier hs-var hs-var">compute_allocation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="freezing_threshold"><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#freezing_threshold"><span class="hs-identifier hs-var hs-var">freezing_threshold</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="time"><span class="annot"><span class="annottext">CanState -&gt; Timestamp
</span><a href="IC.Ref.Types.html#time"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cycle_balance"><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#cycle_balance"><span class="hs-identifier hs-var hs-var">cycle_balance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="certified_data"><span class="annot"><span class="annottext">CanState -&gt; Blob
</span><a href="IC.Ref.Types.html#certified_data"><span class="hs-identifier hs-var hs-var">certified_data</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="canister_version"><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var hs-var">canister_version</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="canister_history"><span class="annot"><span class="annottext">CanState -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var hs-var">canister_history</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterHistory"><span class="hs-identifier hs-type">CanisterHistory</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="global_timer"><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#global_timer"><span class="hs-identifier hs-var hs-var">global_timer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- |Not part of the spec, but in this implementation we schedule</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">-- heartbeats only for canisters who have not been idle since the</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- last heartbeat, so we remember the last action.</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="last_action"><span class="annot"><span class="annottext">CanState -&gt; Maybe EntryPoint
</span><a href="IC.Ref.Types.html#last_action"><span class="hs-identifier hs-var hs-var">last_action</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#EntryPoint"><span class="hs-identifier hs-type">EntryPoint</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391828"><span id="local-6989586621679391830"><span id="local-6989586621679391852"><span class="annot"><span class="annottext">CallId -&gt; CanState -&gt; ShowS
[CanState] -&gt; ShowS
CanState -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CanState] -&gt; ShowS
$cshowList :: [CanState] -&gt; ShowS
show :: CanState -&gt; MethodName
$cshow :: CanState -&gt; MethodName
showsPrec :: CallId -&gt; CanState -&gt; ShowS
$cshowsPrec :: CallId -&gt; CanState -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- A canister entry point is either a publicly named function, a closure</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- (callback + environment) or a heartbeat.</span><span>
</span><span id="line-122"></span><span class="hs-keyword">data</span><span> </span><span id="EntryPoint"><span class="annot"><a href="IC.Ref.Types.html#EntryPoint"><span class="hs-identifier hs-var">EntryPoint</span></a></span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Public"><span class="annot"><a href="IC.Ref.Types.html#Public"><span class="hs-identifier hs-var">Public</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#MethodName"><span class="hs-identifier hs-type">MethodName</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Closure"><span class="annot"><a href="IC.Ref.Types.html#Closure"><span class="hs-identifier hs-var">Closure</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#Callback"><span class="hs-identifier hs-type">Callback</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Cycles"><span class="hs-identifier hs-type">Cycles</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Heartbeat"><span class="annot"><a href="IC.Ref.Types.html#Heartbeat"><span class="hs-identifier hs-var">Heartbeat</span></a></span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GlobalTimer"><span class="annot"><a href="IC.Ref.Types.html#GlobalTimer"><span class="hs-identifier hs-var">GlobalTimer</span></a></span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391807"><span id="local-6989586621679391809"><span id="local-6989586621679391821"><span class="annot"><span class="annottext">CallId -&gt; EntryPoint -&gt; ShowS
[EntryPoint] -&gt; ShowS
EntryPoint -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EntryPoint] -&gt; ShowS
$cshowList :: [EntryPoint] -&gt; ShowS
show :: EntryPoint -&gt; MethodName
$cshow :: EntryPoint -&gt; MethodName
showsPrec :: CallId -&gt; EntryPoint -&gt; ShowS
$cshowsPrec :: CallId -&gt; EntryPoint -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">type</span><span> </span><span id="CallId"><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-var">CallId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-130"></span><span class="hs-keyword">data</span><span> </span><span id="CallContext"><span class="annot"><a href="IC.Ref.Types.html#CallContext"><span class="hs-identifier hs-var">CallContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CallContext"><span class="annot"><a href="IC.Ref.Types.html#CallContext"><span class="hs-identifier hs-var">CallContext</span></a></span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="canister"><span class="annot"><span class="annottext">CallContext -&gt; CanisterId
</span><a href="IC.Ref.Types.html#canister"><span class="hs-identifier hs-var hs-var">canister</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="origin"><span class="annot"><span class="annottext">CallContext -&gt; CallOrigin
</span><a href="IC.Ref.Types.html#origin"><span class="hs-identifier hs-var hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallOrigin"><span class="hs-identifier hs-type">CallOrigin</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="needs_to_respond"><span class="annot"><span class="annottext">CallContext -&gt; NeedsToRespond
</span><a href="IC.Ref.Types.html#needs_to_respond"><span class="hs-identifier hs-var hs-var">needs_to_respond</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#NeedsToRespond"><span class="hs-identifier hs-type">NeedsToRespond</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="deleted"><span class="annot"><span class="annottext">CallContext -&gt; Bool
</span><a href="IC.Ref.Types.html#deleted"><span class="hs-identifier hs-var hs-var">deleted</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="available_cycles"><span class="annot"><span class="annottext">CallContext -&gt; Natural
</span><a href="IC.Ref.Types.html#available_cycles"><span class="hs-identifier hs-var hs-var">available_cycles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#Cycles"><span class="hs-identifier hs-type">Cycles</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="last_trap"><span class="annot"><span class="annottext">CallContext -&gt; Maybe MethodName
</span><a href="IC.Ref.Types.html#last_trap"><span class="hs-identifier hs-var hs-var">last_trap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-comment">-- ^ non-normative, but yields better reject messages</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391784"><span id="local-6989586621679391786"><span id="local-6989586621679391798"><span class="annot"><span class="annottext">CallId -&gt; CallContext -&gt; ShowS
[CallContext] -&gt; ShowS
CallContext -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CallContext] -&gt; ShowS
$cshowList :: [CallContext] -&gt; ShowS
show :: CallContext -&gt; MethodName
$cshow :: CallContext -&gt; MethodName
showsPrec :: CallId -&gt; CallContext -&gt; ShowS
$cshowsPrec :: CallId -&gt; CallContext -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">data</span><span> </span><span id="CallOrigin"><span class="annot"><a href="IC.Ref.Types.html#CallOrigin"><span class="hs-identifier hs-var">CallOrigin</span></a></span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FromUser"><span class="annot"><a href="IC.Ref.Types.html#FromUser"><span class="hs-identifier hs-var">FromUser</span></a></span></span><span> </span><span class="annot"><a href="IC.Types.html#RequestID"><span class="hs-identifier hs-type">RequestID</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FromCanister"><span class="annot"><a href="IC.Ref.Types.html#FromCanister"><span class="hs-identifier hs-var">FromCanister</span></a></span></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Callback"><span class="hs-identifier hs-type">Callback</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FromSystemTask"><span class="annot"><a href="IC.Ref.Types.html#FromSystemTask"><span class="hs-identifier hs-var">FromSystemTask</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391770"><span id="local-6989586621679391777"><span class="annot"><span class="annottext">CallOrigin -&gt; CallOrigin -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CallOrigin -&gt; CallOrigin -&gt; Bool
$c/= :: CallOrigin -&gt; CallOrigin -&gt; Bool
== :: CallOrigin -&gt; CallOrigin -&gt; Bool
$c== :: CallOrigin -&gt; CallOrigin -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391758"><span id="local-6989586621679391760"><span id="local-6989586621679391768"><span class="annot"><span class="annottext">CallId -&gt; CallOrigin -&gt; ShowS
[CallOrigin] -&gt; ShowS
CallOrigin -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CallOrigin] -&gt; ShowS
$cshowList :: [CallOrigin] -&gt; ShowS
show :: CallOrigin -&gt; MethodName
$cshow :: CallOrigin -&gt; MethodName
showsPrec :: CallId -&gt; CallOrigin -&gt; ShowS
$cshowsPrec :: CallId -&gt; CallOrigin -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">data</span><span> </span><span id="Message"><span class="annot"><a href="IC.Ref.Types.html#Message"><span class="hs-identifier hs-var">Message</span></a></span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CallMessage"><span class="annot"><a href="IC.Ref.Types.html#CallMessage"><span class="hs-identifier hs-var">CallMessage</span></a></span></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="call_context"><span class="annot"><span class="annottext">Message -&gt; CallId
</span><a href="IC.Ref.Types.html#call_context"><span class="hs-identifier hs-var hs-var">call_context</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="entry"><span class="annot"><span class="annottext">Message -&gt; EntryPoint
</span><a href="IC.Ref.Types.html#entry"><span class="hs-identifier hs-var hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#EntryPoint"><span class="hs-identifier hs-type">EntryPoint</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ResponseMessage"><span class="annot"><a href="IC.Ref.Types.html#ResponseMessage"><span class="hs-identifier hs-var">ResponseMessage</span></a></span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="call_context"><span class="annot"><a href="IC.Ref.Types.html#call_context"><span class="hs-identifier hs-var">call_context</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="response"><span class="annot"><span class="annottext">Message -&gt; Response
</span><a href="IC.Ref.Types.html#response"><span class="hs-identifier hs-var hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="refunded_cycles"><span class="annot"><span class="annottext">Message -&gt; Natural
</span><a href="IC.Ref.Types.html#refunded_cycles"><span class="hs-identifier hs-var hs-var">refunded_cycles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#Cycles"><span class="hs-identifier hs-type">Cycles</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391739"><span id="local-6989586621679391741"><span id="local-6989586621679391750"><span class="annot"><span class="annottext">CallId -&gt; Message -&gt; ShowS
[Message] -&gt; ShowS
Message -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Message] -&gt; ShowS
$cshowList :: [Message] -&gt; ShowS
show :: Message -&gt; MethodName
$cshow :: Message -&gt; MethodName
showsPrec :: CallId -&gt; Message -&gt; ShowS
$cshowsPrec :: CallId -&gt; Message -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- Finally, the full IC state:</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">type</span><span> </span><span id="Subnet"><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-var">Subnet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Types.html#SubnetType"><span class="hs-identifier hs-type">SubnetType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Crypto.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="IC.Ref.Types.html#isRootSubnet"><span class="hs-identifier hs-type">isRootSubnet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-164"></span><span id="isRootSubnet"><span class="annot"><span class="annottext">isRootSubnet :: Subnet -&gt; Bool
</span><a href="IC.Ref.Types.html#isRootSubnet"><span class="hs-identifier hs-var hs-var">isRootSubnet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391737"><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679391737"><span class="hs-identifier hs-var">ranges</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)] -&gt; CanisterId -&gt; Bool
</span><a href="IC.Id.Fresh.html#checkCanisterIdInRanges"><span class="hs-identifier hs-var">checkCanisterIdInRanges</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679391737"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391735"><span class="hs-identifier hs-var">nns_canister_id</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679391735"><span class="annot"><span class="annottext">nns_canister_id :: CanisterId
</span><a href="#local-6989586621679391735"><span class="hs-identifier hs-var hs-var">nns_canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; CanisterId
</span><a href="IC.Id.Fresh.html#wordToId"><span class="hs-identifier hs-var">wordToId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">data</span><span> </span><span id="IC"><span class="annot"><a href="IC.Ref.Types.html#IC"><span class="hs-identifier hs-var">IC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IC"><span class="annot"><a href="IC.Ref.Types.html#IC"><span class="hs-identifier hs-var">IC</span></a></span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="canisters"><span class="annot"><span class="annottext">IC -&gt; CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var hs-var">canisters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#%21A6"><span class="hs-operator hs-type">&#8614;</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="requests"><span class="annot"><span class="annottext">IC -&gt; Blob &#8614; (CallRequest, (RequestStatus, CanisterId))
</span><a href="IC.Ref.Types.html#requests"><span class="hs-identifier hs-var hs-var">requests</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#RequestID"><span class="hs-identifier hs-type">RequestID</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#%21A6"><span class="hs-operator hs-type">&#8614;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CallRequest"><span class="hs-identifier hs-type">CallRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#RequestStatus"><span class="hs-identifier hs-type">RequestStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="messages"><span class="annot"><span class="annottext">IC -&gt; Seq Message
</span><a href="IC.Ref.Types.html#messages"><span class="hs-identifier hs-var hs-var">messages</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Message"><span class="hs-identifier hs-type">Message</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="call_contexts"><span class="annot"><span class="annottext">IC -&gt; CallId &#8614; CallContext
</span><a href="IC.Ref.Types.html#call_contexts"><span class="hs-identifier hs-var hs-var">call_contexts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#%21A6"><span class="hs-operator hs-type">&#8614;</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallContext"><span class="hs-identifier hs-type">CallContext</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="rng"><span class="annot"><span class="annottext">IC -&gt; StdGen
</span><a href="IC.Ref.Types.html#rng"><span class="hs-identifier hs-var hs-var">rng</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/kwjhvjzd9a4fh4sc1pajfx8br8bc58k5-random-1.2.1.1-doc/share/doc/random-1.2.1.1/html/src/System.Random.Internal.html#StdGen"><span class="hs-identifier hs-type">StdGen</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="secretRootKey"><span class="annot"><span class="annottext">IC -&gt; SecretKey
</span><a href="IC.Ref.Types.html#secretRootKey"><span class="hs-identifier hs-var hs-var">secretRootKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Crypto.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="rootSubnet"><span class="annot"><span class="annottext">IC -&gt; Maybe CanisterId
</span><a href="IC.Ref.Types.html#rootSubnet"><span class="hs-identifier hs-var hs-var">rootSubnet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="subnets"><span class="annot"><span class="annottext">IC -&gt; [Subnet]
</span><a href="IC.Ref.Types.html#subnets"><span class="hs-identifier hs-var hs-var">subnets</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391696"><span id="local-6989586621679391698"><span id="local-6989586621679391721"><span class="annot"><span class="annottext">CallId -&gt; IC -&gt; ShowS
[IC] -&gt; ShowS
IC -&gt; MethodName
forall a.
(CallId -&gt; a -&gt; ShowS)
-&gt; (a -&gt; MethodName) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [IC] -&gt; ShowS
$cshowList :: [IC] -&gt; ShowS
show :: IC -&gt; MethodName
$cshow :: IC -&gt; MethodName
showsPrec :: CallId -&gt; IC -&gt; ShowS
$cshowsPrec :: CallId -&gt; IC -&gt; ShowS
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- The functions below want stateful access to a value of type 'IC'</span><span>
</span><span id="line-181"></span><span class="hs-keyword">type</span><span> </span><span id="ICM"><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-var">ICM</span></a></span></span><span> </span><span id="local-6989586621679391685"><span class="annot"><a href="#local-6989586621679391685"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#MonadState"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#IC"><span class="hs-identifier hs-type">IC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391685"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Utils.html#HasRefConfig"><span class="hs-identifier hs-type">HasRefConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391685"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="IC.Ref.Types.html#initialIC"><span class="hs-identifier hs-type">initialIC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IC.Types.html#SubnetConfig"><span class="hs-identifier hs-type">SubnetConfig</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#IC"><span class="hs-identifier hs-type">IC</span></a></span><span>
</span><span id="line-184"></span><span id="initialIC"><span class="annot"><span class="annottext">initialIC :: [SubnetConfig] -&gt; IO IC
</span><a href="IC.Ref.Types.html#initialIC"><span class="hs-identifier hs-var hs-var">initialIC</span></a></span></span><span> </span><span id="local-6989586621679391683"><span class="annot"><span class="annottext">[SubnetConfig]
</span><a href="#local-6989586621679391683"><span class="hs-identifier hs-var">subnet_configs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679391682"><span class="annot"><span class="annottext">subnets :: [Subnet]
</span><a href="#local-6989586621679391682"><span class="hs-identifier hs-var hs-var">subnets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig -&gt; Subnet
</span><a href="#local-6989586621679391681"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">[SubnetConfig]
</span><a href="#local-6989586621679391683"><span class="hs-identifier hs-var">subnet_configs</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679391680"><span class="annot"><span class="annottext">root_subnet :: Maybe Subnet
</span><a href="#local-6989586621679391680"><span class="hs-identifier hs-var hs-var">root_subnet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="annot"><span class="annottext">Subnet -&gt; Bool
</span><a href="IC.Ref.Types.html#isRootSubnet"><span class="hs-identifier hs-var">isRootSubnet</span></a></span><span> </span><span class="annot"><span class="annottext">[Subnet]
</span><a href="#local-6989586621679391682"><span class="hs-identifier hs-var">subnets</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679391678"><span class="annot"><span class="annottext">sk :: SecretKey
</span><a href="#local-6989586621679391678"><span class="hs-identifier hs-var hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679391680"><span class="hs-identifier hs-var">root_subnet</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Blob -&gt; SecretKey
</span><a href="IC.Crypto.html#createSecretKeyBLS"><span class="hs-identifier hs-var">createSecretKeyBLS</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-string">&quot;ic-ref's very secure secret root key&quot;</span></span><span>
</span><span id="line-188"></span><span>                                 </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391676"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679391676"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679391676"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">(CanisterId &#8614; CanState)
-&gt; (Blob &#8614; (CallRequest, (RequestStatus, CanisterId)))
-&gt; Seq Message
-&gt; (CallId &#8614; CallContext)
-&gt; StdGen
-&gt; SecretKey
-&gt; Maybe CanisterId
-&gt; [Subnet]
-&gt; IC
</span><a href="IC.Ref.Types.html#IC"><span class="hs-identifier hs-var">IC</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><a href="file:///nix/store/kwjhvjzd9a4fh4sc1pajfx8br8bc58k5-random-1.2.1.1-doc/share/doc/random-1.2.1.1/html/src/System.Random.html#newStdGen"><span class="hs-identifier hs-var">newStdGen</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679391678"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679391673"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391673"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391673"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679391680"><span class="hs-identifier hs-var">root_subnet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[Subnet]
</span><a href="#local-6989586621679391682"><span class="hs-identifier hs-var">subnets</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679391681"><span class="annot"><span class="annottext">sub :: SubnetConfig -&gt; Subnet
</span><a href="#local-6989586621679391681"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679391672"><span class="annot"><span class="annottext">SubnetConfig
</span><a href="#local-6989586621679391672"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecretKey -&gt; CanisterId
</span><a href="#local-6989586621679391671"><span class="hs-identifier hs-var">sub_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubnetConfig -&gt; SecretKey
</span><a href="#local-6989586621679391670"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig
</span><a href="#local-6989586621679391672"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetConfig -&gt; SubnetType
</span><a href="IC.Types.html#subnet_type"><span class="hs-identifier hs-var">subnet_type</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig
</span><a href="#local-6989586621679391672"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetConfig -&gt; Word64
</span><a href="IC.Types.html#subnet_size"><span class="hs-identifier hs-var">subnet_size</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig
</span><a href="#local-6989586621679391672"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetConfig -&gt; SecretKey
</span><a href="#local-6989586621679391670"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig
</span><a href="#local-6989586621679391672"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetConfig -&gt; [(Word64, Word64)]
</span><a href="IC.Types.html#canister_ranges"><span class="hs-identifier hs-var">canister_ranges</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig
</span><a href="#local-6989586621679391672"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679391671"><span class="annot"><span class="annottext">sub_id :: SecretKey -&gt; CanisterId
</span><a href="#local-6989586621679391671"><span class="hs-identifier hs-var hs-var">sub_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blob -&gt; CanisterId
</span><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-var">EntityId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Blob
</span><a href="IC.Id.Forms.html#mkSelfAuthenticatingId"><span class="hs-identifier hs-var">mkSelfAuthenticatingId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; Blob
</span><a href="IC.Crypto.html#toPublicKey"><span class="hs-identifier hs-var">toPublicKey</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679391670"><span class="annot"><span class="annottext">key :: SubnetConfig -&gt; SecretKey
</span><a href="#local-6989586621679391670"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blob -&gt; SecretKey
</span><a href="IC.Crypto.html#createSecretKeyBLS"><span class="hs-identifier hs-var">createSecretKeyBLS</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName -&gt; Blob
</span><a href="file:///nix/store/0jk65whfq0iafh197qkfc77cj8i0kl5v-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SubnetConfig -&gt; MethodName
</span><a href="IC.Types.html#nonce"><span class="hs-identifier hs-var">nonce</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- Error handling plumbing</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">type</span><span> </span><span id="CanReject"><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-var">CanReject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Error.Class.html#MonadError"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span id="local-6989586621679392308"><span id="local-6989586621679392310"><span class="annot"><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-type">reject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392310"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392310"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392308"><span class="hs-identifier hs-type">a2</span></a></span></span></span><span>
</span><span id="line-199"></span><span id="reject"><span class="annot"><span class="annottext">reject :: forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var hs-var">reject</span></a></span></span><span> </span><span id="local-6989586621679391658"><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391658"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621679391657"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391657"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679391656"><span class="annot"><span class="annottext">Maybe ErrorCode
</span><a href="#local-6989586621679391656"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Error.Class.html#throwError"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391658"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391657"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe ErrorCode
</span><a href="#local-6989586621679391656"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="IC.Ref.Types.html#canisterRejected"><span class="hs-identifier hs-type">canisterRejected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallResponse"><span class="hs-identifier hs-type">CallResponse</span></a></span><span>
</span><span id="line-202"></span><span id="canisterRejected"><span class="annot"><span class="annottext">canisterRejected :: (RejectCode, MethodName, Maybe ErrorCode) -&gt; CallResponse
</span><a href="IC.Ref.Types.html#canisterRejected"><span class="hs-identifier hs-var hs-var">canisterRejected</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391653"><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391653"><span class="hs-identifier hs-var">rc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391652"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391652"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391651"><span class="annot"><span class="annottext">Maybe ErrorCode
</span><a href="#local-6989586621679391651"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">(RejectCode, MethodName, Maybe ErrorCode) -&gt; CallResponse
</span><a href="IC.Ref.Types.html#Rejected"><span class="hs-identifier hs-var">Rejected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391653"><span class="hs-identifier hs-var">rc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391652"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_REJECTED"><span class="hs-identifier hs-var">EC_CANISTER_REJECTED</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ErrorCode
</span><a href="#local-6989586621679391651"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="IC.Ref.Types.html#rejectMessage"><span class="hs-identifier hs-type">rejectMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-205"></span><span id="rejectMessage"><span class="annot"><span class="annottext">rejectMessage :: (RejectCode, MethodName, Maybe ErrorCode) -&gt; MethodName
</span><a href="IC.Ref.Types.html#rejectMessage"><span class="hs-identifier hs-var hs-var">rejectMessage</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391646"><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391646"><span class="hs-identifier hs-var">_rc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391645"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391645"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391644"><span class="annot"><span class="annottext">Maybe ErrorCode
</span><a href="#local-6989586621679391644"><span class="hs-identifier hs-var">_err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391645"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621679392294"><span id="local-6989586621679392296"><span class="annot"><a href="IC.Ref.Types.html#onReject"><span class="hs-identifier hs-type">onReject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392294"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679392293"><span class="annot"><a href="#local-6989586621679392293"><span class="hs-identifier hs-type">m'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392293"><span class="hs-identifier hs-type">m'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392293"><span class="hs-identifier hs-type">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392293"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392294"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392296"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392294"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-210"></span><span id="onReject"><span class="annot"><span class="annottext">onReject :: forall (m :: * -&gt; *) b.
ICM m =&gt;
((RejectCode, MethodName, Maybe ErrorCode) -&gt; m b)
-&gt; (forall (m' :: * -&gt; *). (CanReject m', ICM m') =&gt; m' b) -&gt; m b
</span><a href="IC.Ref.Types.html#onReject"><span class="hs-identifier hs-var hs-var">onReject</span></a></span></span><span> </span><span id="local-6989586621679391624"><span class="annot"><span class="annottext">(RejectCode, MethodName, Maybe ErrorCode) -&gt; m b
</span><a href="#local-6989586621679391624"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679391623"><span class="annot"><span class="annottext">forall (m' :: * -&gt; *). (CanReject m', ICM m') =&gt; m' b
</span><a href="#local-6989586621679391623"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m' :: * -&gt; *). (CanReject m', ICM m') =&gt; m' b
</span><a href="#local-6989586621679391623"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679391621"><span class="annot"><span class="annottext">(RejectCode, MethodName, Maybe ErrorCode)
</span><a href="#local-6989586621679391621"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RejectCode, MethodName, Maybe ErrorCode) -&gt; m b
</span><a href="#local-6989586621679391624"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(RejectCode, MethodName, Maybe ErrorCode)
</span><a href="#local-6989586621679391621"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679391620"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679391620"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679391620"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span id="local-6989586621679392265"><span id="local-6989586621679392266"><span id="local-6989586621679392267"><span class="annot"><a href="IC.Ref.Types.html#onErr"><span class="hs-identifier hs-type">onErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392267"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392267"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392265"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392267"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392265"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392267"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392265"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-216"></span><span id="onErr"><span class="annot"><span class="annottext">onErr :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
m (Either a b) -&gt; (a -&gt; m b) -&gt; m b
</span><a href="IC.Ref.Types.html#onErr"><span class="hs-identifier hs-var hs-var">onErr</span></a></span></span><span> </span><span id="local-6989586621679391615"><span class="annot"><span class="annottext">m (Either a b)
</span><a href="#local-6989586621679391615"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679391614"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679391614"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either a b)
</span><a href="#local-6989586621679391615"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Either.html#either"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679391614"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span id="local-6989586621679392257"><span id="local-6989586621679392258"><span class="annot"><a href="IC.Ref.Types.html#orElse"><span class="hs-identifier hs-type">orElse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392258"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392258"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392257"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392258"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392257"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392258"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392257"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-219"></span><span id="orElse"><span class="annot"><span class="annottext">orElse :: forall (m :: * -&gt; *) a. Monad m =&gt; m (Maybe a) -&gt; m a -&gt; m a
</span><a href="IC.Ref.Types.html#orElse"><span class="hs-identifier hs-var hs-var">orElse</span></a></span></span><span> </span><span id="local-6989586621679391608"><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679391608"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679391607"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679391607"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679391608"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679391607"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621679392253"><span id="local-6989586621679392254"><span class="annot"><a href="IC.Ref.Types.html#onTrap"><span class="hs-identifier hs-type">onTrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#TrapOr"><span class="hs-identifier hs-type">TrapOr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392253"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-222"></span><span id="onTrap"><span class="annot"><span class="annottext">onTrap :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (TrapOr a) -&gt; (MethodName -&gt; m a) -&gt; m a
</span><a href="IC.Ref.Types.html#onTrap"><span class="hs-identifier hs-var hs-var">onTrap</span></a></span></span><span> </span><span id="local-6989586621679391602"><span class="annot"><span class="annottext">m (TrapOr a)
</span><a href="#local-6989586621679391602"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679391601"><span class="annot"><span class="annottext">MethodName -&gt; m a
</span><a href="#local-6989586621679391601"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (TrapOr a)
</span><a href="#local-6989586621679391602"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="IC.Types.html#Trap"><span class="hs-identifier hs-type">Trap</span></a></span><span> </span><span id="local-6989586621679391599"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391599"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MethodName -&gt; m a
</span><a href="#local-6989586621679391601"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391599"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="IC.Types.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679391597"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679391597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679391597"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- Helper functions</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span id="local-6989586621679392249"><span class="annot"><a href="IC.Ref.Types.html#getSubnetFromCanisterId%27"><span class="hs-identifier hs-type">getSubnetFromCanisterId'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392249"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392249"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-227"></span><span id="getSubnetFromCanisterId%27"><span class="annot"><span class="annottext">getSubnetFromCanisterId' :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m (Maybe Subnet)
</span><a href="IC.Ref.Types.html#getSubnetFromCanisterId%27"><span class="hs-identifier hs-var hs-var">getSubnetFromCanisterId'</span></a></span></span><span> </span><span id="local-6989586621679391588"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391588"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679391587"><span class="annot"><span class="annottext">[Subnet]
</span><a href="#local-6989586621679391587"><span class="hs-identifier hs-var">subnets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; [Subnet]
</span><a href="IC.Ref.Types.html#subnets"><span class="hs-identifier hs-var">subnets</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391585"><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679391585"><span class="hs-identifier hs-var">ranges</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)] -&gt; CanisterId -&gt; Bool
</span><a href="IC.Id.Fresh.html#checkCanisterIdInRanges"><span class="hs-identifier hs-var">checkCanisterIdInRanges</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><a href="#local-6989586621679391585"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391588"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Subnet]
</span><a href="#local-6989586621679391587"><span class="hs-identifier hs-var">subnets</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621679392244"><span class="annot"><a href="IC.Ref.Types.html#getSubnetFromCanisterId"><span class="hs-identifier hs-type">getSubnetFromCanisterId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392244"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392244"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392244"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span></span><span>
</span><span id="line-232"></span><span id="getSubnetFromCanisterId"><span class="annot"><span class="annottext">getSubnetFromCanisterId :: forall (m :: * -&gt; *).
(CanReject m, ICM m) =&gt;
CanisterId -&gt; m Subnet
</span><a href="IC.Ref.Types.html#getSubnetFromCanisterId"><span class="hs-identifier hs-var hs-var">getSubnetFromCanisterId</span></a></span></span><span> </span><span id="local-6989586621679391569"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391569"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679391568"><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679391568"><span class="hs-identifier hs-var">subnet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m (Maybe Subnet)
</span><a href="IC.Ref.Types.html#getSubnetFromCanisterId%27"><span class="hs-identifier hs-var">getSubnetFromCanisterId'</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391569"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="#local-6989586621679391568"><span class="hs-identifier hs-var">subnet</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">Maybe Subnet
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_SYS_FATAL"><span class="hs-identifier hs-var">RC_SYS_FATAL</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Canister id does not belong to any subnet.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679391566"><span class="annot"><span class="annottext">Subnet
</span><a href="#local-6989586621679391566"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Subnet
</span><a href="#local-6989586621679391566"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621679392242"><span class="annot"><a href="IC.Ref.Types.html#getSubnetFromSubnetId"><span class="hs-identifier hs-type">getSubnetFromSubnetId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Subnet"><span class="hs-identifier hs-type">Subnet</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span id="getSubnetFromSubnetId"><span class="annot"><span class="annottext">getSubnetFromSubnetId :: forall (m :: * -&gt; *).
(CanReject m, ICM m) =&gt;
CanisterId -&gt; m (Maybe Subnet)
</span><a href="IC.Ref.Types.html#getSubnetFromSubnetId"><span class="hs-identifier hs-var hs-var">getSubnetFromSubnetId</span></a></span></span><span> </span><span id="local-6989586621679391552"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391552"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679391551"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391551"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391552"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391551"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; [Subnet]
</span><a href="IC.Ref.Types.html#subnets"><span class="hs-identifier hs-var">subnets</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="IC.Ref.Types.html#getCanisterRootKey"><span class="hs-identifier hs-type">getCanisterRootKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Crypto.Bitcoin.html#ExtendedSecretKey"><span class="hs-identifier hs-type">Bitcoin.ExtendedSecretKey</span></a></span><span>
</span><span id="line-242"></span><span id="getCanisterRootKey"><span class="annot"><span class="annottext">getCanisterRootKey :: CanisterId -&gt; ExtendedSecretKey
</span><a href="IC.Ref.Types.html#getCanisterRootKey"><span class="hs-identifier hs-var hs-var">getCanisterRootKey</span></a></span></span><span> </span><span id="local-6989586621679391549"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391549"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blob -&gt; ExtendedSecretKey
</span><a href="IC.Crypto.Bitcoin.html#createExtendedKey"><span class="hs-identifier hs-var">Bitcoin.createExtendedKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId -&gt; Blob
</span><a href="IC.Types.html#rawEntityId"><span class="hs-identifier hs-var">rawEntityId</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391549"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621679392239"><span class="annot"><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-type">canisterMustExist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanReject"><span class="hs-identifier hs-type">CanReject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392239"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392239"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392239"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-245"></span><span id="canisterMustExist"><span class="annot"><span class="annottext">canisterMustExist :: forall (m :: * -&gt; *). (CanReject m, ICM m) =&gt; CanisterId -&gt; m ()
</span><a href="IC.Ref.Types.html#canisterMustExist"><span class="hs-identifier hs-var hs-var">canisterMustExist</span></a></span></span><span> </span><span id="local-6989586621679391531"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391531"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391531"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">Maybe CanState
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_DESTINATION_INVALID"><span class="hs-identifier hs-var">RC_DESTINATION_INVALID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister does not exist: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391531"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_NOT_FOUND"><span class="hs-identifier hs-var">EC_CANISTER_NOT_FOUND</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">run_status :: CanState -&gt; RunStatus
</span><a href="IC.Ref.Types.html#run_status"><span class="hs-identifier hs-var">run_status</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a2.
CanReject m =&gt;
RejectCode -&gt; MethodName -&gt; Maybe ErrorCode -&gt; m a2
</span><a href="IC.Ref.Types.html#reject"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">RejectCode
</span><a href="IC.Types.html#RC_DESTINATION_INVALID"><span class="hs-identifier hs-var">RC_DESTINATION_INVALID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister no longer exists: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391531"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorCode
</span><a href="IC.Types.html#EC_CANISTER_NOT_FOUND"><span class="hs-identifier hs-var">EC_CANISTER_NOT_FOUND</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">Maybe CanState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span id="local-6989586621679392233"><span class="annot"><a href="IC.Ref.Types.html#isCanisterEmpty"><span class="hs-identifier hs-type">isCanisterEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-254"></span><span id="isCanisterEmpty"><span class="annot"><span class="annottext">isCanisterEmpty :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Bool
</span><a href="IC.Ref.Types.html#isCanisterEmpty"><span class="hs-identifier hs-var hs-var">isCanisterEmpty</span></a></span></span><span> </span><span id="local-6989586621679391513"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391513"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391513"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621679392229"><span class="annot"><a href="IC.Ref.Types.html#createEmptyCanister"><span class="hs-identifier hs-type">createEmptyCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392229"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392229"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-257"></span><span id="createEmptyCanister"><span class="annot"><span class="annottext">createEmptyCanister :: forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; Set CanisterId -&gt; Timestamp -&gt; m ()
</span><a href="IC.Ref.Types.html#createEmptyCanister"><span class="hs-identifier hs-var hs-var">createEmptyCanister</span></a></span></span><span> </span><span id="local-6989586621679391497"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391497"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391496"><span class="annot"><span class="annottext">Set CanisterId
</span><a href="#local-6989586621679391496"><span class="hs-identifier hs-var">controllers</span></a></span></span><span> </span><span id="local-6989586621679391495"><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679391495"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391493"><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391493"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391493"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">canisters :: CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391497"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391491"><span class="hs-identifier hs-var">can</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC -&gt; CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391493"><span class="hs-identifier hs-var">ic</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679391491"><span class="annot"><span class="annottext">can :: CanState
</span><a href="#local-6989586621679391491"><span class="hs-identifier hs-var hs-var">can</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">content :: Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">run_status :: RunStatus
</span><a href="IC.Ref.Types.html#run_status"><span class="hs-identifier hs-var">run_status</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">controllers :: Set CanisterId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set CanisterId
</span><a href="#local-6989586621679391496"><span class="hs-identifier hs-var">controllers</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">memory_allocation :: Natural
</span><a href="IC.Ref.Types.html#memory_allocation"><span class="hs-identifier hs-var">memory_allocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compute_allocation :: Natural
</span><a href="IC.Ref.Types.html#compute_allocation"><span class="hs-identifier hs-var">compute_allocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">freezing_threshold :: Natural
</span><a href="IC.Ref.Types.html#freezing_threshold"><span class="hs-identifier hs-var">freezing_threshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2592000</span></span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">time :: Timestamp
</span><a href="IC.Ref.Types.html#time"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679391495"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cycle_balance :: Natural
</span><a href="IC.Ref.Types.html#cycle_balance"><span class="hs-identifier hs-var">cycle_balance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">certified_data :: Blob
</span><a href="IC.Ref.Types.html#certified_data"><span class="hs-identifier hs-var">certified_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">canister_version :: Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">canister_history :: CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var">canister_history</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Change] -&gt; Word64 -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#CanisterHistory"><span class="hs-identifier hs-var">CanisterHistory</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">global_timer :: Natural
</span><a href="IC.Ref.Types.html#global_timer"><span class="hs-identifier hs-var">global_timer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">last_action :: Maybe EntryPoint
</span><a href="IC.Ref.Types.html#last_action"><span class="hs-identifier hs-var">last_action</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621679392223"><span class="annot"><a href="IC.Ref.Types.html#enqueueMessage"><span class="hs-identifier hs-type">enqueueMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392223"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#Message"><span class="hs-identifier hs-type">Message</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392223"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-277"></span><span id="enqueueMessage"><span class="annot"><span class="annottext">enqueueMessage :: forall (m :: * -&gt; *). ICM m =&gt; Message -&gt; m ()
</span><a href="IC.Ref.Types.html#enqueueMessage"><span class="hs-identifier hs-var hs-var">enqueueMessage</span></a></span></span><span> </span><span id="local-6989586621679391486"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679391486"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391485"><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391485"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391485"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">messages :: Seq Message
</span><a href="IC.Ref.Types.html#messages"><span class="hs-identifier hs-var">messages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IC -&gt; Seq Message
</span><a href="IC.Ref.Types.html#messages"><span class="hs-identifier hs-var">messages</span></a></span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391485"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Sequence.Internal.html#%3A%7C%3E"><span class="hs-operator hs-var">:|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679391486"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="annot"><a href="IC.Ref.Types.html#managementCanisterId"><span class="hs-identifier hs-type">managementCanisterId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span>
</span><span id="line-280"></span><span id="managementCanisterId"><span class="annot"><span class="annottext">managementCanisterId :: CanisterId
</span><a href="IC.Ref.Types.html#managementCanisterId"><span class="hs-identifier hs-var hs-var">managementCanisterId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blob -&gt; CanisterId
</span><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-var">EntityId</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- Call context handling</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="IC.Ref.Types.html#callerOfCallRequest"><span class="hs-identifier hs-type">callerOfCallRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallRequest"><span class="hs-identifier hs-type">CallRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span>
</span><span id="line-285"></span><span id="callerOfCallRequest"><span class="annot"><span class="annottext">callerOfCallRequest :: CallRequest -&gt; CanisterId
</span><a href="IC.Ref.Types.html#callerOfCallRequest"><span class="hs-identifier hs-var hs-var">callerOfCallRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="IC.Ref.Types.html#CallRequest"><span class="hs-identifier hs-type">CallRequest</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679391481"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391481"><span class="hs-identifier hs-var">user_id</span></a></span></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391481"><span class="hs-identifier hs-var">user_id</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span id="local-6989586621679392220"><span class="annot"><a href="IC.Ref.Types.html#callerOfRequest"><span class="hs-identifier hs-type">callerOfRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#RequestID"><span class="hs-identifier hs-type">RequestID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span></span><span>
</span><span id="line-289"></span><span id="callerOfRequest"><span class="annot"><span class="annottext">callerOfRequest :: forall (m :: * -&gt; *). ICM m =&gt; Blob -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#callerOfRequest"><span class="hs-identifier hs-var hs-var">callerOfRequest</span></a></span></span><span> </span><span id="local-6989586621679391469"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391469"><span class="hs-identifier hs-var">rid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391469"><span class="hs-identifier hs-var">rid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; Blob &#8614; (CallRequest, (RequestStatus, CanisterId))
</span><a href="IC.Ref.Types.html#requests"><span class="hs-identifier hs-var">requests</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391468"><span class="annot"><span class="annottext">CallRequest
</span><a href="#local-6989586621679391468"><span class="hs-identifier hs-var">ar</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(RequestStatus, CanisterId)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallRequest -&gt; CanisterId
</span><a href="IC.Ref.Types.html#callerOfCallRequest"><span class="hs-identifier hs-var">callerOfCallRequest</span></a></span><span> </span><span class="annot"><span class="annottext">CallRequest
</span><a href="#local-6989586621679391468"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="annottext">Maybe (CallRequest, (RequestStatus, CanisterId))
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;callerOfRequest&quot;</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621679392216"><span class="annot"><a href="IC.Ref.Types.html#callerOfCallID"><span class="hs-identifier hs-type">callerOfCallID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392216"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392216"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span></span><span>
</span><span id="line-294"></span><span id="callerOfCallID"><span class="annot"><span class="annottext">callerOfCallID :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#callerOfCallID"><span class="hs-identifier hs-var hs-var">callerOfCallID</span></a></span></span><span> </span><span id="local-6989586621679391448"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391448"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679391447"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391447"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var">getCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391448"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; CallOrigin
</span><a href="IC.Ref.Types.html#origin"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391447"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="IC.Ref.Types.html#FromUser"><span class="hs-identifier hs-type">FromUser</span></a></span><span> </span><span id="local-6989586621679391445"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391445"><span class="hs-identifier hs-var">rid</span></a></span></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; Blob -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#callerOfRequest"><span class="hs-identifier hs-var">callerOfRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391445"><span class="hs-identifier hs-var">rid</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="IC.Ref.Types.html#FromCanister"><span class="hs-identifier hs-type">FromCanister</span></a></span><span> </span><span id="local-6989586621679391444"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391444"><span class="hs-identifier hs-var">other_ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679391443"><span class="annot"><span class="annottext">Callback
</span><a href="#local-6989586621679391443"><span class="hs-identifier hs-var">_callback</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#calleeOfCallID"><span class="hs-identifier hs-var">calleeOfCallID</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391444"><span class="hs-identifier hs-var">other_ctxt_id</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="annottext">CallOrigin
</span><a href="IC.Ref.Types.html#FromSystemTask"><span class="hs-identifier hs-var">FromSystemTask</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; CanisterId
</span><a href="IC.Ref.Types.html#canister"><span class="hs-identifier hs-var">canister</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391447"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span id="local-6989586621679391441"><span class="annot"><a href="IC.Ref.Types.html#calleeOfCallID"><span class="hs-identifier hs-type">calleeOfCallID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391441"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391441"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span></span><span>
</span><span id="line-302"></span><span id="calleeOfCallID"><span class="annot"><span class="annottext">calleeOfCallID :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#calleeOfCallID"><span class="hs-identifier hs-var hs-var">calleeOfCallID</span></a></span></span><span> </span><span id="local-6989586621679391428"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391428"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; CanisterId
</span><a href="IC.Ref.Types.html#canister"><span class="hs-identifier hs-var">canister</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var">getCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391428"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="local-6989586621679391427"><span class="annot"><a href="IC.Ref.Types.html#ecidOfCallID"><span class="hs-identifier hs-type">ecidOfCallID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span></span><span>
</span><span id="line-305"></span><span id="ecidOfCallID"><span class="annot"><span class="annottext">ecidOfCallID :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#ecidOfCallID"><span class="hs-identifier hs-var hs-var">ecidOfCallID</span></a></span></span><span> </span><span id="local-6989586621679391411"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391411"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679391410"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391410"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var">getCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391411"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; CallOrigin
</span><a href="IC.Ref.Types.html#origin"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391410"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="IC.Ref.Types.html#FromUser"><span class="hs-identifier hs-type">FromUser</span></a></span><span> </span><span id="local-6989586621679391409"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391409"><span class="hs-identifier hs-var">_rid</span></a></span></span><span> </span><span id="local-6989586621679391408"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391408"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391408"><span class="hs-identifier hs-var">ecid</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><span class="annottext">CallOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CanisterId
</span><a href="IC.Ref.Types.html#callerOfCallID"><span class="hs-identifier hs-var">callerOfCallID</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391411"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span id="local-6989586621679392214"><span class="annot"><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-type">getCallContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392214"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392214"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallContext"><span class="hs-identifier hs-type">CallContext</span></a></span></span><span>
</span><span id="line-312"></span><span id="getCallContext"><span class="annot"><span class="annottext">getCallContext :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var hs-var">getCallContext</span></a></span></span><span> </span><span id="local-6989586621679391403"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391403"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391403"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; CallId &#8614; CallContext
</span><a href="IC.Ref.Types.html#call_contexts"><span class="hs-identifier hs-var">call_contexts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span id="local-6989586621679392208"><span class="annot"><a href="IC.Ref.Types.html#modifyCallContext"><span class="hs-identifier hs-type">modifyCallContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CallContext"><span class="hs-identifier hs-type">CallContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallContext"><span class="hs-identifier hs-type">CallContext</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392208"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-315"></span><span id="modifyCallContext"><span class="annot"><span class="annottext">modifyCallContext :: forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (CallContext -&gt; CallContext) -&gt; m ()
</span><a href="IC.Ref.Types.html#modifyCallContext"><span class="hs-identifier hs-var hs-var">modifyCallContext</span></a></span></span><span> </span><span id="local-6989586621679391396"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391396"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679391395"><span class="annot"><span class="annottext">CallContext -&gt; CallContext
</span><a href="#local-6989586621679391395"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391394"><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391394"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391394"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">call_contexts :: CallId &#8614; CallContext
</span><a href="IC.Ref.Types.html#call_contexts"><span class="hs-identifier hs-var">call_contexts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; CallContext
</span><a href="#local-6989586621679391395"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391396"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC -&gt; CallId &#8614; CallContext
</span><a href="IC.Ref.Types.html#call_contexts"><span class="hs-identifier hs-var">call_contexts</span></a></span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391394"><span class="hs-identifier hs-var">ic</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span id="local-6989586621679392204"><span class="annot"><a href="IC.Ref.Types.html#getCallContextCycles"><span class="hs-identifier hs-type">getCallContextCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Cycles"><span class="hs-identifier hs-type">Cycles</span></a></span></span><span>
</span><span id="line-319"></span><span id="getCallContextCycles"><span class="annot"><span class="annottext">getCallContextCycles :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCallContextCycles"><span class="hs-identifier hs-var hs-var">getCallContextCycles</span></a></span></span><span> </span><span id="local-6989586621679391379"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391379"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; Natural
</span><a href="IC.Ref.Types.html#available_cycles"><span class="hs-identifier hs-var">available_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var">getCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391379"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span id="local-6989586621679392202"><span class="annot"><a href="IC.Ref.Types.html#setCallContextCycles"><span class="hs-identifier hs-type">setCallContextCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392202"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Cycles"><span class="hs-identifier hs-type">Cycles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392202"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-322"></span><span id="setCallContextCycles"><span class="annot"><span class="annottext">setCallContextCycles :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCallContextCycles"><span class="hs-identifier hs-var hs-var">setCallContextCycles</span></a></span></span><span> </span><span id="local-6989586621679391369"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391369"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679391368"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391368"><span class="hs-identifier hs-var">cycles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (CallContext -&gt; CallContext) -&gt; m ()
</span><a href="IC.Ref.Types.html#modifyCallContext"><span class="hs-identifier hs-var">modifyCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391369"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391367"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391367"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391367"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">available_cycles :: Natural
</span><a href="IC.Ref.Types.html#available_cycles"><span class="hs-identifier hs-var">available_cycles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391368"><span class="hs-identifier hs-var">cycles</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621679392200"><span class="annot"><a href="IC.Ref.Types.html#respondCallContext"><span class="hs-identifier hs-type">respondCallContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392200"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392200"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-326"></span><span id="respondCallContext"><span class="annot"><span class="annottext">respondCallContext :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Response -&gt; m ()
</span><a href="IC.Ref.Types.html#respondCallContext"><span class="hs-identifier hs-var hs-var">respondCallContext</span></a></span></span><span> </span><span id="local-6989586621679391326"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391326"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679391325"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679391325"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679391324"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m CallContext
</span><a href="IC.Ref.Types.html#getCallContext"><span class="hs-identifier hs-var">getCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391326"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallContext -&gt; Bool
</span><a href="IC.Ref.Types.html#deleted"><span class="hs-identifier hs-var">deleted</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Internal error: response to deleted call context&quot;</span></span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallContext -&gt; CallOrigin
</span><a href="IC.Ref.Types.html#origin"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CallOrigin
</span><a href="IC.Ref.Types.html#FromSystemTask"><span class="hs-identifier hs-var">FromSystemTask</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Internal error: System tasks cannot be responded to&quot;</span></span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallContext -&gt; NeedsToRespond
</span><a href="IC.Ref.Types.html#needs_to_respond"><span class="hs-identifier hs-var">needs_to_respond</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; NeedsToRespond
</span><a href="IC.Types.html#NeedsToRespond"><span class="hs-identifier hs-var">NeedsToRespond</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Internal error: Double response when responding with &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; MethodName
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679391325"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (CallContext -&gt; CallContext) -&gt; m ()
</span><a href="IC.Ref.Types.html#modifyCallContext"><span class="hs-identifier hs-var">modifyCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391326"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391320"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391320"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391320"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">needs_to_respond :: NeedsToRespond
</span><a href="IC.Ref.Types.html#needs_to_respond"><span class="hs-identifier hs-var">needs_to_respond</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; NeedsToRespond
</span><a href="IC.Types.html#NeedsToRespond"><span class="hs-identifier hs-var">NeedsToRespond</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">available_cycles :: Natural
</span><a href="IC.Ref.Types.html#available_cycles"><span class="hs-identifier hs-var">available_cycles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; Message -&gt; m ()
</span><a href="IC.Ref.Types.html#enqueueMessage"><span class="hs-identifier hs-var">enqueueMessage</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ResponseMessage"><span class="hs-identifier hs-type">ResponseMessage</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">call_context :: CallId
</span><a href="IC.Ref.Types.html#call_context"><span class="hs-identifier hs-var">call_context</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391326"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="annottext">Response
response :: Response
response :: Response
</span><a href="#local-6989586621679391325"><span class="hs-identifier hs-var hs-var">response</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">refunded_cycles :: Natural
</span><a href="IC.Ref.Types.html#refunded_cycles"><span class="hs-identifier hs-var">refunded_cycles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; Natural
</span><a href="IC.Ref.Types.html#available_cycles"><span class="hs-identifier hs-var">available_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span id="local-6989586621679392195"><span class="annot"><a href="IC.Ref.Types.html#replyCallContext"><span class="hs-identifier hs-type">replyCallContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392195"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392195"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-345"></span><span id="replyCallContext"><span class="annot"><span class="annottext">replyCallContext :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Blob -&gt; m ()
</span><a href="IC.Ref.Types.html#replyCallContext"><span class="hs-identifier hs-var hs-var">replyCallContext</span></a></span></span><span> </span><span id="local-6989586621679391310"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391310"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span id="local-6989586621679391309"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391309"><span class="hs-identifier hs-var">blob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Response -&gt; m ()
</span><a href="IC.Ref.Types.html#respondCallContext"><span class="hs-identifier hs-var">respondCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391310"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Blob -&gt; Response
</span><a href="IC.Types.html#Reply"><span class="hs-identifier hs-var">Reply</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391309"><span class="hs-identifier hs-var">blob</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span id="local-6989586621679392193"><span class="annot"><a href="IC.Ref.Types.html#rejectCallContext"><span class="hs-identifier hs-type">rejectCallContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392193"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#RejectCode"><span class="hs-identifier hs-type">RejectCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#ErrorCode"><span class="hs-identifier hs-type">ErrorCode</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392193"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-349"></span><span id="rejectCallContext"><span class="annot"><span class="annottext">rejectCallContext :: forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (RejectCode, MethodName, Maybe ErrorCode) -&gt; m ()
</span><a href="IC.Ref.Types.html#rejectCallContext"><span class="hs-identifier hs-var hs-var">rejectCallContext</span></a></span></span><span> </span><span id="local-6989586621679391298"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391298"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391297"><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391297"><span class="hs-identifier hs-var">rc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391296"><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391296"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391295"><span class="annot"><span class="annottext">Maybe ErrorCode
</span><a href="#local-6989586621679391295"><span class="hs-identifier hs-var">_err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; Response -&gt; m ()
</span><a href="IC.Ref.Types.html#respondCallContext"><span class="hs-identifier hs-var">respondCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391298"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RejectCode, MethodName) -&gt; Response
</span><a href="IC.Types.html#Reject"><span class="hs-identifier hs-var">Reject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RejectCode
</span><a href="#local-6989586621679391297"><span class="hs-identifier hs-var">rc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MethodName
</span><a href="#local-6989586621679391296"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span id="local-6989586621679392191"><span class="annot"><a href="IC.Ref.Types.html#deleteCallContext"><span class="hs-identifier hs-type">deleteCallContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392191"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CallId"><span class="hs-identifier hs-type">CallId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392191"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-353"></span><span id="deleteCallContext"><span class="annot"><span class="annottext">deleteCallContext :: forall (m :: * -&gt; *). ICM m =&gt; CallId -&gt; m ()
</span><a href="IC.Ref.Types.html#deleteCallContext"><span class="hs-identifier hs-var hs-var">deleteCallContext</span></a></span></span><span> </span><span id="local-6989586621679391279"><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391279"><span class="hs-identifier hs-var">ctxt_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CallId -&gt; (CallContext -&gt; CallContext) -&gt; m ()
</span><a href="IC.Ref.Types.html#modifyCallContext"><span class="hs-identifier hs-var">modifyCallContext</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><a href="#local-6989586621679391279"><span class="hs-identifier hs-var">ctxt_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391278"><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391278"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallContext -&gt; NeedsToRespond
</span><a href="IC.Ref.Types.html#needs_to_respond"><span class="hs-identifier hs-var">needs_to_respond</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391278"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; NeedsToRespond
</span><a href="IC.Types.html#NeedsToRespond"><span class="hs-identifier hs-var">NeedsToRespond</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Internal error: deleteCallContext on non-responded call context&quot;</span></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CallContext -&gt; Bool
</span><a href="IC.Ref.Types.html#deleted"><span class="hs-identifier hs-var">deleted</span></a></span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391278"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;Internal error: deleteCallContext on deleted call context&quot;</span></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CallContext
</span><a href="#local-6989586621679391278"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">deleted :: Bool
</span><a href="IC.Ref.Types.html#deleted"><span class="hs-identifier hs-var">deleted</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- The following functions assume the canister does exist.</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- It would be an internal error if they don't.</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span id="local-6989586621679392230"><span class="annot"><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-type">getCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span></span><span>
</span><span id="line-365"></span><span id="getCanister"><span class="annot"><span class="annottext">getCanister :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var hs-var">getCanister</span></a></span></span><span> </span><span id="local-6989586621679391266"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391266"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391266"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IC -&gt; CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (Maybe a) -&gt; m a -&gt; m a
</span><a href="IC.Ref.Types.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister does not exist: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391266"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span id="local-6989586621679392188"><span class="annot"><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-type">modCanister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392188"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392188"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-370"></span><span id="modCanister"><span class="annot"><span class="annottext">modCanister :: forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var hs-var">modCanister</span></a></span></span><span> </span><span id="local-6989586621679391249"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391249"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391248"><span class="annot"><span class="annottext">CanState -&gt; CanState
</span><a href="#local-6989586621679391248"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#void"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391249"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391246"><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391246"><span class="hs-identifier hs-var">ic</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391246"><span class="hs-identifier hs-var">ic</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">canisters :: CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Map.Internal.html#adjust"><span class="hs-identifier hs-var">M.adjust</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; CanState
</span><a href="#local-6989586621679391248"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391249"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC -&gt; CanisterId &#8614; CanState
</span><a href="IC.Ref.Types.html#canisters"><span class="hs-identifier hs-var">canisters</span></a></span><span> </span><span class="annot"><span class="annottext">IC
</span><a href="#local-6989586621679391246"><span class="hs-identifier hs-var">ic</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span id="local-6989586621679392184"><span class="annot"><a href="IC.Ref.Types.html#setCanisterContent"><span class="hs-identifier hs-type">setCanisterContent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392184"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-type">CanisterContent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392184"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-375"></span><span id="setCanisterContent"><span class="annot"><span class="annottext">setCanisterContent :: forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; CanisterContent -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterContent"><span class="hs-identifier hs-var hs-var">setCanisterContent</span></a></span></span><span> </span><span id="local-6989586621679391236"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391236"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391235"><span class="annot"><span class="annottext">CanisterContent
</span><a href="#local-6989586621679391235"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391236"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391234"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391234"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391234"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">content :: Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterContent
</span><a href="#local-6989586621679391235"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span id="local-6989586621679392182"><span class="annot"><a href="IC.Ref.Types.html#modCanisterContent"><span class="hs-identifier hs-type">modCanisterContent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392182"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-type">CanisterContent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterContent"><span class="hs-identifier hs-type">CanisterContent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392182"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-379"></span><span id="modCanisterContent"><span class="annot"><span class="annottext">modCanisterContent :: forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanisterContent -&gt; CanisterContent) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanisterContent"><span class="hs-identifier hs-var hs-var">modCanisterContent</span></a></span></span><span> </span><span id="local-6989586621679391220"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391220"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391219"><span class="annot"><span class="annottext">CanisterContent -&gt; CanisterContent
</span><a href="#local-6989586621679391219"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391220"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391218"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391218"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391218"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">content :: Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterContent -&gt; CanisterContent
</span><a href="#local-6989586621679391219"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterContent
</span><a href="#local-6989586621679391216"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanState -&gt; Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391218"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679391216"><span class="annot"><span class="annottext">err :: CanisterContent
</span><a href="#local-6989586621679391216"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;canister is empty: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId -&gt; MethodName
</span><a href="IC.Types.html#prettyID"><span class="hs-identifier hs-var">prettyID</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391220"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span id="local-6989586621679392179"><span class="annot"><a href="IC.Ref.Types.html#setCanisterState"><span class="hs-identifier hs-type">setCanisterState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392179"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Canister.html#WasmState"><span class="hs-identifier hs-type">WasmState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392179"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-384"></span><span id="setCanisterState"><span class="annot"><span class="annottext">setCanisterState :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; WasmState -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterState"><span class="hs-identifier hs-var hs-var">setCanisterState</span></a></span></span><span> </span><span id="local-6989586621679391206"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391206"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391205"><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679391205"><span class="hs-identifier hs-var">wasm_state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanisterContent -&gt; CanisterContent) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanisterContent"><span class="hs-identifier hs-var">modCanisterContent</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391206"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391204"><span class="annot"><span class="annottext">CanisterContent
</span><a href="#local-6989586621679391204"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanisterContent
</span><a href="#local-6989586621679391204"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">wasm_state :: WasmState
</span><a href="IC.Ref.Types.html#wasm_state"><span class="hs-identifier hs-var">wasm_state</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WasmState
</span><a href="#local-6989586621679391205"><span class="hs-identifier hs-var">wasm_state</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621679392177"><span class="annot"><a href="IC.Ref.Types.html#getControllers"><span class="hs-identifier hs-type">getControllers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392177"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392177"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-388"></span><span id="getControllers"><span class="annot"><span class="annottext">getControllers :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m (Set CanisterId)
</span><a href="IC.Ref.Types.html#getControllers"><span class="hs-identifier hs-var hs-var">getControllers</span></a></span></span><span> </span><span id="local-6989586621679391190"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391190"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Set CanisterId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391190"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span id="local-6989586621679392175"><span class="annot"><a href="IC.Ref.Types.html#setControllers"><span class="hs-identifier hs-type">setControllers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392175"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/containers-0.6.5.1/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier hs-type">EntityId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392175"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-391"></span><span id="setControllers"><span class="annot"><span class="annottext">setControllers :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Set CanisterId -&gt; m ()
</span><a href="IC.Ref.Types.html#setControllers"><span class="hs-identifier hs-var hs-var">setControllers</span></a></span></span><span> </span><span id="local-6989586621679391180"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391180"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391179"><span class="annot"><span class="annottext">Set CanisterId
</span><a href="#local-6989586621679391179"><span class="hs-identifier hs-var">controllers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391180"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391178"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391178"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391178"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">controllers :: Set CanisterId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set CanisterId
</span><a href="#local-6989586621679391179"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span id="local-6989586621679392173"><span class="annot"><a href="IC.Ref.Types.html#setComputeAllocation"><span class="hs-identifier hs-type">setComputeAllocation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392173"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392173"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-395"></span><span id="setComputeAllocation"><span class="annot"><span class="annottext">setComputeAllocation :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setComputeAllocation"><span class="hs-identifier hs-var hs-var">setComputeAllocation</span></a></span></span><span> </span><span id="local-6989586621679391168"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391168"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391167"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391167"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391168"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391166"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391166"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391166"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">compute_allocation :: Natural
</span><a href="IC.Ref.Types.html#compute_allocation"><span class="hs-identifier hs-var">compute_allocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391167"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span id="local-6989586621679391165"><span class="annot"><a href="IC.Ref.Types.html#setMemoryAllocation"><span class="hs-identifier hs-type">setMemoryAllocation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391165"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391165"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-399"></span><span id="setMemoryAllocation"><span class="annot"><span class="annottext">setMemoryAllocation :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setMemoryAllocation"><span class="hs-identifier hs-var hs-var">setMemoryAllocation</span></a></span></span><span> </span><span id="local-6989586621679391155"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391155"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391154"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391154"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391155"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391153"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391153"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391153"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">memory_allocation :: Natural
</span><a href="IC.Ref.Types.html#memory_allocation"><span class="hs-identifier hs-var">memory_allocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391154"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span id="local-6989586621679391152"><span class="annot"><a href="IC.Ref.Types.html#setFreezingThreshold"><span class="hs-identifier hs-type">setFreezingThreshold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-403"></span><span id="setFreezingThreshold"><span class="annot"><span class="annottext">setFreezingThreshold :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setFreezingThreshold"><span class="hs-identifier hs-var hs-var">setFreezingThreshold</span></a></span></span><span> </span><span id="local-6989586621679391142"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391142"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391141"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391141"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391142"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391140"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391140"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391140"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">freezing_threshold :: Natural
</span><a href="IC.Ref.Types.html#freezing_threshold"><span class="hs-identifier hs-var">freezing_threshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391141"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621679392169"><span class="annot"><a href="IC.Ref.Types.html#getBalance"><span class="hs-identifier hs-type">getBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392169"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392169"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span></span><span>
</span><span id="line-407"></span><span id="getBalance"><span class="annot"><span class="annottext">getBalance :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getBalance"><span class="hs-identifier hs-var hs-var">getBalance</span></a></span></span><span> </span><span id="local-6989586621679391126"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391126"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#cycle_balance"><span class="hs-identifier hs-var">cycle_balance</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391126"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621679391125"><span class="annot"><a href="IC.Ref.Types.html#setBalance"><span class="hs-identifier hs-type">setBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-410"></span><span id="setBalance"><span class="annot"><span class="annottext">setBalance :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setBalance"><span class="hs-identifier hs-var hs-var">setBalance</span></a></span></span><span> </span><span id="local-6989586621679391115"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391115"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391114"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391114"><span class="hs-identifier hs-var">balance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391115"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391113"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391113"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391113"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cycle_balance :: Natural
</span><a href="IC.Ref.Types.html#cycle_balance"><span class="hs-identifier hs-var">cycle_balance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679391114"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span id="local-6989586621679392166"><span class="annot"><a href="IC.Ref.Types.html#setCertifiedData"><span class="hs-identifier hs-type">setCertifiedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-414"></span><span id="setCertifiedData"><span class="annot"><span class="annottext">setCertifiedData :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Blob -&gt; m ()
</span><a href="IC.Ref.Types.html#setCertifiedData"><span class="hs-identifier hs-var hs-var">setCertifiedData</span></a></span></span><span> </span><span id="local-6989586621679391103"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391103"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391102"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391102"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391103"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391101"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391101"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391101"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">certified_data :: Blob
</span><a href="IC.Ref.Types.html#certified_data"><span class="hs-identifier hs-var">certified_data</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679391102"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span id="local-6989586621679392164"><span class="annot"><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-type">getRunStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#RunStatus"><span class="hs-identifier hs-type">RunStatus</span></a></span></span><span>
</span><span id="line-418"></span><span id="getRunStatus"><span class="annot"><span class="annottext">getRunStatus :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m RunStatus
</span><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-var hs-var">getRunStatus</span></a></span></span><span> </span><span id="local-6989586621679391087"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391087"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; RunStatus
</span><a href="IC.Ref.Types.html#run_status"><span class="hs-identifier hs-var">run_status</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391087"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span id="local-6989586621679392162"><span class="annot"><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-type">setRunStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392162"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#RunStatus"><span class="hs-identifier hs-type">RunStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392162"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-421"></span><span id="setRunStatus"><span class="annot"><span class="annottext">setRunStatus :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; RunStatus -&gt; m ()
</span><a href="IC.Ref.Types.html#setRunStatus"><span class="hs-identifier hs-var hs-var">setRunStatus</span></a></span></span><span> </span><span id="local-6989586621679391077"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391077"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679391076"><span class="annot"><span class="annottext">RunStatus
</span><a href="#local-6989586621679391076"><span class="hs-identifier hs-var">run_status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391077"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391075"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391075"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391075"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">run_status :: RunStatus
</span><a href="IC.Ref.Types.html#run_status"><span class="hs-identifier hs-var">run_status</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunStatus
</span><a href="#local-6989586621679391076"><span class="hs-identifier hs-var">run_status</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span id="local-6989586621679392160"><span class="annot"><a href="IC.Ref.Types.html#getCanisterState"><span class="hs-identifier hs-type">getCanisterState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392160"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392160"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Canister.html#WasmState"><span class="hs-identifier hs-type">WasmState</span></a></span></span><span>
</span><span id="line-425"></span><span id="getCanisterState"><span class="annot"><span class="annottext">getCanisterState :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m WasmState
</span><a href="IC.Ref.Types.html#getCanisterState"><span class="hs-identifier hs-var hs-var">getCanisterState</span></a></span></span><span> </span><span id="local-6989586621679391059"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391059"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanisterContent -&gt; WasmState
</span><a href="IC.Ref.Types.html#wasm_state"><span class="hs-identifier hs-var">wasm_state</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391059"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span id="local-6989586621679392157"><span class="annot"><a href="IC.Ref.Types.html#getCanisterMod"><span class="hs-identifier hs-type">getCanisterMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Canister.html#CanisterModule"><span class="hs-identifier hs-type">CanisterModule</span></a></span></span><span>
</span><span id="line-428"></span><span id="getCanisterMod"><span class="annot"><span class="annottext">getCanisterMod :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanisterModule
</span><a href="IC.Ref.Types.html#getCanisterMod"><span class="hs-identifier hs-var hs-var">getCanisterMod</span></a></span></span><span> </span><span id="local-6989586621679391042"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391042"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanisterContent -&gt; CanisterModule
</span><a href="IC.Ref.Types.html#can_mod"><span class="hs-identifier hs-var">can_mod</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391042"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span id="local-6989586621679392155"><span class="annot"><a href="IC.Ref.Types.html#getCanisterTime"><span class="hs-identifier hs-type">getCanisterTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392155"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392155"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span></span><span>
</span><span id="line-431"></span><span id="getCanisterTime"><span class="annot"><span class="annottext">getCanisterTime :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Timestamp
</span><a href="IC.Ref.Types.html#getCanisterTime"><span class="hs-identifier hs-var hs-var">getCanisterTime</span></a></span></span><span> </span><span id="local-6989586621679391028"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391028"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Timestamp
</span><a href="IC.Ref.Types.html#time"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391028"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span id="local-6989586621679391027"><span class="annot"><a href="IC.Ref.Types.html#getCanisterVersion"><span class="hs-identifier hs-type">getCanisterVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span></span><span>
</span><span id="line-434"></span><span id="getCanisterVersion"><span class="annot"><span class="annottext">getCanisterVersion :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCanisterVersion"><span class="hs-identifier hs-var hs-var">getCanisterVersion</span></a></span></span><span> </span><span id="local-6989586621679391013"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391013"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391013"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span id="local-6989586621679392152"><span class="annot"><a href="IC.Ref.Types.html#bumpCanisterVersion"><span class="hs-identifier hs-type">bumpCanisterVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-437"></span><span id="bumpCanisterVersion"><span class="annot"><span class="annottext">bumpCanisterVersion :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m ()
</span><a href="IC.Ref.Types.html#bumpCanisterVersion"><span class="hs-identifier hs-var hs-var">bumpCanisterVersion</span></a></span></span><span> </span><span id="local-6989586621679391001"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391001"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679391001"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679391000"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391000"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391000"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">canister_version :: Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#canister_version"><span class="hs-identifier hs-var">canister_version</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679391000"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span id="local-6989586621679392149"><span class="annot"><a href="IC.Ref.Types.html#getCanisterHistory"><span class="hs-identifier hs-type">getCanisterHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392149"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392149"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanisterHistory"><span class="hs-identifier hs-type">CanisterHistory</span></a></span></span><span>
</span><span id="line-441"></span><span id="getCanisterHistory"><span class="annot"><span class="annottext">getCanisterHistory :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanisterHistory
</span><a href="IC.Ref.Types.html#getCanisterHistory"><span class="hs-identifier hs-var hs-var">getCanisterHistory</span></a></span></span><span> </span><span id="local-6989586621679390985"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390985"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var">canister_history</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390985"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span id="local-6989586621679392147"><span class="annot"><a href="IC.Ref.Types.html#addCanisterHistory"><span class="hs-identifier hs-type">addCanisterHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#Change"><span class="hs-identifier hs-type">Change</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-444"></span><span id="addCanisterHistory"><span class="annot"><span class="annottext">addCanisterHistory :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Change -&gt; m ()
</span><a href="IC.Ref.Types.html#addCanisterHistory"><span class="hs-identifier hs-var hs-var">addCanisterHistory</span></a></span></span><span> </span><span id="local-6989586621679390973"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390973"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679390972"><span class="annot"><span class="annottext">Change
</span><a href="#local-6989586621679390972"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390973"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679390971"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390971"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390971"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">canister_history :: CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var">canister_history</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Change] -&gt; Word64 -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#CanisterHistory"><span class="hs-identifier hs-var">CanisterHistory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CallId -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">CallId
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Change
</span><a href="#local-6989586621679390972"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterHistory -&gt; [Change]
</span><a href="IC.Ref.Types.html#changes"><span class="hs-identifier hs-var">changes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanState -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var">canister_history</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390971"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterHistory -&gt; Word64
</span><a href="IC.Ref.Types.html#total_num_changes"><span class="hs-identifier hs-var">total_num_changes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanState -&gt; CanisterHistory
</span><a href="IC.Ref.Types.html#canister_history"><span class="hs-identifier hs-var">canister_history</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390971"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span id="local-6989586621679390969"><span class="annot"><a href="IC.Ref.Types.html#getCanisterGlobalTimer"><span class="hs-identifier hs-type">getCanisterGlobalTimer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390969"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390969"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span></span><span>
</span><span id="line-448"></span><span id="getCanisterGlobalTimer"><span class="annot"><span class="annottext">getCanisterGlobalTimer :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCanisterGlobalTimer"><span class="hs-identifier hs-var hs-var">getCanisterGlobalTimer</span></a></span></span><span> </span><span id="local-6989586621679390955"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390955"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#global_timer"><span class="hs-identifier hs-var">global_timer</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390955"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span id="local-6989586621679390954"><span class="annot"><a href="IC.Ref.Types.html#setCanisterGlobalTimer"><span class="hs-identifier hs-type">setCanisterGlobalTimer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390954"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390954"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-451"></span><span id="setCanisterGlobalTimer"><span class="annot"><span class="annottext">setCanisterGlobalTimer :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterGlobalTimer"><span class="hs-identifier hs-var hs-var">setCanisterGlobalTimer</span></a></span></span><span> </span><span id="local-6989586621679390944"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390944"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679390943"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679390943"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; (CanState -&gt; CanState) -&gt; m ()
</span><a href="IC.Ref.Types.html#modCanister"><span class="hs-identifier hs-var">modCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390944"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679390942"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390942"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390942"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">global_timer :: Natural
</span><a href="IC.Ref.Types.html#global_timer"><span class="hs-identifier hs-var">global_timer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679390943"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="IC.Ref.Types.html#module_hash"><span class="hs-identifier hs-type">module_hash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-455"></span><span id="module_hash"><span class="annot"><span class="annottext">module_hash :: CanState -&gt; Maybe Blob
</span><a href="IC.Ref.Types.html#module_hash"><span class="hs-identifier hs-var hs-var">module_hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterModule -&gt; Blob
</span><a href="IC.Canister.html#raw_wasm_hash"><span class="hs-identifier hs-var">raw_wasm_hash</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterContent -&gt; CanisterModule
</span><a href="IC.Ref.Types.html#can_mod"><span class="hs-identifier hs-var">can_mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Maybe CanisterContent
</span><a href="IC.Ref.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><a href="IC.Ref.Types.html#idle_cycles_burned_per_day"><span class="hs-identifier hs-type">idle_cycles_burned_per_day</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#CanState"><span class="hs-identifier hs-type">CanState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-bignum-1.2/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-458"></span><span id="idle_cycles_burned_per_day"><span class="annot"><span class="annottext">idle_cycles_burned_per_day :: CanState -&gt; Natural
</span><a href="IC.Ref.Types.html#idle_cycles_burned_per_day"><span class="hs-identifier hs-var hs-var">idle_cycles_burned_per_day</span></a></span></span><span> </span><span class="annot"><span class="annottext">CanState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Num.html#fromInteger"><span class="hs-identifier hs-var">fromInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span id="local-6989586621679392142"><span class="annot"><a href="IC.Ref.Types.html#canisterEnv"><span class="hs-identifier hs-type">canisterEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span></span><span>
</span><span id="line-461"></span><span id="canisterEnv"><span class="annot"><span class="annottext">canisterEnv :: forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Env
</span><a href="IC.Ref.Types.html#canisterEnv"><span class="hs-identifier hs-var hs-var">canisterEnv</span></a></span></span><span> </span><span id="local-6989586621679390901"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>  </span><span id="local-6989586621679390900"><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679390900"><span class="hs-identifier hs-var">env_time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Timestamp
</span><a href="IC.Ref.Types.html#getCanisterTime"><span class="hs-identifier hs-var">getCanisterTime</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621679390899"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679390899"><span class="hs-identifier hs-var">env_balance</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getBalance"><span class="hs-identifier hs-var">getBalance</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621679390898"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679390898"><span class="hs-identifier hs-var">env_status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m RunStatus
</span><a href="IC.Ref.Types.html#getRunStatus"><span class="hs-identifier hs-var">getRunStatus</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Functor.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsRunning"><span class="hs-identifier hs-var">IsRunning</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="IC.Types.html#Running"><span class="hs-identifier hs-var">Running</span></a></span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><a href="IC.Ref.Types.html#IsStopping"><span class="hs-identifier hs-type">IsStopping</span></a></span><span> </span><span id="local-6989586621679390895"><span class="annot"><span class="annottext">[CallId]
</span><a href="#local-6989586621679390895"><span class="hs-identifier hs-var">_pending</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="IC.Types.html#Stopping"><span class="hs-identifier hs-var">Stopping</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsStopped"><span class="hs-identifier hs-var">IsStopped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="IC.Types.html#Stopped"><span class="hs-identifier hs-var">Stopped</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="annot"><span class="annottext">RunStatus
</span><a href="IC.Ref.Types.html#IsDeleted"><span class="hs-identifier hs-var">IsDeleted</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; MethodName -&gt; a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">MethodName
</span><span class="hs-string">&quot;deleted canister encountered&quot;</span></span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679390892"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679390892"><span class="hs-identifier hs-var">env_canister_version</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCanisterVersion"><span class="hs-identifier hs-var">getCanisterVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679390891"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679390891"><span class="hs-identifier hs-var">env_global_timer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m Natural
</span><a href="IC.Ref.Types.html#getCanisterGlobalTimer"><span class="hs-identifier hs-var">getCanisterGlobalTimer</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679390890"><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390890"><span class="hs-identifier hs-var">can_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; m CanState
</span><a href="IC.Ref.Types.html#getCanister"><span class="hs-identifier hs-var">getCanister</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="IC.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">env_self :: CanisterId
</span><a href="IC.Types.html#env_self"><span class="hs-identifier hs-var">env_self</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390901"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Timestamp
env_time :: Timestamp
env_time :: Timestamp
</span><a href="IC.Types.html#env_time"><span class="hs-identifier hs-var hs-var">env_time</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
env_balance :: Natural
env_balance :: Natural
</span><a href="IC.Types.html#env_balance"><span class="hs-identifier hs-var hs-var">env_balance</span></a></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Status
env_status :: Status
env_status :: Status
</span><a href="IC.Types.html#env_status"><span class="hs-identifier hs-var hs-var">env_status</span></a></span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env_certificate :: Maybe Blob
</span><a href="IC.Types.html#env_certificate"><span class="hs-identifier hs-var">env_certificate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
env_canister_version :: Natural
env_canister_version :: Natural
</span><a href="IC.Types.html#env_canister_version"><span class="hs-identifier hs-var hs-var">env_canister_version</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
env_global_timer :: Natural
env_global_timer :: Natural
</span><a href="IC.Types.html#env_global_timer"><span class="hs-identifier hs-var hs-var">env_global_timer</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env_controllers :: Set CanisterId
</span><a href="IC.Types.html#env_controllers"><span class="hs-identifier hs-var">env_controllers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CanState -&gt; Set CanisterId
</span><a href="IC.Ref.Types.html#controllers"><span class="hs-identifier hs-var">controllers</span></a></span><span> </span><span class="annot"><span class="annottext">CanState
</span><a href="#local-6989586621679390890"><span class="hs-identifier hs-var">can_state</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span id="local-6989586621679392135"><span class="annot"><a href="IC.Ref.Types.html#performCanisterActions"><span class="hs-identifier hs-type">performCanisterActions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Ref.Types.html#ICM"><span class="hs-identifier hs-type">ICM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392135"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterId"><span class="hs-identifier hs-type">CanisterId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#CanisterActions"><span class="hs-identifier hs-type">CanisterActions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392135"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-484"></span><span id="performCanisterActions"><span class="annot"><span class="annottext">performCanisterActions :: forall (m :: * -&gt; *).
ICM m =&gt;
CanisterId -&gt; CanisterActions -&gt; m ()
</span><a href="IC.Ref.Types.html#performCanisterActions"><span class="hs-identifier hs-var hs-var">performCanisterActions</span></a></span></span><span> </span><span id="local-6989586621679390861"><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390861"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679390860"><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679390860"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Blob -&gt; m ()
</span><a href="IC.Ref.Types.html#setCertifiedData"><span class="hs-identifier hs-var">setCertifiedData</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390861"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterActions -&gt; Maybe Blob
</span><a href="IC.Types.html#set_certified_data"><span class="hs-identifier hs-var">set_certified_data</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679390860"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/n4nbngkdp72aigvzs0xc8cy88z0ydbfv-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). ICM m =&gt; CanisterId -&gt; Natural -&gt; m ()
</span><a href="IC.Ref.Types.html#setCanisterGlobalTimer"><span class="hs-identifier hs-var">setCanisterGlobalTimer</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterId
</span><a href="#local-6989586621679390861"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CanisterActions -&gt; Maybe Natural
</span><a href="IC.Types.html#set_global_timer"><span class="hs-identifier hs-var">set_global_timer</span></a></span><span> </span><span class="annot"><span class="annottext">CanisterActions
</span><a href="#local-6989586621679390860"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span></pre></body></html>